2025-10-29 16:43:15,802 - __main__ - INFO - 初始化实验...
2025-10-29 16:43:15,812 - main - INFO - 使用设备: cuda
2025-10-29 16:43:15,814 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-29 16:43:15,815 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-29 16:43:15,815 - main - INFO - 开始数据加载和预处理...
2025-10-29 16:43:15,823 - src.data_preprocessing.data_loader - ERROR - 数据加载失败: 'file_path'
2025-10-29 16:43:15,823 - __main__ - ERROR - 实验失败: 'file_path'
2025-10-29 17:00:27,702 - __main__ - INFO - 初始化实验...
2025-10-29 17:00:27,711 - main - INFO - 使用设备: cuda
2025-10-29 17:00:27,716 - __main__ - INFO - 开始完整实验...
2025-10-29 17:00:27,716 - main - INFO - 开始完整实验流程...
2025-10-29 17:00:27,716 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:00:27,724 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:00:29,958 - src.data_preprocessing.data_loader - ERROR - 数据加载失败: 'Time'
2025-10-29 17:00:29,958 - __main__ - ERROR - 实验失败: 'Time'
2025-10-29 17:05:13,799 - __main__ - INFO - 初始化实验...
2025-10-29 17:05:13,808 - main - INFO - 使用设备: cuda
2025-10-29 17:05:13,810 - __main__ - INFO - 开始完整实验...
2025-10-29 17:05:13,810 - main - INFO - 开始完整实验流程...
2025-10-29 17:05:13,810 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:05:13,818 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:05:15,956 - __main__ - ERROR - 实验失败: 缺少必需列: ['Wave1Elev']
2025-10-29 17:11:37,091 - __main__ - INFO - 初始化实验...
2025-10-29 17:11:37,100 - main - INFO - 使用设备: cuda
2025-10-29 17:11:37,100 - __main__ - INFO - 开始完整实验...
2025-10-29 17:11:37,101 - main - INFO - 开始完整实验流程...
2025-10-29 17:11:37,101 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:11:37,108 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:11:39,243 - __main__ - ERROR - 实验失败: 缺少必需列: ['Wave1Elev', 'PtfmSurge', 'PtfmSway', 'PtfmHeave', 'PtfmRoll', 'PtfmPitch', 'PtfmYaw']
2025-10-29 17:26:24,339 - __main__ - INFO - 初始化实验...
2025-10-29 17:26:24,347 - main - INFO - 使用设备: cuda
2025-10-29 17:26:24,350 - __main__ - INFO - 开始完整实验...
2025-10-29 17:26:24,350 - main - INFO - 开始完整实验流程...
2025-10-29 17:26:24,350 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:26:24,357 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:26:26,480 - __main__ - ERROR - 实验失败: can only concatenate str (not "float") to str
2025-10-29 18:38:33,408 - __main__ - INFO - 初始化实验...
2025-10-29 18:38:33,416 - main - INFO - 使用设备: cuda
2025-10-29 18:38:33,428 - __main__ - INFO - 开始完整实验...
2025-10-29 18:38:33,428 - main - INFO - 开始完整实验流程...
2025-10-29 18:38:33,428 - main - INFO - 开始数据加载和预处理...
2025-10-29 18:38:33,436 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 18:38:35,521 - src.data_preprocessing.data_loader - WARNING - 发现缺失值:
Wave1Elev    2
PtfmSurge    2
PtfmSway     2
PtfmHeave    2
PtfmRoll     2
PtfmPitch    2
PtfmYaw      2
dtype: int64
2025-10-29 18:38:35,532 - __main__ - ERROR - 实验失败: Interpolation with NaNs in the index has not been implemented. Try filling those NaNs before interpolating.
2025-10-29 18:58:32,452 - __main__ - INFO - 初始化实验...
2025-10-29 18:58:32,462 - main - INFO - 使用设备: cuda
2025-10-29 18:58:32,467 - __main__ - INFO - 开始完整实验...
2025-10-29 18:58:32,467 - main - INFO - 开始完整实验流程...
2025-10-29 18:58:32,467 - main - INFO - 开始数据加载和预处理...
2025-10-29 18:58:32,474 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 18:58:34,531 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 18:58:34,535 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 18:58:34,537 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 18:58:34,539 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 18:58:34,542 - __main__ - ERROR - 实验失败: preprocess_data() takes 1 positional argument but 2 were given
2025-10-29 19:04:30,326 - __main__ - INFO - 初始化实验...
2025-10-29 19:04:30,335 - main - INFO - 使用设备: cuda
2025-10-29 19:04:30,336 - __main__ - INFO - 开始完整实验...
2025-10-29 19:04:30,336 - main - INFO - 开始完整实验流程...
2025-10-29 19:04:30,336 - main - INFO - 开始数据加载和预处理...
2025-10-29 19:04:30,346 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 19:04:32,578 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 19:04:32,580 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:04:32,582 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 19:04:32,585 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:04:32,595 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 19:04:32,596 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 19:04:32,761 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 19:04:32,761 - main - INFO - 数据预处理完成:
2025-10-29 19:04:32,761 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 19:04:32,761 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 19:04:32,761 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 19:04:32,762 - main - INFO - 开始专家模型超参数优化...
2025-10-29 19:04:32,771 - main - INFO - 优化PatchTST超参数...
2025-10-29 19:04:32,796 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,797 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,797 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,798 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,799 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,799 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,799 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,800 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,800 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,801 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,801 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,802 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,802 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,802 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,803 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,803 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,804 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,804 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,805 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,805 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,806 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,806 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,807 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,808 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,808 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,809 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,809 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,810 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,810 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,813 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,814 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,814 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,814 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,815 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,815 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,816 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,816 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,817 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,817 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,817 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,818 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,818 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,819 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,819 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:04:32,826 - main - INFO - 优化NHITS超参数...
2025-10-29 19:04:32,838 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,838 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,839 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,840 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,840 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,841 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,841 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,842 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,842 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,842 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,843 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,844 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,844 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,845 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,845 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,845 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,846 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,846 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,846 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,847 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,847 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,848 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,849 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,849 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,849 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,850 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,850 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,851 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,851 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,852 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,852 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,853 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,853 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,854 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,854 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,855 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,855 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,855 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,856 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,856 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,857 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,857 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,858 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,858 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,859 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,859 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,859 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,860 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,860 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,861 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,861 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-29 19:04:32,861 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:04:32,867 - main - INFO - 超参数优化完成
2025-10-29 19:04:32,867 - main - INFO - 开始训练专家模型...
2025-10-29 19:04:32,867 - main - INFO - 创建PatchTST模型...
2025-10-29 19:04:32,903 - main - INFO - 创建NHITS模型...
2025-10-29 19:04:32,913 - __main__ - ERROR - 实验失败: str is not a Module subclass
2025-10-29 19:15:05,935 - __main__ - INFO - 初始化实验...
2025-10-29 19:15:05,944 - main - INFO - 使用设备: cuda
2025-10-29 19:15:05,945 - __main__ - INFO - 开始完整实验...
2025-10-29 19:15:05,945 - main - INFO - 开始完整实验流程...
2025-10-29 19:15:05,945 - main - INFO - 开始数据加载和预处理...
2025-10-29 19:15:05,953 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 19:15:08,121 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 19:15:08,125 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:15:08,128 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 19:15:08,130 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:15:08,135 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 19:15:08,135 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 19:15:08,297 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 19:15:08,297 - main - INFO - 数据预处理完成:
2025-10-29 19:15:08,297 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 19:15:08,297 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 19:15:08,297 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 19:15:08,297 - main - INFO - 开始专家模型超参数优化...
2025-10-29 19:15:08,306 - main - INFO - 优化PatchTST超参数...
2025-10-29 19:15:08,322 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,322 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,323 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,323 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,324 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,324 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,325 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,325 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,326 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,326 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,327 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,327 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,329 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,329 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,330 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,330 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,332 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,332 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,333 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,333 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,334 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,334 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,337 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,337 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,339 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,339 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,340 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,340 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-29 19:15:08,345 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:15:08,350 - main - INFO - 优化NHITS超参数...
2025-10-29 19:15:08,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,364 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,364 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,367 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,367 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,369 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,369 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,371 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,371 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,374 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,374 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,375 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,375 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,375 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,376 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,376 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,377 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,377 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,377 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,378 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,378 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,379 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,379 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,379 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,380 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,380 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,383 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,383 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,383 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-29 19:15:08,384 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:15:08,389 - main - INFO - 超参数优化完成
2025-10-29 19:15:08,389 - main - INFO - 开始训练专家模型...
2025-10-29 19:15:08,389 - main - INFO - 创建PatchTST模型...
2025-10-29 19:15:08,402 - main - INFO - 创建NHITS模型...
2025-10-29 19:15:08,464 - main - INFO - 训练PatchTST...
2025-10-29 19:15:08,617 - __main__ - ERROR - 实验失败: __init__() got an unexpected keyword argument 'batch_size'
2025-10-29 20:16:43,097 - __main__ - INFO - 初始化实验...
2025-10-29 20:16:43,107 - main - INFO - 使用设备: cuda
2025-10-29 20:16:43,108 - __main__ - INFO - 开始完整实验...
2025-10-29 20:16:43,108 - main - INFO - 开始完整实验流程...
2025-10-29 20:16:43,108 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:16:43,116 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:16:45,302 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:16:45,303 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:16:45,306 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:16:45,308 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:16:45,313 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:16:45,313 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:16:45,395 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:16:45,395 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:16:45,396 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:16:45,396 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:16:45,396 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:16:45,497 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:16:45,497 - main - INFO - 数据预处理完成:
2025-10-29 20:16:45,498 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:16:45,498 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:16:45,498 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:16:45,498 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:16:45,508 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:16:45,553 - __main__ - ERROR - 实验失败: batch_size should be a positive integer value, but got batch_size=tensor([[ 1.2946,  1.2079,  1.1213,  ..., -1.0728, -1.1160, -1.1342],
        [ 1.2079,  1.1213,  1.0094,  ..., -1.1160, -1.1342, -1.1524],
        [ 1.1213,  1.0094,  0.8975,  ..., -1.1342, -1.1524, -1.1472],
        ...,
        [ 0.2753,  0.2629,  0.2506,  ..., -0.3080, -0.3343, -0.3560],
        [ 0.2629,  0.2506,  0.2319,  ..., -0.3343, -0.3560, -0.3776],
        [ 0.2506,  0.2319,  0.2132,  ..., -0.3560, -0.3776, -0.3935]])
2025-10-29 20:32:54,321 - __main__ - INFO - 初始化实验...
2025-10-29 20:32:54,331 - main - INFO - 使用设备: cuda
2025-10-29 20:32:54,332 - __main__ - INFO - 开始完整实验...
2025-10-29 20:32:54,332 - main - INFO - 开始完整实验流程...
2025-10-29 20:32:54,332 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:32:54,339 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:32:56,434 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:32:56,436 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:32:56,438 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:32:56,440 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:32:56,445 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:32:56,446 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:32:56,598 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:32:56,598 - main - INFO - 数据预处理完成:
2025-10-29 20:32:56,598 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:32:56,598 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:32:56,598 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:32:56,598 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:32:56,606 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:32:56,621 - __main__ - ERROR - 实验失败: batch_size should be a positive integer value, but got batch_size=tensor([[ 1.2946,  1.2079,  1.1213,  ..., -1.0728, -1.1160, -1.1342],
        [ 1.2079,  1.1213,  1.0094,  ..., -1.1160, -1.1342, -1.1524],
        [ 1.1213,  1.0094,  0.8975,  ..., -1.1342, -1.1524, -1.1472],
        ...,
        [ 0.2753,  0.2629,  0.2506,  ..., -0.3080, -0.3343, -0.3560],
        [ 0.2629,  0.2506,  0.2319,  ..., -0.3343, -0.3560, -0.3776],
        [ 0.2506,  0.2319,  0.2132,  ..., -0.3560, -0.3776, -0.3935]])
2025-10-29 20:34:29,880 - __main__ - INFO - 初始化实验...
2025-10-29 20:34:29,888 - main - INFO - 使用设备: cuda
2025-10-29 20:34:29,889 - __main__ - INFO - 开始完整实验...
2025-10-29 20:34:29,889 - main - INFO - 开始完整实验流程...
2025-10-29 20:34:29,889 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:34:29,897 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:34:31,994 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:34:31,996 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:34:31,998 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:34:32,000 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:34:32,005 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:34:32,006 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:34:32,156 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:34:32,156 - main - INFO - 数据预处理完成:
2025-10-29 20:34:32,156 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:34:32,156 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:34:32,156 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:34:32,156 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:34:32,164 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:34:32,164 - __main__ - ERROR - 实验失败: name 'TensorDataset' is not defined
2025-10-29 20:38:38,613 - __main__ - INFO - 初始化实验...
2025-10-29 20:38:38,627 - main - INFO - 使用设备: cuda
2025-10-29 20:38:38,632 - __main__ - INFO - 开始完整实验...
2025-10-29 20:38:38,632 - main - INFO - 开始完整实验流程...
2025-10-29 20:38:38,632 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:38:38,641 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:38:40,990 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:38:40,992 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:38:40,995 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:38:40,997 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:38:41,002 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:38:41,002 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:38:41,176 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:38:41,177 - main - INFO - 数据预处理完成:
2025-10-29 20:38:41,177 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:38:41,177 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:38:41,177 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:38:41,177 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:38:41,185 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:38:41,202 - __main__ - ERROR - 实验失败: name 'params' is not defined
2025-10-29 20:51:25,286 - __main__ - INFO - 初始化实验...
2025-10-29 20:51:25,296 - main - INFO - 使用设备: cuda
2025-10-29 20:51:25,297 - __main__ - INFO - 开始完整实验...
2025-10-29 20:51:25,297 - main - INFO - 开始完整实验流程...
2025-10-29 20:51:25,297 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:51:25,307 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:51:27,409 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:51:27,411 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:51:27,414 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:51:27,416 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:51:27,421 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:51:27,421 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:51:27,490 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:51:27,571 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:51:27,571 - main - INFO - 数据预处理完成:
2025-10-29 20:51:27,571 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:51:27,571 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:51:27,571 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:51:27,571 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:51:27,579 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:51:27,579 - __main__ - ERROR - 实验失败: optimize_patchtst() takes 5 positional arguments but 6 were given
2025-10-29 21:08:27,249 - __main__ - INFO - 初始化实验...
2025-10-29 21:08:27,258 - main - INFO - 使用设备: cuda
2025-10-29 21:08:27,259 - __main__ - INFO - 开始完整实验...
2025-10-29 21:08:27,259 - main - INFO - 开始完整实验流程...
2025-10-29 21:08:27,259 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:08:27,267 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:08:29,354 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:08:29,357 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:08:29,359 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:08:29,360 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:08:29,366 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:08:29,367 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:08:29,534 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:08:29,534 - main - INFO - 数据预处理完成:
2025-10-29 21:08:29,534 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:08:29,534 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:08:29,535 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:08:29,535 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:08:29,544 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:08:29,544 - __main__ - ERROR - 实验失败: optimize_patchtst() got an unexpected keyword argument 'params'
2025-10-29 21:18:33,628 - __main__ - INFO - 初始化实验...
2025-10-29 21:18:33,638 - main - INFO - 使用设备: cuda
2025-10-29 21:18:33,638 - __main__ - INFO - 开始完整实验...
2025-10-29 21:18:33,638 - main - INFO - 开始完整实验流程...
2025-10-29 21:18:33,638 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:18:33,647 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:18:35,764 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:18:35,766 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:18:35,768 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:18:35,770 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:18:35,776 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:18:35,776 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:18:35,845 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:18:35,928 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:18:35,928 - main - INFO - 数据预处理完成:
2025-10-29 21:18:35,928 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:18:35,928 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:18:35,928 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:18:35,929 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:18:35,936 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:18:35,936 - __main__ - ERROR - 实验失败: optimize_patchtst() got an unexpected keyword argument 'params'
2025-10-29 21:23:29,873 - __main__ - INFO - 初始化实验...
2025-10-29 21:23:29,881 - main - INFO - 使用设备: cuda
2025-10-29 21:23:29,882 - __main__ - INFO - 开始完整实验...
2025-10-29 21:23:29,882 - main - INFO - 开始完整实验流程...
2025-10-29 21:23:29,882 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:23:29,890 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:23:31,983 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:23:31,984 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:23:31,988 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:23:31,989 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:23:31,994 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:23:31,994 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:23:32,158 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:23:32,158 - main - INFO - 数据预处理完成:
2025-10-29 21:23:32,158 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:23:32,158 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:23:32,158 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:23:32,158 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:23:32,167 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:23:32,167 - __main__ - ERROR - 实验失败: optimize_patchtst() got an unexpected keyword argument 'params'
2025-10-29 21:33:56,776 - __main__ - INFO - 初始化实验...
2025-10-29 21:33:56,785 - main - INFO - 使用设备: cuda
2025-10-29 21:33:56,786 - __main__ - INFO - 开始完整实验...
2025-10-29 21:33:56,786 - main - INFO - 开始完整实验流程...
2025-10-29 21:33:56,787 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:33:56,794 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:33:58,901 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:33:58,904 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:33:58,906 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:33:58,908 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:33:58,913 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:33:58,913 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:33:58,987 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:33:58,987 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:33:58,987 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:33:58,988 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:33:58,988 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:33:59,068 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:33:59,068 - main - INFO - 数据预处理完成:
2025-10-29 21:33:59,068 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:33:59,068 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:33:59,068 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:33:59,068 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:33:59,077 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:33:59,077 - __main__ - ERROR - 实验失败: name 'hp' is not defined
2025-10-31 14:03:33,997 - __main__ - INFO - 初始化实验...
2025-10-31 14:03:34,013 - main - INFO - 使用设备: cuda
2025-10-31 14:03:34,015 - __main__ - INFO - 开始完整实验...
2025-10-31 14:03:34,015 - main - INFO - 开始完整实验流程...
2025-10-31 14:03:34,015 - main - INFO - 开始数据加载和预处理...
2025-10-31 14:03:34,024 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 14:03:36,854 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 14:03:36,857 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:03:36,859 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 14:03:36,861 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:03:36,867 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 14:03:36,867 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 14:03:36,961 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 14:03:36,961 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 14:03:36,961 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 14:03:36,962 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 14:03:36,962 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 14:03:37,082 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 14:03:37,082 - main - INFO - 数据预处理完成:
2025-10-31 14:03:37,082 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 14:03:37,082 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 14:03:37,082 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 14:03:37,082 - main - INFO - 开始专家模型超参数优化...
2025-10-31 14:03:37,098 - main - INFO - 优化PatchTST超参数...
2025-10-31 14:03:37,156 - __main__ - ERROR - 实验失败: batch_size should be a positive integer value, but got batch_size=tensor([[ 0.2319,  0.2132,  0.1893,  ..., -0.3776, -0.3935, -0.4093],
        [ 0.2132,  0.1893,  0.1653,  ..., -0.3935, -0.4093, -0.4185],
        [ 0.1893,  0.1653,  0.1371,  ..., -0.4093, -0.4185, -0.4277],
        ...,
        [-0.8700, -0.6814, -0.4928,  ...,  1.4538,  1.3598,  1.2264],
        [-0.6814, -0.4928, -0.2894,  ...,  1.3598,  1.2264,  1.0930],
        [-0.4928, -0.2894, -0.0860,  ...,  1.2264,  1.0930,  0.9287]])
2025-10-31 14:14:12,288 - __main__ - INFO - 初始化实验...
2025-10-31 14:14:12,310 - main - INFO - 使用设备: cuda
2025-10-31 14:14:12,314 - __main__ - INFO - 开始完整实验...
2025-10-31 14:14:12,315 - main - INFO - 开始完整实验流程...
2025-10-31 14:14:12,315 - main - INFO - 开始数据加载和预处理...
2025-10-31 14:14:12,328 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 14:14:15,224 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 14:14:15,226 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:14:15,229 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 14:14:15,232 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:14:15,238 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 14:14:15,238 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 14:14:15,344 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 14:14:15,480 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 14:14:15,480 - main - INFO - 数据预处理完成:
2025-10-31 14:14:15,480 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 14:14:15,480 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 14:14:15,480 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 14:14:15,480 - main - INFO - 开始专家模型超参数优化...
2025-10-31 14:14:15,498 - main - INFO - 优化PatchTST超参数...
2025-10-31 14:14:15,513 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,514 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,515 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,515 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,516 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,517 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,517 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,518 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,518 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,519 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,519 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,520 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,520 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,521 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,521 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,521 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,522 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,522 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,523 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,524 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,524 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,525 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,526 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,526 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,527 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,527 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,529 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,529 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,529 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,530 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,530 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,531 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,532 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,532 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,533 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,534 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,534 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,535 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,535 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,535 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,536 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,537 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,537 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,538 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,539 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,539 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,540 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,540 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,541 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,542 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,542 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-31 14:14:15,542 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 14:14:15,547 - main - INFO - 优化NHITS超参数...
2025-10-31 14:14:15,557 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,558 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,559 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,559 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,561 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,561 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,562 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,562 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,563 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,563 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,564 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,565 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,565 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,566 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,567 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,567 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,568 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,568 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,570 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,570 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,570 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,571 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,571 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,572 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,572 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,573 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,574 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,574 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,575 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,576 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,576 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,577 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,578 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,578 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,580 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,580 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,581 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,581 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,582 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,582 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,583 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,583 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,584 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,584 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,586 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,587 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,588 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,588 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,589 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,590 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,590 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-31 14:14:15,590 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 14:14:15,594 - main - INFO - 超参数优化完成
2025-10-31 14:14:15,594 - main - INFO - 开始训练专家模型...
2025-10-31 14:14:15,594 - main - INFO - 创建PatchTST模型...
2025-10-31 14:14:15,626 - main - INFO - 创建NHITS模型...
2025-10-31 14:14:15,709 - main - INFO - 训练PatchTST...
2025-10-31 14:14:16,459 - __main__ - ERROR - 实验失败: 'PatchTSTTrainer' object has no attribute 'train_model'
2025-10-31 15:31:30,216 - __main__ - INFO - 初始化实验...
2025-10-31 15:31:30,231 - main - INFO - 使用设备: cuda
2025-10-31 15:31:30,232 - __main__ - INFO - 开始完整实验...
2025-10-31 15:31:30,232 - main - INFO - 开始完整实验流程...
2025-10-31 15:31:30,233 - main - INFO - 开始数据加载和预处理...
2025-10-31 15:31:30,244 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 15:31:32,834 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 15:31:32,838 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:31:32,841 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 15:31:32,844 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:31:32,850 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 15:31:32,851 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 15:31:32,933 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 15:31:33,060 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 15:31:33,060 - main - INFO - 数据预处理完成:
2025-10-31 15:31:33,061 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 15:31:33,061 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 15:31:33,061 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 15:31:33,061 - main - INFO - 开始专家模型超参数优化...
2025-10-31 15:31:33,074 - main - INFO - 优化PatchTST超参数...
2025-10-31 15:31:33,101 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,101 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,102 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,103 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,103 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,104 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,104 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,105 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,105 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,106 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,106 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,107 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,107 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,110 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,110 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,111 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,111 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,112 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,112 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,113 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,113 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,114 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,114 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,116 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,116 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,121 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,121 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,122 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,122 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,123 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,123 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,125 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-31 15:31:33,125 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:31:33,130 - main - INFO - 优化NHITS超参数...
2025-10-31 15:31:33,140 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,140 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,141 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,141 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,143 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,143 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,146 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,146 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,148 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,148 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,149 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,149 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,151 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,151 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,154 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,154 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,157 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,157 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,159 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,160 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,160 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,161 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,161 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,161 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,162 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,162 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-31 15:31:33,162 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:31:33,167 - main - INFO - 超参数优化完成
2025-10-31 15:31:33,167 - main - INFO - 开始训练专家模型...
2025-10-31 15:31:33,167 - main - INFO - 创建PatchTST模型...
2025-10-31 15:31:33,211 - main - INFO - 创建NHITS模型...
2025-10-31 15:31:33,286 - main - INFO - 训练PatchTST...
2025-10-31 15:31:48,745 - __main__ - ERROR - 实验失败: unsupported format string passed to NoneType.__format__
2025-10-31 15:39:17,696 - __main__ - INFO - 初始化实验...
2025-10-31 15:39:17,711 - main - INFO - 使用设备: cuda
2025-10-31 15:39:17,714 - __main__ - INFO - 开始完整实验...
2025-10-31 15:39:17,715 - main - INFO - 开始完整实验流程...
2025-10-31 15:39:17,715 - main - INFO - 开始数据加载和预处理...
2025-10-31 15:39:17,725 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 15:39:20,212 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 15:39:20,215 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:39:20,218 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 15:39:20,220 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:39:20,228 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 15:39:20,228 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 15:39:20,308 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 15:39:20,422 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 15:39:20,422 - main - INFO - 数据预处理完成:
2025-10-31 15:39:20,422 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 15:39:20,423 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 15:39:20,423 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 15:39:20,423 - main - INFO - 开始专家模型超参数优化...
2025-10-31 15:39:20,434 - main - INFO - 优化PatchTST超参数...
2025-10-31 15:39:20,447 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,448 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,448 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,449 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,449 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,450 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,450 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,451 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,452 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,452 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,453 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,453 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,454 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,454 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,455 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,456 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,456 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,456 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,458 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,458 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,459 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,459 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,459 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,460 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,460 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,461 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,462 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,462 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,463 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,463 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,464 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,464 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,465 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,465 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,466 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,466 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,466 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,468 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,468 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,469 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,469 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,469 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,470 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,470 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,471 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,471 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,473 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,473 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,474 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,474 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,474 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-31 15:39:20,475 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:39:20,477 - main - INFO - 优化NHITS超参数...
2025-10-31 15:39:20,485 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,488 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,488 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,489 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,489 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,490 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,490 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,491 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,491 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,492 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,492 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,492 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,493 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,493 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,494 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,494 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,495 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,495 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,496 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,496 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,497 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,497 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,498 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,498 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,498 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,499 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,499 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,500 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,500 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,500 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,501 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,501 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,502 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,502 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,502 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,503 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,503 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,504 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,504 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,505 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,505 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,508 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,508 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-31 15:39:20,508 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:39:20,513 - main - INFO - 超参数优化完成
2025-10-31 15:39:20,514 - main - INFO - 开始训练专家模型...
2025-10-31 15:39:20,514 - main - INFO - 创建PatchTST模型...
2025-10-31 15:39:20,525 - main - INFO - 创建NHITS模型...
2025-10-31 15:39:20,595 - main - INFO - 训练PatchTST...
2025-10-31 15:39:33,283 - models.patchtst - INFO - Epoch   1 | train_loss=0.927869 | val_loss=1.327825
2025-10-31 15:39:43,305 - models.patchtst - INFO - Epoch   2 | train_loss=0.924054 | val_loss=1.327774
2025-10-31 15:39:53,846 - models.patchtst - INFO - Epoch   3 | train_loss=0.923918 | val_loss=1.327781
2025-10-31 15:40:04,510 - models.patchtst - INFO - Epoch   4 | train_loss=0.924005 | val_loss=1.327734
2025-10-31 15:40:14,779 - models.patchtst - INFO - Epoch   5 | train_loss=0.923960 | val_loss=1.327734
2025-10-31 15:40:25,024 - models.patchtst - INFO - Epoch   6 | train_loss=0.923967 | val_loss=1.327799
2025-10-31 15:40:35,145 - models.patchtst - INFO - Epoch   7 | train_loss=0.923934 | val_loss=1.328027
2025-10-31 15:40:45,725 - models.patchtst - INFO - Epoch   8 | train_loss=0.923971 | val_loss=1.327790
2025-10-31 15:40:55,824 - models.patchtst - INFO - Epoch   9 | train_loss=0.924017 | val_loss=1.327831
2025-10-31 15:41:06,523 - models.patchtst - INFO - Epoch  10 | train_loss=0.924314 | val_loss=1.327968
2025-10-31 15:41:17,048 - models.patchtst - INFO - Epoch  11 | train_loss=0.924092 | val_loss=1.327922
2025-10-31 15:41:27,543 - models.patchtst - INFO - Epoch  12 | train_loss=0.923883 | val_loss=1.327907
2025-10-31 15:41:37,861 - models.patchtst - INFO - Epoch  13 | train_loss=0.923949 | val_loss=1.327865
2025-10-31 15:41:48,030 - models.patchtst - INFO - Epoch  14 | train_loss=0.923880 | val_loss=1.327905
2025-10-31 15:41:58,309 - models.patchtst - INFO - Epoch  15 | train_loss=0.923922 | val_loss=1.327823
2025-10-31 15:42:08,933 - models.patchtst - INFO - Epoch  16 | train_loss=0.923985 | val_loss=1.327784
2025-10-31 15:42:19,465 - models.patchtst - INFO - Epoch  17 | train_loss=0.923839 | val_loss=1.327730
2025-10-31 15:42:30,062 - models.patchtst - INFO - Epoch  18 | train_loss=0.923902 | val_loss=1.327687
2025-10-31 15:42:40,437 - models.patchtst - INFO - Epoch  19 | train_loss=0.923886 | val_loss=1.327806
2025-10-31 15:42:50,736 - models.patchtst - INFO - Epoch  20 | train_loss=0.923940 | val_loss=1.327795
2025-10-31 15:43:01,241 - models.patchtst - INFO - Epoch  21 | train_loss=0.923929 | val_loss=1.327829
2025-10-31 15:43:11,473 - models.patchtst - INFO - Epoch  22 | train_loss=0.923891 | val_loss=1.327868
2025-10-31 15:43:21,898 - models.patchtst - INFO - Epoch  23 | train_loss=0.923887 | val_loss=1.327762
2025-10-31 15:43:32,311 - models.patchtst - INFO - Epoch  24 | train_loss=0.923936 | val_loss=1.327797
2025-10-31 15:43:42,695 - models.patchtst - INFO - Epoch  25 | train_loss=0.923925 | val_loss=1.327754
2025-10-31 15:43:53,188 - models.patchtst - INFO - Epoch  26 | train_loss=0.923958 | val_loss=1.327727
2025-10-31 15:44:03,785 - models.patchtst - INFO - Epoch  27 | train_loss=0.923980 | val_loss=1.327734
2025-10-31 15:44:14,063 - models.patchtst - INFO - Epoch  28 | train_loss=0.923874 | val_loss=1.327783
2025-10-31 15:44:24,367 - models.patchtst - INFO - Epoch  29 | train_loss=0.923909 | val_loss=1.327835
2025-10-31 15:44:34,775 - models.patchtst - INFO - Epoch  30 | train_loss=0.923892 | val_loss=1.327841
2025-10-31 15:44:45,320 - models.patchtst - INFO - Epoch  31 | train_loss=0.923874 | val_loss=1.327772
2025-10-31 15:44:55,832 - models.patchtst - INFO - Epoch  32 | train_loss=0.923955 | val_loss=1.327753
2025-10-31 15:45:04,022 - models.patchtst - INFO - Epoch  33 | train_loss=0.923890 | val_loss=1.327788
2025-10-31 15:45:04,022 - models.patchtst - INFO - Early stopping at epoch 33早停触发（连续15轮验证损失未下降），最佳验证损失：1.327687
2025-10-31 15:45:04,022 - main - INFO - 训练NHITS...
2025-10-31 15:45:11,968 - models.nhits - INFO - Epoch   1 | train_loss=489095653.310498 | val_loss=3152.715940
2025-10-31 15:45:20,024 - models.nhits - INFO - Epoch   2 | train_loss=405.746615 | val_loss=1.074739
2025-10-31 15:45:28,517 - models.nhits - INFO - Epoch   3 | train_loss=0.483789 | val_loss=0.245722
2025-10-31 15:45:36,724 - models.nhits - INFO - Epoch   4 | train_loss=0.233342 | val_loss=0.098467
2025-10-31 15:45:45,143 - models.nhits - INFO - Epoch   5 | train_loss=0.100315 | val_loss=0.125074
2025-10-31 15:45:53,335 - models.nhits - INFO - Epoch   6 | train_loss=0.130511 | val_loss=0.085337
2025-10-31 15:46:01,379 - models.nhits - INFO - Epoch   7 | train_loss=0.080563 | val_loss=0.114948
2025-10-31 15:46:09,902 - models.nhits - INFO - Epoch   8 | train_loss=5.296878 | val_loss=0.137993
2025-10-31 15:46:17,928 - models.nhits - INFO - Epoch   9 | train_loss=0.071374 | val_loss=0.101499
2025-10-31 15:46:26,042 - models.nhits - INFO - Epoch  10 | train_loss=0.072014 | val_loss=0.133484
2025-10-31 15:46:34,060 - models.nhits - INFO - Epoch  11 | train_loss=0.070031 | val_loss=0.091513
2025-10-31 15:46:42,052 - models.nhits - INFO - Epoch  12 | train_loss=0.068585 | val_loss=0.080133
2025-10-31 15:46:50,061 - models.nhits - INFO - Epoch  13 | train_loss=0.065235 | val_loss=0.082091
2025-10-31 15:46:58,169 - models.nhits - INFO - Epoch  14 | train_loss=0.068331 | val_loss=0.119304
2025-10-31 15:47:06,680 - models.nhits - INFO - Epoch  15 | train_loss=0.063992 | val_loss=0.096098
2025-10-31 15:47:15,536 - models.nhits - INFO - Epoch  16 | train_loss=0.105489 | val_loss=0.089699
2025-10-31 15:47:24,365 - models.nhits - INFO - Epoch  17 | train_loss=0.064401 | val_loss=0.081413
2025-10-31 15:47:32,644 - models.nhits - INFO - Epoch  18 | train_loss=0.062458 | val_loss=0.100864
2025-10-31 15:47:40,753 - models.nhits - INFO - Epoch  19 | train_loss=0.066462 | val_loss=0.083629
2025-10-31 15:47:48,852 - models.nhits - INFO - Epoch  20 | train_loss=0.059988 | val_loss=0.077885
2025-10-31 15:47:56,970 - models.nhits - INFO - Epoch  21 | train_loss=0.064419 | val_loss=0.081294
2025-10-31 15:48:04,949 - models.nhits - INFO - Epoch  22 | train_loss=0.058914 | val_loss=0.074578
2025-10-31 15:48:12,908 - models.nhits - INFO - Epoch  23 | train_loss=0.060278 | val_loss=0.084576
2025-10-31 15:48:21,071 - models.nhits - INFO - Epoch  24 | train_loss=0.201753 | val_loss=0.089741
2025-10-31 15:48:29,023 - models.nhits - INFO - Epoch  25 | train_loss=0.059630 | val_loss=0.096877
2025-10-31 15:48:36,916 - models.nhits - INFO - Epoch  26 | train_loss=0.099338 | val_loss=0.208181
2025-10-31 15:48:44,917 - models.nhits - INFO - Epoch  27 | train_loss=0.073099 | val_loss=0.072956
2025-10-31 15:48:53,112 - models.nhits - INFO - Epoch  28 | train_loss=0.059335 | val_loss=0.088489
2025-10-31 15:49:01,268 - models.nhits - INFO - Epoch  29 | train_loss=0.142197 | val_loss=0.081398
2025-10-31 15:49:09,510 - models.nhits - INFO - Epoch  30 | train_loss=0.057056 | val_loss=0.081621
2025-10-31 15:49:17,525 - models.nhits - INFO - Epoch  31 | train_loss=0.057452 | val_loss=0.076460
2025-10-31 15:49:25,611 - models.nhits - INFO - Epoch  32 | train_loss=0.055477 | val_loss=0.073862
2025-10-31 15:49:33,759 - models.nhits - INFO - Epoch  33 | train_loss=0.066344 | val_loss=0.086352
2025-10-31 15:49:41,892 - models.nhits - INFO - Epoch  34 | train_loss=0.057983 | val_loss=0.099354
2025-10-31 15:49:49,801 - models.nhits - INFO - Epoch  35 | train_loss=0.098034 | val_loss=0.081849
2025-10-31 15:49:58,017 - models.nhits - INFO - Epoch  36 | train_loss=0.056185 | val_loss=0.091025
2025-10-31 15:50:06,179 - models.nhits - INFO - Epoch  37 | train_loss=0.057927 | val_loss=0.095565
2025-10-31 15:50:14,302 - models.nhits - INFO - Epoch  38 | train_loss=0.054361 | val_loss=0.084949
2025-10-31 15:50:22,250 - models.nhits - INFO - Epoch  39 | train_loss=0.046664 | val_loss=0.092809
2025-10-31 15:50:30,180 - models.nhits - INFO - Epoch  40 | train_loss=0.046599 | val_loss=0.070649
2025-10-31 15:50:38,224 - models.nhits - INFO - Epoch  41 | train_loss=0.045264 | val_loss=0.068284
2025-10-31 15:50:46,276 - models.nhits - INFO - Epoch  42 | train_loss=0.045358 | val_loss=0.067349
2025-10-31 15:50:54,301 - models.nhits - INFO - Epoch  43 | train_loss=0.045717 | val_loss=0.066542
2025-10-31 15:51:02,161 - models.nhits - INFO - Epoch  44 | train_loss=0.045401 | val_loss=0.070764
2025-10-31 15:51:10,042 - models.nhits - INFO - Epoch  45 | train_loss=0.045246 | val_loss=0.068988
2025-10-31 15:51:17,927 - models.nhits - INFO - Epoch  46 | train_loss=0.044527 | val_loss=0.063991
2025-10-31 15:51:25,854 - models.nhits - INFO - Epoch  47 | train_loss=0.044653 | val_loss=0.071798
2025-10-31 15:51:33,764 - models.nhits - INFO - Epoch  48 | train_loss=0.045339 | val_loss=0.072215
2025-10-31 15:51:41,608 - models.nhits - INFO - Epoch  49 | train_loss=0.044694 | val_loss=0.072899
2025-10-31 15:51:49,512 - models.nhits - INFO - Epoch  50 | train_loss=0.044454 | val_loss=0.064443
2025-10-31 15:51:57,480 - models.nhits - INFO - Epoch  51 | train_loss=0.044538 | val_loss=0.070821
2025-10-31 15:52:05,526 - models.nhits - INFO - Epoch  52 | train_loss=0.044154 | val_loss=0.065720
2025-10-31 15:52:13,988 - models.nhits - INFO - Epoch  53 | train_loss=0.047175 | val_loss=0.065633
2025-10-31 15:52:22,336 - models.nhits - INFO - Epoch  54 | train_loss=0.043859 | val_loss=0.071740
2025-10-31 15:52:30,562 - models.nhits - INFO - Epoch  55 | train_loss=0.043501 | val_loss=0.071726
2025-10-31 15:52:38,753 - models.nhits - INFO - Epoch  56 | train_loss=0.050849 | val_loss=0.091997
2025-10-31 15:52:46,909 - models.nhits - INFO - Epoch  57 | train_loss=0.045089 | val_loss=0.068903
2025-10-31 15:52:55,031 - models.nhits - INFO - Epoch  58 | train_loss=0.040156 | val_loss=0.066100
2025-10-31 15:53:03,248 - models.nhits - INFO - Epoch  59 | train_loss=0.039875 | val_loss=0.062749
2025-10-31 15:53:11,554 - models.nhits - INFO - Epoch  60 | train_loss=0.040133 | val_loss=0.065897
2025-10-31 15:53:19,724 - models.nhits - INFO - Epoch  61 | train_loss=0.039443 | val_loss=0.065793
2025-10-31 15:53:27,963 - models.nhits - INFO - Epoch  62 | train_loss=0.039330 | val_loss=0.065678
2025-10-31 15:53:36,163 - models.nhits - INFO - Epoch  63 | train_loss=0.039476 | val_loss=0.065348
2025-10-31 15:53:44,194 - models.nhits - INFO - Epoch  64 | train_loss=0.039179 | val_loss=0.067882
2025-10-31 15:53:52,262 - models.nhits - INFO - Epoch  65 | train_loss=0.038955 | val_loss=0.068782
2025-10-31 15:54:00,386 - models.nhits - INFO - Epoch  66 | train_loss=0.039140 | val_loss=0.064217
2025-10-31 15:54:08,492 - models.nhits - INFO - Epoch  67 | train_loss=0.039087 | val_loss=0.065272
2025-10-31 15:54:16,612 - models.nhits - INFO - Epoch  68 | train_loss=0.038954 | val_loss=0.067954
2025-10-31 15:54:24,705 - models.nhits - INFO - Epoch  69 | train_loss=0.038856 | val_loss=0.063788
2025-10-31 15:54:32,801 - models.nhits - INFO - Epoch  70 | train_loss=0.038798 | val_loss=0.068440
2025-10-31 15:54:40,795 - models.nhits - INFO - Epoch  71 | train_loss=0.036739 | val_loss=0.064809
2025-10-31 15:54:48,861 - models.nhits - INFO - Epoch  72 | train_loss=0.036566 | val_loss=0.063497
2025-10-31 15:54:57,228 - models.nhits - INFO - Epoch  73 | train_loss=0.036631 | val_loss=0.063886
2025-10-31 15:55:05,949 - models.nhits - INFO - Epoch  74 | train_loss=0.036275 | val_loss=0.063817
2025-10-31 15:55:05,950 - models.nhits - INFO - Early stopping at epoch 74早停触发（连续15轮验证损失未下降），最佳验证损失：0.062749
2025-10-31 15:55:05,972 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_153917/patchtst_model.pth
2025-10-31 15:55:06,001 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_153917/nhits_model.pth
2025-10-31 15:55:06,001 - main - INFO - 专家模型训练完成
2025-10-31 15:55:06,004 - main - INFO - 获取专家模型预测...
2025-10-31 15:55:18,661 - main - INFO - 专家预测获取完成
2025-10-31 15:55:18,662 - main - INFO - 实现策略A：静态优化权重...
2025-10-31 15:55:19,327 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-10-31 15:55:19,335 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.251383
2025-10-31 15:55:19,337 - __main__ - ERROR - 实验失败: '<' not supported between instances of 'numpy.ndarray' and 'str'
2025-10-31 19:05:44,502 - __main__ - INFO - 初始化实验...
2025-10-31 19:05:44,512 - main - INFO - 使用设备: cuda
2025-10-31 19:05:44,515 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 19:05:44,515 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 19:05:44,515 - main - INFO - 开始数据加载和预处理...
2025-10-31 19:05:44,524 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 19:05:46,705 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 19:05:46,708 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:05:46,711 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 19:05:46,713 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:05:46,719 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 19:05:46,719 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 19:05:46,794 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 19:05:46,794 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 19:05:46,794 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 19:05:46,795 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 19:05:46,795 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 19:05:46,859 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 19:05:46,859 - main - INFO - 数据预处理完成:
2025-10-31 19:05:46,859 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 19:05:46,859 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 19:05:46,859 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 19:05:46,859 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 19:05:46,861 - main - INFO - 开始训练专家模型...
2025-10-31 19:05:46,861 - main - INFO - 创建PatchTST模型...
2025-10-31 19:05:46,906 - main - INFO - 创建NHITS模型...
2025-10-31 19:05:46,981 - main - INFO - 训练PatchTST...
2025-10-31 19:05:58,371 - models.patchtst - INFO - Epoch   1 | train_loss=0.927905 | val_loss=1.327706
2025-10-31 19:06:06,209 - models.patchtst - INFO - Epoch   2 | train_loss=0.924078 | val_loss=1.327847
2025-10-31 19:06:13,263 - models.patchtst - INFO - Epoch   3 | train_loss=0.923897 | val_loss=1.327648
2025-10-31 19:06:20,409 - models.patchtst - INFO - Epoch   4 | train_loss=0.924024 | val_loss=1.327782
2025-10-31 19:06:27,701 - models.patchtst - INFO - Epoch   5 | train_loss=0.923970 | val_loss=1.327686
2025-10-31 19:06:27,701 - main - INFO - 训练NHITS...
2025-10-31 19:06:35,681 - models.nhits - INFO - Epoch   1 | train_loss=270561872.983907 | val_loss=467.550551
2025-10-31 19:06:43,592 - models.nhits - INFO - Epoch   2 | train_loss=106.032330 | val_loss=1.256432
2025-10-31 19:06:51,445 - models.nhits - INFO - Epoch   3 | train_loss=1.016784 | val_loss=0.235574
2025-10-31 19:06:59,376 - models.nhits - INFO - Epoch   4 | train_loss=0.143393 | val_loss=0.065247
2025-10-31 19:07:07,249 - models.nhits - INFO - Epoch   5 | train_loss=0.045890 | val_loss=0.052084
2025-10-31 19:07:07,265 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_190544/patchtst_model.pth
2025-10-31 19:07:07,292 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_190544/nhits_model.pth
2025-10-31 19:07:07,292 - main - INFO - 专家模型训练完成
2025-10-31 19:07:07,295 - main - INFO - 获取专家模型预测...
2025-10-31 19:07:19,718 - main - INFO - 专家预测获取完成
2025-10-31 19:07:19,719 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 19:07:19,719 - main - INFO - 实现策略A：静态优化权重...
2025-10-31 19:07:20,339 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-10-31 19:07:20,347 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = inf
2025-10-31 19:07:20,347 - __main__ - ERROR - 实验失败: '<' not supported between instances of 'numpy.ndarray' and 'str'
2025-10-31 19:18:53,806 - __main__ - INFO - 初始化实验...
2025-10-31 19:18:53,815 - main - INFO - 使用设备: cuda
2025-10-31 19:18:53,817 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 19:18:53,817 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 19:18:53,818 - main - INFO - 开始数据加载和预处理...
2025-10-31 19:18:53,825 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 19:18:55,922 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 19:18:55,925 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:18:55,928 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 19:18:55,932 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:18:55,940 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 19:18:55,940 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 19:18:56,040 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 19:18:56,131 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 19:18:56,131 - main - INFO - 数据预处理完成:
2025-10-31 19:18:56,132 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 19:18:56,132 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 19:18:56,132 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 19:18:56,132 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 19:18:56,132 - main - INFO - 开始训练专家模型...
2025-10-31 19:18:56,132 - main - INFO - 创建PatchTST模型...
2025-10-31 19:18:56,152 - main - INFO - 创建NHITS模型...
2025-10-31 19:18:56,239 - main - INFO - 训练PatchTST...
2025-10-31 19:19:05,692 - models.patchtst - INFO - Epoch   1 | train_loss=0.930020 | val_loss=1.327765
2025-10-31 19:19:12,850 - models.patchtst - INFO - Epoch   2 | train_loss=0.923965 | val_loss=1.327681
2025-10-31 19:19:19,830 - models.patchtst - INFO - Epoch   3 | train_loss=0.923927 | val_loss=1.327925
2025-10-31 19:19:26,881 - models.patchtst - INFO - Epoch   4 | train_loss=0.923984 | val_loss=1.327996
2025-10-31 19:19:34,075 - models.patchtst - INFO - Epoch   5 | train_loss=0.923964 | val_loss=1.327919
2025-10-31 19:19:34,076 - main - INFO - 训练NHITS...
2025-10-31 19:19:41,965 - models.nhits - INFO - Epoch   1 | train_loss=1024214555.330064 | val_loss=700.984497
2025-10-31 19:19:49,892 - models.nhits - INFO - Epoch   2 | train_loss=256.355035 | val_loss=3.160791
2025-10-31 19:19:57,863 - models.nhits - INFO - Epoch   3 | train_loss=0.625988 | val_loss=0.171291
2025-10-31 19:20:05,951 - models.nhits - INFO - Epoch   4 | train_loss=0.127113 | val_loss=0.079061
2025-10-31 19:20:14,042 - models.nhits - INFO - Epoch   5 | train_loss=0.047931 | val_loss=0.070744
2025-10-31 19:20:14,063 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_191853/patchtst_model.pth
2025-10-31 19:20:14,093 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_191853/nhits_model.pth
2025-10-31 19:20:14,093 - main - INFO - 专家模型训练完成
2025-10-31 19:20:14,097 - main - INFO - 获取专家模型预测...
2025-10-31 19:20:26,706 - main - INFO - 专家预测获取完成
2025-10-31 19:20:26,706 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 19:20:26,707 - main - INFO - 实现策略A：静态优化权重...
2025-10-31 19:20:27,382 - __main__ - ERROR - 实验失败: __init__() got an unexpected keyword argument 'quick_iterations'
2025-10-31 21:02:57,924 - __main__ - INFO - 初始化实验...
2025-10-31 21:02:57,932 - main - INFO - 使用设备: cuda
2025-10-31 21:02:57,934 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 21:02:57,934 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 21:02:57,934 - main - INFO - 开始数据加载和预处理...
2025-10-31 21:02:57,943 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 21:02:59,991 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 21:02:59,994 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:02:59,996 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 21:02:59,999 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:03:00,006 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 21:03:00,006 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 21:03:00,109 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 21:03:00,109 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 21:03:00,111 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 21:03:00,111 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 21:03:00,111 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 21:03:00,195 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 21:03:00,195 - main - INFO - 数据预处理完成:
2025-10-31 21:03:00,196 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 21:03:00,196 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 21:03:00,196 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 21:03:00,196 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 21:03:00,196 - main - INFO - 开始训练专家模型...
2025-10-31 21:03:00,196 - main - INFO - 创建PatchTST模型...
2025-10-31 21:03:00,210 - main - INFO - 创建NHITS模型...
2025-10-31 21:03:00,291 - main - INFO - 训练PatchTST...
2025-10-31 21:03:09,814 - models.patchtst - INFO - Epoch   1 | train_loss=0.926916 | val_loss=1.327601
2025-10-31 21:03:16,890 - models.patchtst - INFO - Epoch   2 | train_loss=0.923928 | val_loss=1.327772
2025-10-31 21:03:24,117 - models.patchtst - INFO - Epoch   3 | train_loss=0.923982 | val_loss=1.327709
2025-10-31 21:03:31,041 - models.patchtst - INFO - Epoch   4 | train_loss=0.924158 | val_loss=1.327947
2025-10-31 21:03:38,103 - models.patchtst - INFO - Epoch   5 | train_loss=0.923976 | val_loss=1.327727
2025-10-31 21:03:45,255 - models.patchtst - INFO - Epoch   6 | train_loss=0.923960 | val_loss=1.327616
2025-10-31 21:03:52,232 - models.patchtst - INFO - Epoch   7 | train_loss=0.923922 | val_loss=1.327895
2025-10-31 21:03:59,274 - models.patchtst - INFO - Epoch   8 | train_loss=0.923970 | val_loss=1.328070
2025-10-31 21:04:06,345 - models.patchtst - INFO - Epoch   9 | train_loss=0.924055 | val_loss=1.327914
2025-10-31 21:04:13,341 - models.patchtst - INFO - Epoch  10 | train_loss=0.923974 | val_loss=1.327924
2025-10-31 21:04:20,415 - models.patchtst - INFO - Epoch  11 | train_loss=0.923995 | val_loss=1.327872
2025-10-31 21:04:27,428 - models.patchtst - INFO - Epoch  12 | train_loss=0.923891 | val_loss=1.327721
2025-10-31 21:04:34,393 - models.patchtst - INFO - Epoch  13 | train_loss=0.923946 | val_loss=1.327719
2025-10-31 21:04:41,432 - models.patchtst - INFO - Epoch  14 | train_loss=0.923890 | val_loss=1.327796
2025-10-31 21:04:48,505 - models.patchtst - INFO - Epoch  15 | train_loss=0.923971 | val_loss=1.327792
2025-10-31 21:04:55,575 - models.patchtst - INFO - Epoch  16 | train_loss=0.923915 | val_loss=1.327738
2025-10-31 21:04:55,575 - models.patchtst - INFO - Early stopping at epoch 16早停触发（连续15轮验证损失未下降），最佳验证损失：1.327601
2025-10-31 21:04:55,575 - main - INFO - 训练NHITS...
2025-10-31 21:05:03,547 - models.nhits - INFO - Epoch   1 | train_loss=142982947.711818 | val_loss=1514.754999
2025-10-31 21:05:11,464 - models.nhits - INFO - Epoch   2 | train_loss=130.079976 | val_loss=1.667725
2025-10-31 21:05:19,415 - models.nhits - INFO - Epoch   3 | train_loss=1.202995 | val_loss=0.130437
2025-10-31 21:05:27,343 - models.nhits - INFO - Epoch   4 | train_loss=0.228182 | val_loss=0.103175
2025-10-31 21:05:35,312 - models.nhits - INFO - Epoch   5 | train_loss=0.231288 | val_loss=0.099406
2025-10-31 21:05:43,355 - models.nhits - INFO - Epoch   6 | train_loss=0.065731 | val_loss=0.060304
2025-10-31 21:05:51,311 - models.nhits - INFO - Epoch   7 | train_loss=0.052798 | val_loss=0.056530
2025-10-31 21:05:59,276 - models.nhits - INFO - Epoch   8 | train_loss=0.057506 | val_loss=0.053902
2025-10-31 21:06:07,229 - models.nhits - INFO - Epoch   9 | train_loss=0.048899 | val_loss=0.074760
2025-10-31 21:06:15,286 - models.nhits - INFO - Epoch  10 | train_loss=0.045761 | val_loss=0.083458
2025-10-31 21:06:23,282 - models.nhits - INFO - Epoch  11 | train_loss=0.045600 | val_loss=0.052253
2025-10-31 21:06:31,273 - models.nhits - INFO - Epoch  12 | train_loss=0.076082 | val_loss=0.341558
2025-10-31 21:06:39,345 - models.nhits - INFO - Epoch  13 | train_loss=0.050670 | val_loss=0.086635
2025-10-31 21:06:47,326 - models.nhits - INFO - Epoch  14 | train_loss=0.044703 | val_loss=0.063842
2025-10-31 21:06:55,300 - models.nhits - INFO - Epoch  15 | train_loss=0.051401 | val_loss=0.049234
2025-10-31 21:07:03,283 - models.nhits - INFO - Epoch  16 | train_loss=0.041276 | val_loss=0.045644
2025-10-31 21:07:11,249 - models.nhits - INFO - Epoch  17 | train_loss=0.042849 | val_loss=0.044168
2025-10-31 21:07:19,584 - models.nhits - INFO - Epoch  18 | train_loss=0.038671 | val_loss=0.056054
2025-10-31 21:07:28,095 - models.nhits - INFO - Epoch  19 | train_loss=0.040108 | val_loss=0.045978
2025-10-31 21:07:36,184 - models.nhits - INFO - Epoch  20 | train_loss=1.298016 | val_loss=0.046306
2025-10-31 21:07:44,198 - models.nhits - INFO - Epoch  21 | train_loss=0.038271 | val_loss=0.062345
2025-10-31 21:07:52,233 - models.nhits - INFO - Epoch  22 | train_loss=0.047609 | val_loss=0.048151
2025-10-31 21:08:00,450 - models.nhits - INFO - Epoch  23 | train_loss=0.036704 | val_loss=0.046305
2025-10-31 21:08:08,578 - models.nhits - INFO - Epoch  24 | train_loss=0.074860 | val_loss=0.065706
2025-10-31 21:08:16,567 - models.nhits - INFO - Epoch  25 | train_loss=0.036292 | val_loss=0.048570
2025-10-31 21:08:24,553 - models.nhits - INFO - Epoch  26 | train_loss=0.035327 | val_loss=0.041565
2025-10-31 21:08:32,529 - models.nhits - INFO - Epoch  27 | train_loss=0.035523 | val_loss=0.048226
2025-10-31 21:08:40,501 - models.nhits - INFO - Epoch  28 | train_loss=0.034804 | val_loss=0.041441
2025-10-31 21:08:48,510 - models.nhits - INFO - Epoch  29 | train_loss=0.035074 | val_loss=0.041917
2025-10-31 21:08:56,470 - models.nhits - INFO - Epoch  30 | train_loss=0.034058 | val_loss=0.041676
2025-10-31 21:09:04,474 - models.nhits - INFO - Epoch  31 | train_loss=0.242359 | val_loss=0.041595
2025-10-31 21:09:12,456 - models.nhits - INFO - Epoch  32 | train_loss=0.047400 | val_loss=0.045587
2025-10-31 21:09:20,410 - models.nhits - INFO - Epoch  33 | train_loss=0.033943 | val_loss=0.046173
2025-10-31 21:09:28,419 - models.nhits - INFO - Epoch  34 | train_loss=0.036755 | val_loss=0.039728
2025-10-31 21:09:36,408 - models.nhits - INFO - Epoch  35 | train_loss=0.033391 | val_loss=0.043310
2025-10-31 21:09:44,387 - models.nhits - INFO - Epoch  36 | train_loss=0.038665 | val_loss=0.042405
2025-10-31 21:09:52,348 - models.nhits - INFO - Epoch  37 | train_loss=0.032855 | val_loss=0.046185
2025-10-31 21:10:00,334 - models.nhits - INFO - Epoch  38 | train_loss=0.034068 | val_loss=0.047578
2025-10-31 21:10:08,363 - models.nhits - INFO - Epoch  39 | train_loss=0.035887 | val_loss=0.042102
2025-10-31 21:10:16,407 - models.nhits - INFO - Epoch  40 | train_loss=0.037007 | val_loss=0.043212
2025-10-31 21:10:24,408 - models.nhits - INFO - Epoch  41 | train_loss=0.030886 | val_loss=0.052215
2025-10-31 21:10:32,411 - models.nhits - INFO - Epoch  42 | train_loss=0.032378 | val_loss=0.042312
2025-10-31 21:10:40,423 - models.nhits - INFO - Epoch  43 | train_loss=0.032044 | val_loss=0.044116
2025-10-31 21:10:48,429 - models.nhits - INFO - Epoch  44 | train_loss=5.765156 | val_loss=0.039500
2025-10-31 21:10:56,428 - models.nhits - INFO - Epoch  45 | train_loss=0.065386 | val_loss=0.043489
2025-10-31 21:11:04,432 - models.nhits - INFO - Epoch  46 | train_loss=0.031535 | val_loss=0.051461
2025-10-31 21:11:12,416 - models.nhits - INFO - Epoch  47 | train_loss=0.030934 | val_loss=0.046427
2025-10-31 21:11:20,426 - models.nhits - INFO - Epoch  48 | train_loss=0.035333 | val_loss=0.042915
2025-10-31 21:11:28,445 - models.nhits - INFO - Epoch  49 | train_loss=0.031391 | val_loss=0.041501
2025-10-31 21:11:36,586 - models.nhits - INFO - Epoch  50 | train_loss=0.031382 | val_loss=0.052912
2025-10-31 21:11:45,588 - models.nhits - INFO - Epoch  51 | train_loss=0.038305 | val_loss=0.054292
2025-10-31 21:11:53,713 - models.nhits - INFO - Epoch  52 | train_loss=0.136137 | val_loss=0.039216
2025-10-31 21:12:01,703 - models.nhits - INFO - Epoch  53 | train_loss=0.111808 | val_loss=0.045285
2025-10-31 21:12:09,872 - models.nhits - INFO - Epoch  54 | train_loss=0.030060 | val_loss=0.046130
2025-10-31 21:12:17,979 - models.nhits - INFO - Epoch  55 | train_loss=0.039120 | val_loss=0.040634
2025-10-31 21:12:25,993 - models.nhits - INFO - Epoch  56 | train_loss=0.065822 | val_loss=0.038994
2025-10-31 21:12:34,197 - models.nhits - INFO - Epoch  57 | train_loss=0.033159 | val_loss=0.045349
2025-10-31 21:12:42,528 - models.nhits - INFO - Epoch  58 | train_loss=0.028405 | val_loss=0.055631
2025-10-31 21:12:50,550 - models.nhits - INFO - Epoch  59 | train_loss=0.032979 | val_loss=0.049105
2025-10-31 21:12:58,591 - models.nhits - INFO - Epoch  60 | train_loss=0.188996 | val_loss=0.037810
2025-10-31 21:13:06,597 - models.nhits - INFO - Epoch  61 | train_loss=0.030282 | val_loss=0.039445
2025-10-31 21:13:14,701 - models.nhits - INFO - Epoch  62 | train_loss=0.030935 | val_loss=0.039325
2025-10-31 21:13:22,766 - models.nhits - INFO - Epoch  63 | train_loss=0.069694 | val_loss=0.037508
2025-10-31 21:13:30,866 - models.nhits - INFO - Epoch  64 | train_loss=0.030165 | val_loss=0.038911
2025-10-31 21:13:39,020 - models.nhits - INFO - Epoch  65 | train_loss=0.026565 | val_loss=0.047248
2025-10-31 21:13:47,203 - models.nhits - INFO - Epoch  66 | train_loss=0.033255 | val_loss=0.042888
2025-10-31 21:13:55,484 - models.nhits - INFO - Epoch  67 | train_loss=0.028648 | val_loss=0.040129
2025-10-31 21:14:03,788 - models.nhits - INFO - Epoch  68 | train_loss=47.118838 | val_loss=0.042943
2025-10-31 21:14:12,164 - models.nhits - INFO - Epoch  69 | train_loss=0.292673 | val_loss=0.176266
2025-10-31 21:14:20,228 - models.nhits - INFO - Epoch  70 | train_loss=0.032399 | val_loss=0.051224
2025-10-31 21:14:28,272 - models.nhits - INFO - Epoch  71 | train_loss=0.029789 | val_loss=0.044848
2025-10-31 21:14:36,337 - models.nhits - INFO - Epoch  72 | train_loss=0.028059 | val_loss=0.038437
2025-10-31 21:14:44,332 - models.nhits - INFO - Epoch  73 | train_loss=0.029904 | val_loss=0.037334
2025-10-31 21:14:52,336 - models.nhits - INFO - Epoch  74 | train_loss=0.028920 | val_loss=0.043037
2025-10-31 21:15:00,387 - models.nhits - INFO - Epoch  75 | train_loss=0.035737 | val_loss=0.073674
2025-10-31 21:15:08,500 - models.nhits - INFO - Epoch  76 | train_loss=0.033365 | val_loss=0.044557
2025-10-31 21:15:16,597 - models.nhits - INFO - Epoch  77 | train_loss=0.029004 | val_loss=0.044196
2025-10-31 21:15:25,236 - models.nhits - INFO - Epoch  78 | train_loss=0.028099 | val_loss=0.039354
2025-10-31 21:15:33,853 - models.nhits - INFO - Epoch  79 | train_loss=0.028453 | val_loss=0.052511
2025-10-31 21:15:43,763 - models.nhits - INFO - Epoch  80 | train_loss=0.345870 | val_loss=0.071732
2025-10-31 21:15:52,821 - models.nhits - INFO - Epoch  81 | train_loss=0.028659 | val_loss=0.042390
2025-10-31 21:16:01,847 - models.nhits - INFO - Epoch  82 | train_loss=0.029802 | val_loss=0.053331
2025-10-31 21:16:10,675 - models.nhits - INFO - Epoch  83 | train_loss=1.182726 | val_loss=0.038260
2025-10-31 21:16:19,680 - models.nhits - INFO - Epoch  84 | train_loss=0.029512 | val_loss=0.103662
2025-10-31 21:16:28,630 - models.nhits - INFO - Epoch  85 | train_loss=0.022505 | val_loss=0.038246
2025-10-31 21:16:38,271 - models.nhits - INFO - Epoch  86 | train_loss=0.021942 | val_loss=0.037403
2025-10-31 21:16:47,617 - models.nhits - INFO - Epoch  87 | train_loss=0.021236 | val_loss=0.033014
2025-10-31 21:16:56,513 - models.nhits - INFO - Epoch  88 | train_loss=0.021628 | val_loss=0.035256
2025-10-31 21:17:05,662 - models.nhits - INFO - Epoch  89 | train_loss=0.021789 | val_loss=0.040558
2025-10-31 21:17:15,183 - models.nhits - INFO - Epoch  90 | train_loss=0.021653 | val_loss=0.041198
2025-10-31 21:17:27,099 - models.nhits - INFO - Epoch  91 | train_loss=0.026253 | val_loss=0.034771
2025-10-31 21:17:38,598 - models.nhits - INFO - Epoch  92 | train_loss=0.021398 | val_loss=0.037746
2025-10-31 21:17:49,716 - models.nhits - INFO - Epoch  93 | train_loss=0.021297 | val_loss=0.036036
2025-10-31 21:18:02,312 - models.nhits - INFO - Epoch  94 | train_loss=0.020776 | val_loss=0.038880
2025-10-31 21:18:14,118 - models.nhits - INFO - Epoch  95 | train_loss=0.021056 | val_loss=0.042095
2025-10-31 21:18:26,734 - models.nhits - INFO - Epoch  96 | train_loss=0.021390 | val_loss=0.041710
2025-10-31 21:18:38,638 - models.nhits - INFO - Epoch  97 | train_loss=0.021283 | val_loss=0.035061
2025-10-31 21:18:50,704 - models.nhits - INFO - Epoch  98 | train_loss=0.021016 | val_loss=0.036317
2025-10-31 21:19:01,253 - models.nhits - INFO - Epoch  99 | train_loss=0.018275 | val_loss=0.035375
2025-10-31 21:19:10,941 - models.nhits - INFO - Epoch 100 | train_loss=0.018281 | val_loss=0.035102
2025-10-31 21:19:10,962 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_210257/patchtst_model.pth
2025-10-31 21:19:10,993 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_210257/nhits_model.pth
2025-10-31 21:19:10,993 - main - INFO - 专家模型训练完成
2025-10-31 21:19:10,997 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 21:19:10,997 - __main__ - ERROR - 实验失败: 'FloatingWindPlatformExperiment' object has no attribute 'implement_strategy_a_quick'
2025-10-31 21:35:22,712 - __main__ - INFO - 初始化实验...
2025-10-31 21:35:22,722 - main - INFO - 使用设备: cuda
2025-10-31 21:35:22,723 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 21:35:22,724 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 21:35:22,724 - main - INFO - 开始数据加载和预处理...
2025-10-31 21:35:22,732 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 21:35:24,917 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 21:35:24,921 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:35:24,924 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 21:35:24,926 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:35:24,935 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 21:35:24,935 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 21:35:25,034 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 21:35:25,109 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 21:35:25,109 - main - INFO - 数据预处理完成:
2025-10-31 21:35:25,109 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 21:35:25,109 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 21:35:25,109 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 21:35:25,109 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 21:35:25,109 - main - INFO - 开始训练专家模型...
2025-10-31 21:35:25,109 - main - INFO - 创建PatchTST模型...
2025-10-31 21:35:25,157 - main - INFO - 创建NHITS模型...
2025-10-31 21:35:25,226 - main - INFO - 训练PatchTST...
2025-10-31 21:35:36,247 - models.patchtst - INFO - Epoch   1 | train_loss=0.928080 | val_loss=1.327706
2025-10-31 21:35:43,130 - models.patchtst - INFO - Epoch   2 | train_loss=0.923948 | val_loss=1.327678
2025-10-31 21:35:50,105 - models.patchtst - INFO - Epoch   3 | train_loss=0.924003 | val_loss=1.327883
2025-10-31 21:35:57,080 - models.patchtst - INFO - Epoch   4 | train_loss=0.923788 | val_loss=1.327719
2025-10-31 21:36:04,063 - models.patchtst - INFO - Epoch   5 | train_loss=0.924010 | val_loss=1.327766
2025-10-31 21:36:11,071 - models.patchtst - INFO - Epoch   6 | train_loss=0.923948 | val_loss=1.327622
2025-10-31 21:36:18,119 - models.patchtst - INFO - Epoch   7 | train_loss=0.924027 | val_loss=1.327860
2025-10-31 21:36:25,173 - models.patchtst - INFO - Epoch   8 | train_loss=0.924009 | val_loss=1.327694
2025-10-31 21:36:32,158 - models.patchtst - INFO - Epoch   9 | train_loss=0.923930 | val_loss=1.328088
2025-10-31 21:36:39,204 - models.patchtst - INFO - Epoch  10 | train_loss=0.924005 | val_loss=1.327803
2025-10-31 21:36:46,290 - models.patchtst - INFO - Epoch  11 | train_loss=0.923967 | val_loss=1.327930
2025-10-31 21:36:53,328 - models.patchtst - INFO - Epoch  12 | train_loss=0.923949 | val_loss=1.327836
2025-10-31 21:37:00,367 - models.patchtst - INFO - Epoch  13 | train_loss=0.923964 | val_loss=1.327859
2025-10-31 21:37:07,380 - models.patchtst - INFO - Epoch  14 | train_loss=0.923942 | val_loss=1.327787
2025-10-31 21:37:14,396 - models.patchtst - INFO - Epoch  15 | train_loss=0.924009 | val_loss=1.327747
2025-10-31 21:37:21,412 - models.patchtst - INFO - Epoch  16 | train_loss=0.923937 | val_loss=1.327788
2025-10-31 21:37:28,490 - models.patchtst - INFO - Epoch  17 | train_loss=0.923896 | val_loss=1.327752
2025-10-31 21:37:35,493 - models.patchtst - INFO - Epoch  18 | train_loss=0.923872 | val_loss=1.327772
2025-10-31 21:37:42,515 - models.patchtst - INFO - Epoch  19 | train_loss=0.923922 | val_loss=1.327764
2025-10-31 21:37:49,607 - models.patchtst - INFO - Epoch  20 | train_loss=0.923960 | val_loss=1.327761
2025-10-31 21:37:57,647 - models.patchtst - INFO - Epoch  21 | train_loss=0.923935 | val_loss=1.327817
2025-10-31 21:37:57,648 - models.patchtst - INFO - Early stopping at epoch 21早停触发（连续15轮验证损失未下降），最佳验证损失：1.327622
2025-10-31 21:37:57,648 - main - INFO - 训练NHITS...
2025-10-31 21:38:05,923 - models.nhits - INFO - Epoch   1 | train_loss=750734327.880695 | val_loss=1147.181169
2025-10-31 21:38:13,994 - models.nhits - INFO - Epoch   2 | train_loss=219.628506 | val_loss=3.259921
2025-10-31 21:38:21,978 - models.nhits - INFO - Epoch   3 | train_loss=3.093509 | val_loss=0.466180
2025-10-31 21:38:29,969 - models.nhits - INFO - Epoch   4 | train_loss=0.499598 | val_loss=0.387020
2025-10-31 21:38:38,018 - models.nhits - INFO - Epoch   5 | train_loss=2.780571 | val_loss=0.164792
2025-10-31 21:38:46,036 - models.nhits - INFO - Epoch   6 | train_loss=0.119748 | val_loss=0.129999
2025-10-31 21:38:54,325 - models.nhits - INFO - Epoch   7 | train_loss=0.079232 | val_loss=0.073625
2025-10-31 21:39:02,352 - models.nhits - INFO - Epoch   8 | train_loss=0.069915 | val_loss=0.075808
2025-10-31 21:39:10,524 - models.nhits - INFO - Epoch   9 | train_loss=0.053183 | val_loss=0.078125
2025-10-31 21:39:18,692 - models.nhits - INFO - Epoch  10 | train_loss=0.049835 | val_loss=0.052442
2025-10-31 21:39:26,956 - models.nhits - INFO - Epoch  11 | train_loss=0.323329 | val_loss=1.056833
2025-10-31 21:39:35,062 - models.nhits - INFO - Epoch  12 | train_loss=0.063813 | val_loss=0.054940
2025-10-31 21:39:43,123 - models.nhits - INFO - Epoch  13 | train_loss=0.066745 | val_loss=0.060327
2025-10-31 21:39:51,166 - models.nhits - INFO - Epoch  14 | train_loss=0.043901 | val_loss=0.047261
2025-10-31 21:39:59,157 - models.nhits - INFO - Epoch  15 | train_loss=0.043636 | val_loss=0.051003
2025-10-31 21:40:07,157 - models.nhits - INFO - Epoch  16 | train_loss=0.053498 | val_loss=0.058081
2025-10-31 21:40:15,232 - models.nhits - INFO - Epoch  17 | train_loss=41.290640 | val_loss=0.041484
2025-10-31 21:40:23,261 - models.nhits - INFO - Epoch  18 | train_loss=0.044726 | val_loss=0.046671
2025-10-31 21:40:31,253 - models.nhits - INFO - Epoch  19 | train_loss=0.040665 | val_loss=0.042061
2025-10-31 21:40:39,316 - models.nhits - INFO - Epoch  20 | train_loss=0.040241 | val_loss=0.051929
2025-10-31 21:40:47,400 - models.nhits - INFO - Epoch  21 | train_loss=0.038298 | val_loss=0.041468
2025-10-31 21:40:55,458 - models.nhits - INFO - Epoch  22 | train_loss=0.056028 | val_loss=0.054501
2025-10-31 21:41:03,497 - models.nhits - INFO - Epoch  23 | train_loss=0.039917 | val_loss=0.049625
2025-10-31 21:41:11,477 - models.nhits - INFO - Epoch  24 | train_loss=0.036927 | val_loss=0.052381
2025-10-31 21:41:19,545 - models.nhits - INFO - Epoch  25 | train_loss=0.530970 | val_loss=0.983734
2025-10-31 21:41:27,747 - models.nhits - INFO - Epoch  26 | train_loss=3.684395 | val_loss=0.049798
2025-10-31 21:41:35,841 - models.nhits - INFO - Epoch  27 | train_loss=0.036922 | val_loss=0.056886
2025-10-31 21:41:44,101 - models.nhits - INFO - Epoch  28 | train_loss=0.041543 | val_loss=0.082478
2025-10-31 21:41:52,167 - models.nhits - INFO - Epoch  29 | train_loss=0.041158 | val_loss=0.047388
2025-10-31 21:42:00,213 - models.nhits - INFO - Epoch  30 | train_loss=0.034233 | val_loss=0.042643
2025-10-31 21:42:08,343 - models.nhits - INFO - Epoch  31 | train_loss=0.035207 | val_loss=0.045391
2025-10-31 21:42:16,437 - models.nhits - INFO - Epoch  32 | train_loss=2.049623 | val_loss=0.047176
2025-10-31 21:42:24,520 - models.nhits - INFO - Epoch  33 | train_loss=0.027206 | val_loss=0.037200
2025-10-31 21:42:32,480 - models.nhits - INFO - Epoch  34 | train_loss=0.026762 | val_loss=0.038474
2025-10-31 21:42:40,609 - models.nhits - INFO - Epoch  35 | train_loss=0.026601 | val_loss=0.035195
2025-10-31 21:42:48,623 - models.nhits - INFO - Epoch  36 | train_loss=0.026784 | val_loss=0.038415
2025-10-31 21:42:56,753 - models.nhits - INFO - Epoch  37 | train_loss=0.026438 | val_loss=0.034648
2025-10-31 21:43:04,975 - models.nhits - INFO - Epoch  38 | train_loss=0.025260 | val_loss=0.037819
2025-10-31 21:43:12,963 - models.nhits - INFO - Epoch  39 | train_loss=0.025626 | val_loss=0.040879
2025-10-31 21:43:20,953 - models.nhits - INFO - Epoch  40 | train_loss=0.025284 | val_loss=0.036722
2025-10-31 21:43:28,978 - models.nhits - INFO - Epoch  41 | train_loss=0.024860 | val_loss=0.038360
2025-10-31 21:43:36,975 - models.nhits - INFO - Epoch  42 | train_loss=0.024856 | val_loss=0.040802
2025-10-31 21:43:44,995 - models.nhits - INFO - Epoch  43 | train_loss=0.024898 | val_loss=0.035401
2025-10-31 21:43:53,100 - models.nhits - INFO - Epoch  44 | train_loss=0.024233 | val_loss=0.038113
2025-10-31 21:44:01,153 - models.nhits - INFO - Epoch  45 | train_loss=0.023733 | val_loss=0.034351
2025-10-31 21:44:09,210 - models.nhits - INFO - Epoch  46 | train_loss=0.024146 | val_loss=0.033142
2025-10-31 21:44:17,268 - models.nhits - INFO - Epoch  47 | train_loss=0.023382 | val_loss=0.038446
2025-10-31 21:44:25,264 - models.nhits - INFO - Epoch  48 | train_loss=0.023586 | val_loss=0.035638
2025-10-31 21:44:33,378 - models.nhits - INFO - Epoch  49 | train_loss=0.023987 | val_loss=0.045497
2025-10-31 21:44:41,484 - models.nhits - INFO - Epoch  50 | train_loss=0.024298 | val_loss=0.036311
2025-10-31 21:44:49,529 - models.nhits - INFO - Epoch  51 | train_loss=0.023075 | val_loss=0.037487
2025-10-31 21:44:57,514 - models.nhits - INFO - Epoch  52 | train_loss=0.023425 | val_loss=0.034540
2025-10-31 21:45:05,480 - models.nhits - INFO - Epoch  53 | train_loss=0.023126 | val_loss=0.031241
2025-10-31 21:45:13,521 - models.nhits - INFO - Epoch  54 | train_loss=0.023178 | val_loss=0.031358
2025-10-31 21:45:21,524 - models.nhits - INFO - Epoch  55 | train_loss=0.022751 | val_loss=0.033600
2025-10-31 21:45:29,505 - models.nhits - INFO - Epoch  56 | train_loss=0.022466 | val_loss=0.035611
2025-10-31 21:45:37,498 - models.nhits - INFO - Epoch  57 | train_loss=0.022414 | val_loss=0.037362
2025-10-31 21:45:45,499 - models.nhits - INFO - Epoch  58 | train_loss=0.022200 | val_loss=0.033441
2025-10-31 21:45:53,496 - models.nhits - INFO - Epoch  59 | train_loss=0.022509 | val_loss=0.038575
2025-10-31 21:46:01,515 - models.nhits - INFO - Epoch  60 | train_loss=0.022503 | val_loss=0.034238
2025-10-31 21:46:09,498 - models.nhits - INFO - Epoch  61 | train_loss=0.022206 | val_loss=0.034673
2025-10-31 21:46:17,538 - models.nhits - INFO - Epoch  62 | train_loss=0.021825 | val_loss=0.032269
2025-10-31 21:46:25,591 - models.nhits - INFO - Epoch  63 | train_loss=0.021565 | val_loss=0.036628
2025-10-31 21:46:33,740 - models.nhits - INFO - Epoch  64 | train_loss=0.020868 | val_loss=0.033637
2025-10-31 21:46:41,796 - models.nhits - INFO - Epoch  65 | train_loss=0.018204 | val_loss=0.030814
2025-10-31 21:46:49,806 - models.nhits - INFO - Epoch  66 | train_loss=0.017910 | val_loss=0.030757
2025-10-31 21:46:57,859 - models.nhits - INFO - Epoch  67 | train_loss=0.017932 | val_loss=0.032676
2025-10-31 21:47:06,350 - models.nhits - INFO - Epoch  68 | train_loss=0.017505 | val_loss=0.029183
2025-10-31 21:47:14,733 - models.nhits - INFO - Epoch  69 | train_loss=0.017170 | val_loss=0.028230
2025-10-31 21:47:22,782 - models.nhits - INFO - Epoch  70 | train_loss=0.016828 | val_loss=0.032362
2025-10-31 21:47:31,180 - models.nhits - INFO - Epoch  71 | train_loss=0.016723 | val_loss=0.028649
2025-10-31 21:47:39,268 - models.nhits - INFO - Epoch  72 | train_loss=0.016132 | val_loss=0.031845
2025-10-31 21:47:47,220 - models.nhits - INFO - Epoch  73 | train_loss=0.016794 | val_loss=0.027572
2025-10-31 21:47:55,222 - models.nhits - INFO - Epoch  74 | train_loss=0.015894 | val_loss=0.034374
2025-10-31 21:48:03,507 - models.nhits - INFO - Epoch  75 | train_loss=0.016519 | val_loss=0.032052
2025-10-31 21:48:11,493 - models.nhits - INFO - Epoch  76 | train_loss=0.015864 | val_loss=0.028804
2025-10-31 21:48:19,476 - models.nhits - INFO - Epoch  77 | train_loss=0.015201 | val_loss=0.027263
2025-10-31 21:48:27,525 - models.nhits - INFO - Epoch  78 | train_loss=0.015400 | val_loss=0.035192
2025-10-31 21:48:35,692 - models.nhits - INFO - Epoch  79 | train_loss=0.015251 | val_loss=0.028276
2025-10-31 21:48:43,720 - models.nhits - INFO - Epoch  80 | train_loss=0.014802 | val_loss=0.033015
2025-10-31 21:48:51,807 - models.nhits - INFO - Epoch  81 | train_loss=0.014677 | val_loss=0.027904
2025-10-31 21:48:59,871 - models.nhits - INFO - Epoch  82 | train_loss=0.014979 | val_loss=0.028131
2025-10-31 21:49:07,876 - models.nhits - INFO - Epoch  83 | train_loss=0.014928 | val_loss=0.028661
2025-10-31 21:49:15,851 - models.nhits - INFO - Epoch  84 | train_loss=0.014443 | val_loss=0.032063
2025-10-31 21:49:23,847 - models.nhits - INFO - Epoch  85 | train_loss=0.014595 | val_loss=0.026778
2025-10-31 21:49:31,858 - models.nhits - INFO - Epoch  86 | train_loss=0.014308 | val_loss=0.029680
2025-10-31 21:49:39,843 - models.nhits - INFO - Epoch  87 | train_loss=0.014210 | val_loss=0.028854
2025-10-31 21:49:47,871 - models.nhits - INFO - Epoch  88 | train_loss=0.014508 | val_loss=0.033698
2025-10-31 21:49:55,838 - models.nhits - INFO - Epoch  89 | train_loss=0.013935 | val_loss=0.027622
2025-10-31 21:50:03,905 - models.nhits - INFO - Epoch  90 | train_loss=0.014211 | val_loss=0.028492
2025-10-31 21:50:11,826 - models.nhits - INFO - Epoch  91 | train_loss=0.014022 | val_loss=0.028714
2025-10-31 21:50:19,881 - models.nhits - INFO - Epoch  92 | train_loss=0.014939 | val_loss=0.031928
2025-10-31 21:50:27,919 - models.nhits - INFO - Epoch  93 | train_loss=0.013785 | val_loss=0.026364
2025-10-31 21:50:35,921 - models.nhits - INFO - Epoch  94 | train_loss=0.013593 | val_loss=0.028734
2025-10-31 21:50:43,926 - models.nhits - INFO - Epoch  95 | train_loss=0.014233 | val_loss=0.027994
2025-10-31 21:50:51,886 - models.nhits - INFO - Epoch  96 | train_loss=0.013488 | val_loss=0.029180
2025-10-31 21:50:59,964 - models.nhits - INFO - Epoch  97 | train_loss=0.013688 | val_loss=0.026720
2025-10-31 21:51:07,938 - models.nhits - INFO - Epoch  98 | train_loss=0.013453 | val_loss=0.028643
2025-10-31 21:51:15,951 - models.nhits - INFO - Epoch  99 | train_loss=0.013499 | val_loss=0.025335
2025-10-31 21:51:23,950 - models.nhits - INFO - Epoch 100 | train_loss=0.013538 | val_loss=0.032053
2025-10-31 21:51:23,980 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_213522/patchtst_model.pth
2025-10-31 21:51:24,012 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_213522/nhits_model.pth
2025-10-31 21:51:24,012 - main - INFO - 专家模型训练完成
2025-10-31 21:51:24,016 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 21:51:24,016 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-10-31 21:51:24,016 - __main__ - ERROR - 实验失败: 'FloatingWindPlatformExperiment' object has no attribute 'expert_predictions'
2025-11-01 12:49:07,101 - __main__ - INFO - 初始化实验...
2025-11-01 12:49:07,112 - main - INFO - 使用设备: cuda
2025-11-01 12:49:07,115 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 12:49:07,115 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 12:49:07,115 - main - INFO - 开始数据加载和预处理...
2025-11-01 12:49:07,123 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 12:49:09,283 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 12:49:09,285 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 12:49:09,288 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 12:49:09,290 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 12:49:09,297 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 12:49:09,297 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 12:49:09,368 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 12:49:09,368 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 12:49:09,368 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 12:49:09,369 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 12:49:09,369 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 12:49:09,435 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 12:49:09,435 - main - INFO - 数据预处理完成:
2025-11-01 12:49:09,435 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 12:49:09,435 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 12:49:09,435 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 12:49:09,435 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 12:49:09,435 - main - INFO - 开始训练专家模型...
2025-11-01 12:49:09,435 - main - INFO - 创建PatchTST模型...
2025-11-01 12:49:09,474 - main - INFO - 创建NHITS模型...
2025-11-01 12:49:09,540 - main - INFO - 训练PatchTST...
2025-11-01 12:49:19,540 - models.patchtst - INFO - Epoch   1 | train_loss=0.928160 | val_loss=1.327867
2025-11-01 12:49:26,437 - models.patchtst - INFO - Epoch   2 | train_loss=0.923977 | val_loss=1.327633
2025-11-01 12:49:33,561 - models.patchtst - INFO - Epoch   3 | train_loss=0.924023 | val_loss=1.327864
2025-11-01 12:49:40,452 - models.patchtst - INFO - Epoch   4 | train_loss=0.924040 | val_loss=1.327717
2025-11-01 12:49:47,380 - models.patchtst - INFO - Epoch   5 | train_loss=0.923992 | val_loss=1.327835
2025-11-01 12:49:54,283 - models.patchtst - INFO - Epoch   6 | train_loss=0.923937 | val_loss=1.327911
2025-11-01 12:50:01,246 - models.patchtst - INFO - Epoch   7 | train_loss=0.923977 | val_loss=1.327600
2025-11-01 12:50:08,191 - models.patchtst - INFO - Epoch   8 | train_loss=0.924023 | val_loss=1.327745
2025-11-01 12:50:15,175 - models.patchtst - INFO - Epoch   9 | train_loss=0.924023 | val_loss=1.327648
2025-11-01 12:50:22,150 - models.patchtst - INFO - Epoch  10 | train_loss=0.924027 | val_loss=1.327803
2025-11-01 12:50:29,170 - models.patchtst - INFO - Epoch  11 | train_loss=0.923944 | val_loss=1.327698
2025-11-01 12:50:36,193 - models.patchtst - INFO - Epoch  12 | train_loss=0.924035 | val_loss=1.327864
2025-11-01 12:50:43,244 - models.patchtst - INFO - Epoch  13 | train_loss=0.923940 | val_loss=1.327756
2025-11-01 12:50:50,329 - models.patchtst - INFO - Epoch  14 | train_loss=0.923930 | val_loss=1.327724
2025-11-01 12:50:57,482 - models.patchtst - INFO - Epoch  15 | train_loss=0.923906 | val_loss=1.327764
2025-11-01 12:51:04,626 - models.patchtst - INFO - Epoch  16 | train_loss=0.923920 | val_loss=1.327838
2025-11-01 12:51:11,667 - models.patchtst - INFO - Epoch  17 | train_loss=0.923869 | val_loss=1.327943
2025-11-01 12:51:18,765 - models.patchtst - INFO - Epoch  18 | train_loss=0.923948 | val_loss=1.327841
2025-11-01 12:51:25,836 - models.patchtst - INFO - Epoch  19 | train_loss=0.923870 | val_loss=1.327704
2025-11-01 12:51:32,914 - models.patchtst - INFO - Epoch  20 | train_loss=0.924042 | val_loss=1.327717
2025-11-01 12:51:39,980 - models.patchtst - INFO - Epoch  21 | train_loss=0.923831 | val_loss=1.327767
2025-11-01 12:51:47,064 - models.patchtst - INFO - Epoch  22 | train_loss=0.923885 | val_loss=1.327804
2025-11-01 12:51:47,064 - models.patchtst - INFO - Early stopping at epoch 22早停触发（连续15轮验证损失未下降），最佳验证损失：1.327600
2025-11-01 12:51:47,064 - main - INFO - 训练NHITS...
2025-11-01 12:51:54,955 - models.nhits - INFO - Epoch   1 | train_loss=290956859.716107 | val_loss=462.947290
2025-11-01 12:52:02,875 - models.nhits - INFO - Epoch   2 | train_loss=116.449617 | val_loss=1.888875
2025-11-01 12:52:10,790 - models.nhits - INFO - Epoch   3 | train_loss=0.570158 | val_loss=0.121802
2025-11-01 12:52:18,633 - models.nhits - INFO - Epoch   4 | train_loss=0.077018 | val_loss=0.067636
2025-11-01 12:52:26,505 - models.nhits - INFO - Epoch   5 | train_loss=0.043173 | val_loss=0.044596
2025-11-01 12:52:34,364 - models.nhits - INFO - Epoch   6 | train_loss=0.040320 | val_loss=0.058222
2025-11-01 12:52:42,230 - models.nhits - INFO - Epoch   7 | train_loss=10.761784 | val_loss=0.067059
2025-11-01 12:52:50,092 - models.nhits - INFO - Epoch   8 | train_loss=0.034723 | val_loss=0.047695
2025-11-01 12:52:57,917 - models.nhits - INFO - Epoch   9 | train_loss=0.091340 | val_loss=0.052904
2025-11-01 12:53:05,772 - models.nhits - INFO - Epoch  10 | train_loss=0.034603 | val_loss=0.039610
2025-11-01 12:53:13,600 - models.nhits - INFO - Epoch  11 | train_loss=0.036037 | val_loss=0.053623
2025-11-01 12:53:21,528 - models.nhits - INFO - Epoch  12 | train_loss=0.035705 | val_loss=0.050852
2025-11-01 12:53:29,597 - models.nhits - INFO - Epoch  13 | train_loss=0.032355 | val_loss=0.041997
2025-11-01 12:53:37,862 - models.nhits - INFO - Epoch  14 | train_loss=0.041507 | val_loss=0.040738
2025-11-01 12:53:46,052 - models.nhits - INFO - Epoch  15 | train_loss=0.033314 | val_loss=0.039980
2025-11-01 12:53:54,152 - models.nhits - INFO - Epoch  16 | train_loss=1.477184 | val_loss=0.059124
2025-11-01 12:54:02,275 - models.nhits - INFO - Epoch  17 | train_loss=0.031252 | val_loss=0.055952
2025-11-01 12:54:10,457 - models.nhits - INFO - Epoch  18 | train_loss=0.028799 | val_loss=0.041333
2025-11-01 12:54:18,622 - models.nhits - INFO - Epoch  19 | train_loss=0.052183 | val_loss=0.035773
2025-11-01 12:54:26,876 - models.nhits - INFO - Epoch  20 | train_loss=0.027889 | val_loss=0.038444
2025-11-01 12:54:34,920 - models.nhits - INFO - Epoch  21 | train_loss=0.240175 | val_loss=0.046370
2025-11-01 12:54:42,908 - models.nhits - INFO - Epoch  22 | train_loss=0.057335 | val_loss=0.057435
2025-11-01 12:54:50,839 - models.nhits - INFO - Epoch  23 | train_loss=0.034465 | val_loss=0.048274
2025-11-01 12:54:58,696 - models.nhits - INFO - Epoch  24 | train_loss=0.027661 | val_loss=0.055764
2025-11-01 12:55:06,534 - models.nhits - INFO - Epoch  25 | train_loss=0.043883 | val_loss=0.038926
2025-11-01 12:55:14,377 - models.nhits - INFO - Epoch  26 | train_loss=0.026462 | val_loss=0.049364
2025-11-01 12:55:22,185 - models.nhits - INFO - Epoch  27 | train_loss=2.762483 | val_loss=0.037563
2025-11-01 12:55:30,007 - models.nhits - INFO - Epoch  28 | train_loss=0.027060 | val_loss=0.047353
2025-11-01 12:55:37,826 - models.nhits - INFO - Epoch  29 | train_loss=6.535511 | val_loss=0.037760
2025-11-01 12:55:45,647 - models.nhits - INFO - Epoch  30 | train_loss=0.121939 | val_loss=0.040947
2025-11-01 12:55:53,464 - models.nhits - INFO - Epoch  31 | train_loss=0.019974 | val_loss=0.032040
2025-11-01 12:56:01,291 - models.nhits - INFO - Epoch  32 | train_loss=0.020352 | val_loss=0.037105
2025-11-01 12:56:09,093 - models.nhits - INFO - Epoch  33 | train_loss=0.021009 | val_loss=0.030133
2025-11-01 12:56:16,882 - models.nhits - INFO - Epoch  34 | train_loss=0.018929 | val_loss=0.033228
2025-11-01 12:56:24,692 - models.nhits - INFO - Epoch  35 | train_loss=0.019023 | val_loss=0.030832
2025-11-01 12:56:32,544 - models.nhits - INFO - Epoch  36 | train_loss=0.017890 | val_loss=0.026306
2025-11-01 12:56:40,364 - models.nhits - INFO - Epoch  37 | train_loss=0.017765 | val_loss=0.035099
2025-11-01 12:56:48,180 - models.nhits - INFO - Epoch  38 | train_loss=0.089957 | val_loss=0.030087
2025-11-01 12:56:56,001 - models.nhits - INFO - Epoch  39 | train_loss=0.018122 | val_loss=0.030976
2025-11-01 12:57:03,801 - models.nhits - INFO - Epoch  40 | train_loss=0.018302 | val_loss=0.029281
2025-11-01 12:57:11,625 - models.nhits - INFO - Epoch  41 | train_loss=0.018162 | val_loss=0.035956
2025-11-01 12:57:19,416 - models.nhits - INFO - Epoch  42 | train_loss=0.017872 | val_loss=0.027086
2025-11-01 12:57:27,226 - models.nhits - INFO - Epoch  43 | train_loss=0.016875 | val_loss=0.031939
2025-11-01 12:57:35,004 - models.nhits - INFO - Epoch  44 | train_loss=0.023480 | val_loss=0.025426
2025-11-01 12:57:42,816 - models.nhits - INFO - Epoch  45 | train_loss=0.017651 | val_loss=0.023383
2025-11-01 12:57:50,609 - models.nhits - INFO - Epoch  46 | train_loss=0.016005 | val_loss=0.029439
2025-11-01 12:57:58,441 - models.nhits - INFO - Epoch  47 | train_loss=0.016648 | val_loss=0.023137
2025-11-01 12:58:06,240 - models.nhits - INFO - Epoch  48 | train_loss=0.015993 | val_loss=0.026039
2025-11-01 12:58:14,065 - models.nhits - INFO - Epoch  49 | train_loss=0.020446 | val_loss=0.029632
2025-11-01 12:58:21,866 - models.nhits - INFO - Epoch  50 | train_loss=0.018325 | val_loss=0.033318
2025-11-01 12:58:29,662 - models.nhits - INFO - Epoch  51 | train_loss=0.015999 | val_loss=0.034175
2025-11-01 12:58:37,866 - models.nhits - INFO - Epoch  52 | train_loss=0.022288 | val_loss=0.026215
2025-11-01 12:58:45,936 - models.nhits - INFO - Epoch  53 | train_loss=0.016553 | val_loss=0.027416
2025-11-01 12:58:54,036 - models.nhits - INFO - Epoch  54 | train_loss=0.016327 | val_loss=0.027439
2025-11-01 12:59:02,114 - models.nhits - INFO - Epoch  55 | train_loss=0.014880 | val_loss=0.027410
2025-11-01 12:59:10,179 - models.nhits - INFO - Epoch  56 | train_loss=0.015663 | val_loss=0.025473
2025-11-01 12:59:18,304 - models.nhits - INFO - Epoch  57 | train_loss=0.016978 | val_loss=0.027197
2025-11-01 12:59:26,500 - models.nhits - INFO - Epoch  58 | train_loss=0.015043 | val_loss=0.023880
2025-11-01 12:59:34,495 - models.nhits - INFO - Epoch  59 | train_loss=0.012421 | val_loss=0.022540
2025-11-01 12:59:42,580 - models.nhits - INFO - Epoch  60 | train_loss=0.011946 | val_loss=0.021107
2025-11-01 12:59:50,649 - models.nhits - INFO - Epoch  61 | train_loss=0.011677 | val_loss=0.021332
2025-11-01 12:59:58,699 - models.nhits - INFO - Epoch  62 | train_loss=0.011729 | val_loss=0.022007
2025-11-01 13:00:06,832 - models.nhits - INFO - Epoch  63 | train_loss=0.011307 | val_loss=0.019738
2025-11-01 13:00:14,887 - models.nhits - INFO - Epoch  64 | train_loss=0.011672 | val_loss=0.021060
2025-11-01 13:00:22,981 - models.nhits - INFO - Epoch  65 | train_loss=0.011681 | val_loss=0.023333
2025-11-01 13:00:31,134 - models.nhits - INFO - Epoch  66 | train_loss=0.012046 | val_loss=0.024351
2025-11-01 13:00:39,315 - models.nhits - INFO - Epoch  67 | train_loss=0.011903 | val_loss=0.023068
2025-11-01 13:00:47,430 - models.nhits - INFO - Epoch  68 | train_loss=0.011181 | val_loss=0.020099
2025-11-01 13:00:55,517 - models.nhits - INFO - Epoch  69 | train_loss=0.011356 | val_loss=0.021438
2025-11-01 13:01:03,733 - models.nhits - INFO - Epoch  70 | train_loss=0.011477 | val_loss=0.022240
2025-11-01 13:01:11,864 - models.nhits - INFO - Epoch  71 | train_loss=0.011297 | val_loss=0.018876
2025-11-01 13:01:20,084 - models.nhits - INFO - Epoch  72 | train_loss=0.011627 | val_loss=0.020929
2025-11-01 13:01:28,192 - models.nhits - INFO - Epoch  73 | train_loss=0.011070 | val_loss=0.021237
2025-11-01 13:01:36,554 - models.nhits - INFO - Epoch  74 | train_loss=0.011499 | val_loss=0.020259
2025-11-01 13:01:44,660 - models.nhits - INFO - Epoch  75 | train_loss=0.010791 | val_loss=0.020879
2025-11-01 13:01:52,783 - models.nhits - INFO - Epoch  76 | train_loss=0.011206 | val_loss=0.019120
2025-11-01 13:02:00,953 - models.nhits - INFO - Epoch  77 | train_loss=0.010842 | val_loss=0.018999
2025-11-01 13:02:09,040 - models.nhits - INFO - Epoch  78 | train_loss=0.010609 | val_loss=0.018814
2025-11-01 13:02:17,140 - models.nhits - INFO - Epoch  79 | train_loss=0.010517 | val_loss=0.022145
2025-11-01 13:02:25,409 - models.nhits - INFO - Epoch  80 | train_loss=0.011043 | val_loss=0.021087
2025-11-01 13:02:33,531 - models.nhits - INFO - Epoch  81 | train_loss=0.010544 | val_loss=0.021398
2025-11-01 13:02:41,710 - models.nhits - INFO - Epoch  82 | train_loss=0.010729 | val_loss=0.020781
2025-11-01 13:02:49,815 - models.nhits - INFO - Epoch  83 | train_loss=0.010720 | val_loss=0.020135
2025-11-01 13:02:57,920 - models.nhits - INFO - Epoch  84 | train_loss=0.010833 | val_loss=0.023150
2025-11-01 13:03:06,105 - models.nhits - INFO - Epoch  85 | train_loss=0.010521 | val_loss=0.023013
2025-11-01 13:03:14,196 - models.nhits - INFO - Epoch  86 | train_loss=0.010664 | val_loss=0.019448
2025-11-01 13:03:22,325 - models.nhits - INFO - Epoch  87 | train_loss=0.010572 | val_loss=0.022198
2025-11-01 13:03:30,437 - models.nhits - INFO - Epoch  88 | train_loss=0.010958 | val_loss=0.023271
2025-11-01 13:03:38,662 - models.nhits - INFO - Epoch  89 | train_loss=0.010452 | val_loss=0.019636
2025-11-01 13:03:46,808 - models.nhits - INFO - Epoch  90 | train_loss=0.009408 | val_loss=0.019175
2025-11-01 13:03:54,972 - models.nhits - INFO - Epoch  91 | train_loss=0.009111 | val_loss=0.018454
2025-11-01 13:04:03,077 - models.nhits - INFO - Epoch  92 | train_loss=0.008837 | val_loss=0.018459
2025-11-01 13:04:11,211 - models.nhits - INFO - Epoch  93 | train_loss=0.008856 | val_loss=0.019128
2025-11-01 13:04:19,384 - models.nhits - INFO - Epoch  94 | train_loss=0.008810 | val_loss=0.019997
2025-11-01 13:04:27,600 - models.nhits - INFO - Epoch  95 | train_loss=0.008518 | val_loss=0.018201
2025-11-01 13:04:35,732 - models.nhits - INFO - Epoch  96 | train_loss=0.008493 | val_loss=0.020526
2025-11-01 13:04:43,905 - models.nhits - INFO - Epoch  97 | train_loss=0.008686 | val_loss=0.018398
2025-11-01 13:04:52,043 - models.nhits - INFO - Epoch  98 | train_loss=0.008193 | val_loss=0.020833
2025-11-01 13:05:00,323 - models.nhits - INFO - Epoch  99 | train_loss=0.008286 | val_loss=0.018140
2025-11-01 13:05:08,525 - models.nhits - INFO - Epoch 100 | train_loss=0.008069 | val_loss=0.018472
2025-11-01 13:05:08,541 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_124907/patchtst_model.pth
2025-11-01 13:05:08,570 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_124907/nhits_model.pth
2025-11-01 13:05:08,570 - main - INFO - 专家模型训练完成
2025-11-01 13:05:08,573 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 13:05:08,573 - main - INFO - 获取专家模型预测...
2025-11-01 13:05:21,527 - main - INFO - 专家预测获取完成
2025-11-01 13:05:21,528 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 13:05:22,194 - __main__ - ERROR - 实验失败: name 'StaticWeightOptimizer' is not defined
2025-11-01 14:46:37,603 - __main__ - INFO - 初始化实验...
2025-11-01 14:46:37,612 - main - INFO - 使用设备: cuda
2025-11-01 14:46:37,614 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 14:46:37,614 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 14:46:37,614 - main - INFO - 开始数据加载和预处理...
2025-11-01 14:46:37,623 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 14:46:39,751 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 14:46:39,754 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 14:46:39,757 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 14:46:39,758 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 14:46:39,764 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 14:46:39,764 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 14:46:39,838 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 14:46:39,913 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 14:46:39,913 - main - INFO - 数据预处理完成:
2025-11-01 14:46:39,913 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 14:46:39,913 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 14:46:39,914 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 14:46:39,914 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 14:46:39,914 - main - INFO - 开始训练专家模型...
2025-11-01 14:46:39,914 - main - INFO - 创建PatchTST模型...
2025-11-01 14:46:39,953 - main - INFO - 创建NHITS模型...
2025-11-01 14:46:40,012 - main - INFO - 训练PatchTST...
2025-11-01 14:46:50,068 - models.patchtst - INFO - Epoch   1 | train_loss=0.926848 | val_loss=1.327756
2025-11-01 14:46:57,058 - models.patchtst - INFO - Epoch   2 | train_loss=0.923914 | val_loss=1.327630
2025-11-01 14:47:04,033 - models.patchtst - INFO - Epoch   3 | train_loss=0.924053 | val_loss=1.327828
2025-11-01 14:47:11,058 - models.patchtst - INFO - Epoch   4 | train_loss=0.924016 | val_loss=1.327830
2025-11-01 14:47:18,054 - models.patchtst - INFO - Epoch   5 | train_loss=0.923982 | val_loss=1.327889
2025-11-01 14:47:25,216 - models.patchtst - INFO - Epoch   6 | train_loss=0.923917 | val_loss=1.327838
2025-11-01 14:47:32,396 - models.patchtst - INFO - Epoch   7 | train_loss=0.924012 | val_loss=1.327730
2025-11-01 14:47:39,655 - models.patchtst - INFO - Epoch   8 | train_loss=0.923979 | val_loss=1.327683
2025-11-01 14:47:46,757 - models.patchtst - INFO - Epoch   9 | train_loss=0.924012 | val_loss=1.327728
2025-11-01 14:47:53,910 - models.patchtst - INFO - Epoch  10 | train_loss=0.923918 | val_loss=1.328104
2025-11-01 14:48:01,020 - models.patchtst - INFO - Epoch  11 | train_loss=0.923991 | val_loss=1.327719
2025-11-01 14:48:08,101 - models.patchtst - INFO - Epoch  12 | train_loss=0.923967 | val_loss=1.327857
2025-11-01 14:48:15,181 - models.patchtst - INFO - Epoch  13 | train_loss=0.923976 | val_loss=1.327856
2025-11-01 14:48:22,264 - models.patchtst - INFO - Epoch  14 | train_loss=0.923927 | val_loss=1.327776
2025-11-01 14:48:29,343 - models.patchtst - INFO - Epoch  15 | train_loss=0.923901 | val_loss=1.327753
2025-11-01 14:48:36,431 - models.patchtst - INFO - Epoch  16 | train_loss=0.923908 | val_loss=1.327787
2025-11-01 14:48:43,620 - models.patchtst - INFO - Epoch  17 | train_loss=0.923928 | val_loss=1.327798
2025-11-01 14:48:43,620 - models.patchtst - INFO - Early stopping at epoch 17早停触发（连续15轮验证损失未下降），最佳验证损失：1.327630
2025-11-01 14:48:43,620 - main - INFO - 训练NHITS...
2025-11-01 14:48:51,643 - models.nhits - INFO - Epoch   1 | train_loss=511531947.700916 | val_loss=1246.921167
2025-11-01 14:48:59,614 - models.nhits - INFO - Epoch   2 | train_loss=103.820659 | val_loss=1.261165
2025-11-01 14:49:07,639 - models.nhits - INFO - Epoch   3 | train_loss=1.161314 | val_loss=0.133873
2025-11-01 14:49:15,662 - models.nhits - INFO - Epoch   4 | train_loss=0.155268 | val_loss=0.054662
2025-11-01 14:49:23,665 - models.nhits - INFO - Epoch   5 | train_loss=0.049227 | val_loss=0.053077
2025-11-01 14:49:31,628 - models.nhits - INFO - Epoch   6 | train_loss=0.039488 | val_loss=0.058875
2025-11-01 14:49:39,620 - models.nhits - INFO - Epoch   7 | train_loss=0.247428 | val_loss=0.048047
2025-11-01 14:49:47,569 - models.nhits - INFO - Epoch   8 | train_loss=0.035007 | val_loss=0.043007
2025-11-01 14:49:55,537 - models.nhits - INFO - Epoch   9 | train_loss=0.036265 | val_loss=0.060841
2025-11-01 14:50:03,501 - models.nhits - INFO - Epoch  10 | train_loss=0.078076 | val_loss=0.042370
2025-11-01 14:50:11,440 - models.nhits - INFO - Epoch  11 | train_loss=0.031104 | val_loss=0.060357
2025-11-01 14:50:19,407 - models.nhits - INFO - Epoch  12 | train_loss=0.033086 | val_loss=0.075760
2025-11-01 14:50:27,347 - models.nhits - INFO - Epoch  13 | train_loss=0.030572 | val_loss=0.039600
2025-11-01 14:50:35,300 - models.nhits - INFO - Epoch  14 | train_loss=0.079453 | val_loss=0.061929
2025-11-01 14:50:43,249 - models.nhits - INFO - Epoch  15 | train_loss=0.031319 | val_loss=0.039196
2025-11-01 14:50:51,182 - models.nhits - INFO - Epoch  16 | train_loss=0.028459 | val_loss=0.041849
2025-11-01 14:50:59,145 - models.nhits - INFO - Epoch  17 | train_loss=0.029062 | val_loss=0.045885
2025-11-01 14:51:07,094 - models.nhits - INFO - Epoch  18 | train_loss=0.284606 | val_loss=0.036131
2025-11-01 14:51:15,048 - models.nhits - INFO - Epoch  19 | train_loss=0.065743 | val_loss=0.136267
2025-11-01 14:51:22,986 - models.nhits - INFO - Epoch  20 | train_loss=0.031938 | val_loss=0.049211
2025-11-01 14:51:30,922 - models.nhits - INFO - Epoch  21 | train_loss=0.030589 | val_loss=0.037819
2025-11-01 14:51:38,828 - models.nhits - INFO - Epoch  22 | train_loss=0.026381 | val_loss=0.040536
2025-11-01 14:51:46,744 - models.nhits - INFO - Epoch  23 | train_loss=1.133351 | val_loss=0.034066
2025-11-01 14:51:54,661 - models.nhits - INFO - Epoch  24 | train_loss=0.030507 | val_loss=0.295925
2025-11-01 14:52:02,627 - models.nhits - INFO - Epoch  25 | train_loss=0.034163 | val_loss=0.046096
2025-11-01 14:52:10,602 - models.nhits - INFO - Epoch  26 | train_loss=0.031859 | val_loss=0.037207
2025-11-01 14:52:18,588 - models.nhits - INFO - Epoch  27 | train_loss=0.026809 | val_loss=0.033879
2025-11-01 14:52:26,570 - models.nhits - INFO - Epoch  28 | train_loss=0.460372 | val_loss=0.032977
2025-11-01 14:52:34,552 - models.nhits - INFO - Epoch  29 | train_loss=0.027225 | val_loss=0.046186
2025-11-01 14:52:42,551 - models.nhits - INFO - Epoch  30 | train_loss=0.065559 | val_loss=0.034227
2025-11-01 14:52:50,538 - models.nhits - INFO - Epoch  31 | train_loss=0.053585 | val_loss=3.699667
2025-11-01 14:52:58,551 - models.nhits - INFO - Epoch  32 | train_loss=0.340715 | val_loss=0.037135
2025-11-01 14:53:06,512 - models.nhits - INFO - Epoch  33 | train_loss=0.028702 | val_loss=0.032510
2025-11-01 14:53:14,481 - models.nhits - INFO - Epoch  34 | train_loss=0.027967 | val_loss=0.041620
2025-11-01 14:53:22,500 - models.nhits - INFO - Epoch  35 | train_loss=0.092132 | val_loss=0.031015
2025-11-01 14:53:30,494 - models.nhits - INFO - Epoch  36 | train_loss=0.038588 | val_loss=0.046375
2025-11-01 14:53:38,984 - models.nhits - INFO - Epoch  37 | train_loss=0.026566 | val_loss=0.041941
2025-11-01 14:53:47,534 - models.nhits - INFO - Epoch  38 | train_loss=0.050538 | val_loss=0.040394
2025-11-01 14:53:55,945 - models.nhits - INFO - Epoch  39 | train_loss=0.366425 | val_loss=0.053784
2025-11-01 14:54:04,220 - models.nhits - INFO - Epoch  40 | train_loss=0.033706 | val_loss=0.037549
2025-11-01 14:54:12,454 - models.nhits - INFO - Epoch  41 | train_loss=0.063200 | val_loss=0.050369
2025-11-01 14:54:20,617 - models.nhits - INFO - Epoch  42 | train_loss=0.025664 | val_loss=0.031341
2025-11-01 14:54:28,810 - models.nhits - INFO - Epoch  43 | train_loss=0.035469 | val_loss=0.035296
2025-11-01 14:54:37,117 - models.nhits - INFO - Epoch  44 | train_loss=0.035894 | val_loss=0.054420
2025-11-01 14:54:45,151 - models.nhits - INFO - Epoch  45 | train_loss=0.064086 | val_loss=0.076388
2025-11-01 14:54:53,134 - models.nhits - INFO - Epoch  46 | train_loss=0.026589 | val_loss=0.027151
2025-11-01 14:55:01,117 - models.nhits - INFO - Epoch  47 | train_loss=0.257154 | val_loss=0.044666
2025-11-01 14:55:09,095 - models.nhits - INFO - Epoch  48 | train_loss=0.029088 | val_loss=0.042424
2025-11-01 14:55:17,098 - models.nhits - INFO - Epoch  49 | train_loss=0.024805 | val_loss=0.046327
2025-11-01 14:55:25,137 - models.nhits - INFO - Epoch  50 | train_loss=0.038721 | val_loss=0.032447
2025-11-01 14:55:33,214 - models.nhits - INFO - Epoch  51 | train_loss=3.003416 | val_loss=0.893546
2025-11-01 14:55:41,285 - models.nhits - INFO - Epoch  52 | train_loss=0.031183 | val_loss=0.032023
2025-11-01 14:55:49,364 - models.nhits - INFO - Epoch  53 | train_loss=0.210600 | val_loss=0.039270
2025-11-01 14:55:57,492 - models.nhits - INFO - Epoch  54 | train_loss=0.027358 | val_loss=0.041240
2025-11-01 14:56:05,639 - models.nhits - INFO - Epoch  55 | train_loss=0.026551 | val_loss=0.039490
2025-11-01 14:56:13,726 - models.nhits - INFO - Epoch  56 | train_loss=0.030718 | val_loss=0.035079
2025-11-01 14:56:21,801 - models.nhits - INFO - Epoch  57 | train_loss=0.053843 | val_loss=0.036446
2025-11-01 14:56:29,888 - models.nhits - INFO - Epoch  58 | train_loss=0.018237 | val_loss=0.027629
2025-11-01 14:56:37,973 - models.nhits - INFO - Epoch  59 | train_loss=0.017427 | val_loss=0.023872
2025-11-01 14:56:46,045 - models.nhits - INFO - Epoch  60 | train_loss=0.016367 | val_loss=0.029873
2025-11-01 14:56:54,118 - models.nhits - INFO - Epoch  61 | train_loss=0.017415 | val_loss=0.027775
2025-11-01 14:57:02,239 - models.nhits - INFO - Epoch  62 | train_loss=0.017204 | val_loss=0.024409
2025-11-01 14:57:10,340 - models.nhits - INFO - Epoch  63 | train_loss=0.016777 | val_loss=0.026920
2025-11-01 14:57:18,438 - models.nhits - INFO - Epoch  64 | train_loss=0.015690 | val_loss=0.031505
2025-11-01 14:57:26,542 - models.nhits - INFO - Epoch  65 | train_loss=0.016505 | val_loss=0.022421
2025-11-01 14:57:34,612 - models.nhits - INFO - Epoch  66 | train_loss=0.016246 | val_loss=0.024995
2025-11-01 14:57:42,694 - models.nhits - INFO - Epoch  67 | train_loss=0.022034 | val_loss=0.026398
2025-11-01 14:57:50,747 - models.nhits - INFO - Epoch  68 | train_loss=0.016211 | val_loss=0.027371
2025-11-01 14:57:58,830 - models.nhits - INFO - Epoch  69 | train_loss=0.015384 | val_loss=0.022598
2025-11-01 14:58:06,846 - models.nhits - INFO - Epoch  70 | train_loss=0.015519 | val_loss=0.027075
2025-11-01 14:58:14,830 - models.nhits - INFO - Epoch  71 | train_loss=0.015233 | val_loss=0.026069
2025-11-01 14:58:22,790 - models.nhits - INFO - Epoch  72 | train_loss=0.017521 | val_loss=0.025618
2025-11-01 14:58:30,766 - models.nhits - INFO - Epoch  73 | train_loss=0.015405 | val_loss=0.022893
2025-11-01 14:58:38,750 - models.nhits - INFO - Epoch  74 | train_loss=0.015738 | val_loss=0.026172
2025-11-01 14:58:46,720 - models.nhits - INFO - Epoch  75 | train_loss=0.017040 | val_loss=0.021732
2025-11-01 14:58:54,768 - models.nhits - INFO - Epoch  76 | train_loss=0.015505 | val_loss=0.023846
2025-11-01 14:59:02,825 - models.nhits - INFO - Epoch  77 | train_loss=0.015891 | val_loss=0.026522
2025-11-01 14:59:10,918 - models.nhits - INFO - Epoch  78 | train_loss=0.014863 | val_loss=0.024958
2025-11-01 14:59:19,010 - models.nhits - INFO - Epoch  79 | train_loss=0.018179 | val_loss=0.025947
2025-11-01 14:59:27,124 - models.nhits - INFO - Epoch  80 | train_loss=0.014414 | val_loss=0.022582
2025-11-01 14:59:35,256 - models.nhits - INFO - Epoch  81 | train_loss=0.014329 | val_loss=0.024784
2025-11-01 14:59:43,350 - models.nhits - INFO - Epoch  82 | train_loss=0.017985 | val_loss=0.021967
2025-11-01 14:59:51,429 - models.nhits - INFO - Epoch  83 | train_loss=0.017152 | val_loss=0.023511
2025-11-01 14:59:59,518 - models.nhits - INFO - Epoch  84 | train_loss=0.013976 | val_loss=0.021838
2025-11-01 15:00:07,608 - models.nhits - INFO - Epoch  85 | train_loss=0.014315 | val_loss=0.023733
2025-11-01 15:00:15,692 - models.nhits - INFO - Epoch  86 | train_loss=0.014134 | val_loss=0.021690
2025-11-01 15:00:23,797 - models.nhits - INFO - Epoch  87 | train_loss=0.015048 | val_loss=0.025471
2025-11-01 15:00:31,791 - models.nhits - INFO - Epoch  88 | train_loss=0.015553 | val_loss=0.024243
2025-11-01 15:00:39,757 - models.nhits - INFO - Epoch  89 | train_loss=0.015416 | val_loss=0.024261
2025-11-01 15:00:47,719 - models.nhits - INFO - Epoch  90 | train_loss=0.016716 | val_loss=0.022475
2025-11-01 15:00:55,688 - models.nhits - INFO - Epoch  91 | train_loss=0.017070 | val_loss=0.022072
2025-11-01 15:01:03,718 - models.nhits - INFO - Epoch  92 | train_loss=0.016582 | val_loss=0.024254
2025-11-01 15:01:11,694 - models.nhits - INFO - Epoch  93 | train_loss=0.014739 | val_loss=0.022297
2025-11-01 15:01:19,677 - models.nhits - INFO - Epoch  94 | train_loss=0.013848 | val_loss=0.022699
2025-11-01 15:01:27,661 - models.nhits - INFO - Epoch  95 | train_loss=0.020973 | val_loss=0.025761
2025-11-01 15:01:35,612 - models.nhits - INFO - Epoch  96 | train_loss=0.014598 | val_loss=0.021352
2025-11-01 15:01:43,612 - models.nhits - INFO - Epoch  97 | train_loss=0.013100 | val_loss=0.024572
2025-11-01 15:01:51,578 - models.nhits - INFO - Epoch  98 | train_loss=0.013232 | val_loss=0.029121
2025-11-01 15:01:59,528 - models.nhits - INFO - Epoch  99 | train_loss=0.018226 | val_loss=0.053930
2025-11-01 15:02:07,538 - models.nhits - INFO - Epoch 100 | train_loss=0.014918 | val_loss=0.022398
2025-11-01 15:02:07,557 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_144637/patchtst_model.pth
2025-11-01 15:02:07,584 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_144637/nhits_model.pth
2025-11-01 15:02:07,585 - main - INFO - 专家模型训练完成
2025-11-01 15:02:07,588 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 15:02:07,588 - main - INFO - 获取专家模型预测...
2025-11-01 15:02:20,120 - main - INFO - 专家预测获取完成
2025-11-01 15:02:20,121 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 15:02:20,770 - __main__ - ERROR - 实验失败: 'StaticWeightOptimizer' object has no attribute 'optimize_weights'
2025-11-01 17:27:46,667 - __main__ - INFO - 初始化实验...
2025-11-01 17:27:46,677 - main - INFO - 使用设备: cuda
2025-11-01 17:27:46,679 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 17:27:46,679 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 17:27:46,679 - main - INFO - 开始数据加载和预处理...
2025-11-01 17:27:46,687 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 17:27:48,879 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 17:27:48,883 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 17:27:48,885 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 17:27:48,888 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 17:27:48,896 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 17:27:48,896 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 17:27:48,976 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 17:27:49,043 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 17:27:49,043 - main - INFO - 数据预处理完成:
2025-11-01 17:27:49,043 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 17:27:49,043 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 17:27:49,044 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 17:27:49,044 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 17:27:49,044 - main - INFO - 开始训练专家模型...
2025-11-01 17:27:49,044 - main - INFO - 创建PatchTST模型...
2025-11-01 17:27:49,093 - main - INFO - 创建NHITS模型...
2025-11-01 17:27:49,158 - main - INFO - 训练PatchTST...
2025-11-01 17:27:59,953 - models.patchtst - INFO - Epoch   1 | train_loss=0.927991 | val_loss=1.327851
2025-11-01 17:28:07,027 - models.patchtst - INFO - Epoch   2 | train_loss=0.924145 | val_loss=1.327801
2025-11-01 17:28:14,137 - models.patchtst - INFO - Epoch   3 | train_loss=0.924014 | val_loss=1.327835
2025-11-01 17:28:21,194 - models.patchtst - INFO - Epoch   4 | train_loss=0.923973 | val_loss=1.327958
2025-11-01 17:28:28,322 - models.patchtst - INFO - Epoch   5 | train_loss=0.923969 | val_loss=1.327751
2025-11-01 17:28:35,549 - models.patchtst - INFO - Epoch   6 | train_loss=0.923997 | val_loss=1.327883
2025-11-01 17:28:42,927 - models.patchtst - INFO - Epoch   7 | train_loss=0.924078 | val_loss=1.327748
2025-11-01 17:28:50,244 - models.patchtst - INFO - Epoch   8 | train_loss=0.923985 | val_loss=1.327974
2025-11-01 17:28:57,482 - models.patchtst - INFO - Epoch   9 | train_loss=0.924022 | val_loss=1.327784
2025-11-01 17:29:04,819 - models.patchtst - INFO - Epoch  10 | train_loss=0.923972 | val_loss=1.327938
2025-11-01 17:29:12,168 - models.patchtst - INFO - Epoch  11 | train_loss=0.923993 | val_loss=1.327935
2025-11-01 17:29:19,530 - models.patchtst - INFO - Epoch  12 | train_loss=0.924047 | val_loss=1.327818
2025-11-01 17:29:27,078 - models.patchtst - INFO - Epoch  13 | train_loss=0.923908 | val_loss=1.327786
2025-11-01 17:29:34,522 - models.patchtst - INFO - Epoch  14 | train_loss=0.923994 | val_loss=1.327731
2025-11-01 17:29:41,945 - models.patchtst - INFO - Epoch  15 | train_loss=0.923891 | val_loss=1.327840
2025-11-01 17:29:49,360 - models.patchtst - INFO - Epoch  16 | train_loss=0.923882 | val_loss=1.327883
2025-11-01 17:29:56,940 - models.patchtst - INFO - Epoch  17 | train_loss=0.923957 | val_loss=1.327817
2025-11-01 17:30:04,323 - models.patchtst - INFO - Epoch  18 | train_loss=0.923963 | val_loss=1.327750
2025-11-01 17:30:11,631 - models.patchtst - INFO - Epoch  19 | train_loss=0.923931 | val_loss=1.327832
2025-11-01 17:30:18,954 - models.patchtst - INFO - Epoch  20 | train_loss=0.923973 | val_loss=1.327789
2025-11-01 17:30:26,144 - models.patchtst - INFO - Epoch  21 | train_loss=0.923945 | val_loss=1.327777
2025-11-01 17:30:33,328 - models.patchtst - INFO - Epoch  22 | train_loss=0.923967 | val_loss=1.327705
2025-11-01 17:30:40,500 - models.patchtst - INFO - Epoch  23 | train_loss=0.923897 | val_loss=1.327781
2025-11-01 17:30:47,727 - models.patchtst - INFO - Epoch  24 | train_loss=0.924020 | val_loss=1.327839
2025-11-01 17:30:54,980 - models.patchtst - INFO - Epoch  25 | train_loss=0.923879 | val_loss=1.327893
2025-11-01 17:31:02,238 - models.patchtst - INFO - Epoch  26 | train_loss=0.923881 | val_loss=1.327769
2025-11-01 17:31:09,494 - models.patchtst - INFO - Epoch  27 | train_loss=0.923871 | val_loss=1.327688
2025-11-01 17:31:16,749 - models.patchtst - INFO - Epoch  28 | train_loss=0.923948 | val_loss=1.327750
2025-11-01 17:31:23,889 - models.patchtst - INFO - Epoch  29 | train_loss=0.923950 | val_loss=1.327771
2025-11-01 17:31:31,160 - models.patchtst - INFO - Epoch  30 | train_loss=0.923956 | val_loss=1.327797
2025-11-01 17:31:38,347 - models.patchtst - INFO - Epoch  31 | train_loss=0.923923 | val_loss=1.327787
2025-11-01 17:31:45,490 - models.patchtst - INFO - Epoch  32 | train_loss=0.923949 | val_loss=1.327737
2025-11-01 17:31:52,653 - models.patchtst - INFO - Epoch  33 | train_loss=0.923921 | val_loss=1.327778
2025-11-01 17:31:59,777 - models.patchtst - INFO - Epoch  34 | train_loss=0.923827 | val_loss=1.327788
2025-11-01 17:32:06,928 - models.patchtst - INFO - Epoch  35 | train_loss=0.923917 | val_loss=1.327777
2025-11-01 17:32:14,134 - models.patchtst - INFO - Epoch  36 | train_loss=0.923874 | val_loss=1.327779
2025-11-01 17:32:21,269 - models.patchtst - INFO - Epoch  37 | train_loss=0.923840 | val_loss=1.327801
2025-11-01 17:32:28,392 - models.patchtst - INFO - Epoch  38 | train_loss=0.923879 | val_loss=1.327801
2025-11-01 17:32:35,570 - models.patchtst - INFO - Epoch  39 | train_loss=0.923952 | val_loss=1.327782
2025-11-01 17:32:42,739 - models.patchtst - INFO - Epoch  40 | train_loss=0.923867 | val_loss=1.327801
2025-11-01 17:32:49,928 - models.patchtst - INFO - Epoch  41 | train_loss=0.923929 | val_loss=1.327754
2025-11-01 17:32:57,083 - models.patchtst - INFO - Epoch  42 | train_loss=0.923851 | val_loss=1.327772
2025-11-01 17:32:57,083 - models.patchtst - INFO - Early stopping at epoch 42早停触发（连续15轮验证损失未下降），最佳验证损失：1.327688
2025-11-01 17:32:57,083 - main - INFO - 训练NHITS...
2025-11-01 17:33:05,081 - models.nhits - INFO - Epoch   1 | train_loss=62350871.134563 | val_loss=265.913677
2025-11-01 17:33:13,121 - models.nhits - INFO - Epoch   2 | train_loss=236.390530 | val_loss=12.602405
2025-11-01 17:33:21,157 - models.nhits - INFO - Epoch   3 | train_loss=9.552664 | val_loss=1.335739
2025-11-01 17:33:29,192 - models.nhits - INFO - Epoch   4 | train_loss=1.702238 | val_loss=0.735546
2025-11-01 17:33:37,723 - models.nhits - INFO - Epoch   5 | train_loss=0.405423 | val_loss=0.446550
2025-11-01 17:33:45,927 - models.nhits - INFO - Epoch   6 | train_loss=1.204111 | val_loss=0.111881
2025-11-01 17:33:54,291 - models.nhits - INFO - Epoch   7 | train_loss=0.121262 | val_loss=0.073189
2025-11-01 17:34:02,521 - models.nhits - INFO - Epoch   8 | train_loss=0.086746 | val_loss=0.080501
2025-11-01 17:34:10,795 - models.nhits - INFO - Epoch   9 | train_loss=0.064276 | val_loss=0.064505
2025-11-01 17:34:19,051 - models.nhits - INFO - Epoch  10 | train_loss=0.064436 | val_loss=0.114140
2025-11-01 17:34:27,562 - models.nhits - INFO - Epoch  11 | train_loss=0.120896 | val_loss=0.103073
2025-11-01 17:34:35,914 - models.nhits - INFO - Epoch  12 | train_loss=0.052311 | val_loss=0.063635
2025-11-01 17:34:44,107 - models.nhits - INFO - Epoch  13 | train_loss=0.048439 | val_loss=0.088078
2025-11-01 17:34:52,112 - models.nhits - INFO - Epoch  14 | train_loss=0.045039 | val_loss=0.062346
2025-11-01 17:35:00,169 - models.nhits - INFO - Epoch  15 | train_loss=0.319428 | val_loss=0.048450
2025-11-01 17:35:08,160 - models.nhits - INFO - Epoch  16 | train_loss=0.184726 | val_loss=0.066632
2025-11-01 17:35:16,161 - models.nhits - INFO - Epoch  17 | train_loss=0.042513 | val_loss=0.062101
2025-11-01 17:35:24,151 - models.nhits - INFO - Epoch  18 | train_loss=0.041198 | val_loss=0.052071
2025-11-01 17:35:32,128 - models.nhits - INFO - Epoch  19 | train_loss=0.039697 | val_loss=0.046308
2025-11-01 17:35:40,124 - models.nhits - INFO - Epoch  20 | train_loss=0.039638 | val_loss=0.047277
2025-11-01 17:35:48,101 - models.nhits - INFO - Epoch  21 | train_loss=0.966358 | val_loss=0.046030
2025-11-01 17:35:56,079 - models.nhits - INFO - Epoch  22 | train_loss=0.038559 | val_loss=0.066693
2025-11-01 17:36:04,044 - models.nhits - INFO - Epoch  23 | train_loss=0.037233 | val_loss=0.057726
2025-11-01 17:36:12,025 - models.nhits - INFO - Epoch  24 | train_loss=0.057562 | val_loss=0.040491
2025-11-01 17:36:19,984 - models.nhits - INFO - Epoch  25 | train_loss=39.120182 | val_loss=0.052015
2025-11-01 17:36:28,005 - models.nhits - INFO - Epoch  26 | train_loss=0.327999 | val_loss=0.055557
2025-11-01 17:36:35,976 - models.nhits - INFO - Epoch  27 | train_loss=0.036211 | val_loss=0.037638
2025-11-01 17:36:43,988 - models.nhits - INFO - Epoch  28 | train_loss=0.034722 | val_loss=0.047283
2025-11-01 17:36:51,964 - models.nhits - INFO - Epoch  29 | train_loss=0.035780 | val_loss=0.053603
2025-11-01 17:36:59,969 - models.nhits - INFO - Epoch  30 | train_loss=0.184102 | val_loss=0.059676
2025-11-01 17:37:07,935 - models.nhits - INFO - Epoch  31 | train_loss=0.035192 | val_loss=0.041407
2025-11-01 17:37:15,905 - models.nhits - INFO - Epoch  32 | train_loss=0.030695 | val_loss=0.043028
2025-11-01 17:37:23,884 - models.nhits - INFO - Epoch  33 | train_loss=0.047899 | val_loss=0.039105
2025-11-01 17:37:31,896 - models.nhits - INFO - Epoch  34 | train_loss=0.035269 | val_loss=0.042592
2025-11-01 17:37:39,875 - models.nhits - INFO - Epoch  35 | train_loss=0.032040 | val_loss=0.047198
2025-11-01 17:37:47,838 - models.nhits - INFO - Epoch  36 | train_loss=0.255267 | val_loss=0.042095
2025-11-01 17:37:55,811 - models.nhits - INFO - Epoch  37 | train_loss=0.213101 | val_loss=0.052730
2025-11-01 17:38:03,797 - models.nhits - INFO - Epoch  38 | train_loss=0.033974 | val_loss=0.045167
2025-11-01 17:38:11,867 - models.nhits - INFO - Epoch  39 | train_loss=0.026897 | val_loss=0.037993
2025-11-01 17:38:19,931 - models.nhits - INFO - Epoch  40 | train_loss=0.025634 | val_loss=0.036179
2025-11-01 17:38:27,921 - models.nhits - INFO - Epoch  41 | train_loss=0.026468 | val_loss=0.037404
2025-11-01 17:38:36,030 - models.nhits - INFO - Epoch  42 | train_loss=0.024907 | val_loss=0.039887
2025-11-01 17:38:44,308 - models.nhits - INFO - Epoch  43 | train_loss=0.025646 | val_loss=0.036997
2025-11-01 17:38:52,544 - models.nhits - INFO - Epoch  44 | train_loss=0.026531 | val_loss=0.041867
2025-11-01 17:39:00,701 - models.nhits - INFO - Epoch  45 | train_loss=0.025090 | val_loss=0.035433
2025-11-01 17:39:08,876 - models.nhits - INFO - Epoch  46 | train_loss=0.024909 | val_loss=0.037283
2025-11-01 17:39:16,973 - models.nhits - INFO - Epoch  47 | train_loss=0.025071 | val_loss=0.038170
2025-11-01 17:39:25,117 - models.nhits - INFO - Epoch  48 | train_loss=0.025671 | val_loss=0.036936
2025-11-01 17:39:33,309 - models.nhits - INFO - Epoch  49 | train_loss=0.026622 | val_loss=0.045715
2025-11-01 17:39:41,443 - models.nhits - INFO - Epoch  50 | train_loss=0.024200 | val_loss=0.035096
2025-11-01 17:39:49,579 - models.nhits - INFO - Epoch  51 | train_loss=0.024267 | val_loss=0.034009
2025-11-01 17:39:57,931 - models.nhits - INFO - Epoch  52 | train_loss=0.024007 | val_loss=0.036837
2025-11-01 17:40:06,053 - models.nhits - INFO - Epoch  53 | train_loss=0.023737 | val_loss=0.035127
2025-11-01 17:40:14,318 - models.nhits - INFO - Epoch  54 | train_loss=0.023340 | val_loss=0.034765
2025-11-01 17:40:22,474 - models.nhits - INFO - Epoch  55 | train_loss=0.022701 | val_loss=0.032713
2025-11-01 17:40:30,599 - models.nhits - INFO - Epoch  56 | train_loss=0.023456 | val_loss=0.035845
2025-11-01 17:40:38,813 - models.nhits - INFO - Epoch  57 | train_loss=0.024267 | val_loss=0.032281
2025-11-01 17:40:47,052 - models.nhits - INFO - Epoch  58 | train_loss=0.022109 | val_loss=0.034132
2025-11-01 17:40:55,246 - models.nhits - INFO - Epoch  59 | train_loss=0.023779 | val_loss=0.038886
2025-11-01 17:41:03,468 - models.nhits - INFO - Epoch  60 | train_loss=0.022323 | val_loss=0.031660
2025-11-01 17:41:11,731 - models.nhits - INFO - Epoch  61 | train_loss=0.022082 | val_loss=0.033497
2025-11-01 17:41:19,980 - models.nhits - INFO - Epoch  62 | train_loss=0.022034 | val_loss=0.039062
2025-11-01 17:41:28,198 - models.nhits - INFO - Epoch  63 | train_loss=0.022134 | val_loss=0.031074
2025-11-01 17:41:36,473 - models.nhits - INFO - Epoch  64 | train_loss=0.021499 | val_loss=0.033032
2025-11-01 17:41:44,720 - models.nhits - INFO - Epoch  65 | train_loss=0.023328 | val_loss=0.035781
2025-11-01 17:41:53,005 - models.nhits - INFO - Epoch  66 | train_loss=0.021833 | val_loss=0.038565
2025-11-01 17:42:01,260 - models.nhits - INFO - Epoch  67 | train_loss=0.021862 | val_loss=0.030496
2025-11-01 17:42:09,578 - models.nhits - INFO - Epoch  68 | train_loss=0.021732 | val_loss=0.030645
2025-11-01 17:42:17,870 - models.nhits - INFO - Epoch  69 | train_loss=0.020693 | val_loss=0.038408
2025-11-01 17:42:26,204 - models.nhits - INFO - Epoch  70 | train_loss=0.021236 | val_loss=0.031961
2025-11-01 17:42:34,485 - models.nhits - INFO - Epoch  71 | train_loss=0.021044 | val_loss=0.030631
2025-11-01 17:42:42,814 - models.nhits - INFO - Epoch  72 | train_loss=0.020109 | val_loss=0.029156
2025-11-01 17:42:51,142 - models.nhits - INFO - Epoch  73 | train_loss=0.023545 | val_loss=0.031084
2025-11-01 17:42:59,499 - models.nhits - INFO - Epoch  74 | train_loss=0.019971 | val_loss=0.035032
2025-11-01 17:43:07,773 - models.nhits - INFO - Epoch  75 | train_loss=0.020784 | val_loss=0.031214
2025-11-01 17:43:16,049 - models.nhits - INFO - Epoch  76 | train_loss=0.019743 | val_loss=0.030368
2025-11-01 17:43:24,348 - models.nhits - INFO - Epoch  77 | train_loss=0.020528 | val_loss=0.031723
2025-11-01 17:43:32,622 - models.nhits - INFO - Epoch  78 | train_loss=0.018840 | val_loss=0.029822
2025-11-01 17:43:40,871 - models.nhits - INFO - Epoch  79 | train_loss=0.019952 | val_loss=0.032279
2025-11-01 17:43:49,084 - models.nhits - INFO - Epoch  80 | train_loss=0.018721 | val_loss=0.031119
2025-11-01 17:43:57,352 - models.nhits - INFO - Epoch  81 | train_loss=0.019726 | val_loss=0.029933
2025-11-01 17:44:05,661 - models.nhits - INFO - Epoch  82 | train_loss=0.018726 | val_loss=0.031864
2025-11-01 17:44:13,889 - models.nhits - INFO - Epoch  83 | train_loss=0.018799 | val_loss=0.029681
2025-11-01 17:44:22,137 - models.nhits - INFO - Epoch  84 | train_loss=0.015368 | val_loss=0.026052
2025-11-01 17:44:30,445 - models.nhits - INFO - Epoch  85 | train_loss=0.014716 | val_loss=0.028429
2025-11-01 17:44:38,687 - models.nhits - INFO - Epoch  86 | train_loss=0.014475 | val_loss=0.028644
2025-11-01 17:44:46,932 - models.nhits - INFO - Epoch  87 | train_loss=0.014399 | val_loss=0.029744
2025-11-01 17:44:55,211 - models.nhits - INFO - Epoch  88 | train_loss=0.014383 | val_loss=0.025228
2025-11-01 17:45:03,478 - models.nhits - INFO - Epoch  89 | train_loss=0.013750 | val_loss=0.026485
2025-11-01 17:45:11,802 - models.nhits - INFO - Epoch  90 | train_loss=0.013708 | val_loss=0.026678
2025-11-01 17:45:19,991 - models.nhits - INFO - Epoch  91 | train_loss=0.014270 | val_loss=0.024391
2025-11-01 17:45:28,283 - models.nhits - INFO - Epoch  92 | train_loss=0.013853 | val_loss=0.023957
2025-11-01 17:45:36,527 - models.nhits - INFO - Epoch  93 | train_loss=0.013287 | val_loss=0.025398
2025-11-01 17:45:45,014 - models.nhits - INFO - Epoch  94 | train_loss=0.013571 | val_loss=0.025138
2025-11-01 17:45:53,300 - models.nhits - INFO - Epoch  95 | train_loss=0.013307 | val_loss=0.026111
2025-11-01 17:46:01,558 - models.nhits - INFO - Epoch  96 | train_loss=0.013494 | val_loss=0.024132
2025-11-01 17:46:09,775 - models.nhits - INFO - Epoch  97 | train_loss=0.013197 | val_loss=0.025109
2025-11-01 17:46:18,032 - models.nhits - INFO - Epoch  98 | train_loss=0.013350 | val_loss=0.025513
2025-11-01 17:46:26,255 - models.nhits - INFO - Epoch  99 | train_loss=0.012893 | val_loss=0.027181
2025-11-01 17:46:34,591 - models.nhits - INFO - Epoch 100 | train_loss=0.013160 | val_loss=0.026123
2025-11-01 17:46:34,618 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_172746/patchtst_model.pth
2025-11-01 17:46:34,647 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_172746/nhits_model.pth
2025-11-01 17:46:34,647 - main - INFO - 专家模型训练完成
2025-11-01 17:46:34,651 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 17:46:34,651 - main - INFO - 获取专家模型预测...
2025-11-01 17:46:47,745 - main - INFO - 专家预测获取完成
2025-11-01 17:46:47,746 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 17:46:48,419 - __main__ - ERROR - 实验失败: 'MPAOptimizer' object has no attribute 'mpa'
2025-11-01 19:31:28,707 - __main__ - INFO - 初始化实验...
2025-11-01 19:31:28,716 - main - INFO - 使用设备: cuda
2025-11-01 19:31:28,717 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 19:31:28,717 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 19:31:28,717 - main - INFO - 开始数据加载和预处理...
2025-11-01 19:31:28,725 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 19:31:30,857 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 19:31:30,859 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 19:31:30,862 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 19:31:30,864 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 19:31:30,871 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 19:31:30,872 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 19:31:30,953 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 19:31:30,953 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 19:31:30,954 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 19:31:30,954 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 19:31:30,954 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 19:31:31,033 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 19:31:31,033 - main - INFO - 数据预处理完成:
2025-11-01 19:31:31,033 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 19:31:31,033 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 19:31:31,033 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 19:31:31,033 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 19:31:31,033 - main - INFO - 开始训练专家模型...
2025-11-01 19:31:31,033 - main - INFO - 创建PatchTST模型...
2025-11-01 19:31:31,047 - main - INFO - 创建NHITS模型...
2025-11-01 19:31:31,111 - main - INFO - 训练PatchTST...
2025-11-01 19:31:40,899 - models.patchtst - INFO - Epoch   1 | train_loss=0.928468 | val_loss=1.327757
2025-11-01 19:31:47,925 - models.patchtst - INFO - Epoch   2 | train_loss=0.923990 | val_loss=1.327662
2025-11-01 19:31:54,897 - models.patchtst - INFO - Epoch   3 | train_loss=0.923920 | val_loss=1.327618
2025-11-01 19:32:02,068 - models.patchtst - INFO - Epoch   4 | train_loss=0.923925 | val_loss=1.327668
2025-11-01 19:32:09,150 - models.patchtst - INFO - Epoch   5 | train_loss=0.923976 | val_loss=1.327669
2025-11-01 19:32:16,137 - models.patchtst - INFO - Epoch   6 | train_loss=0.923987 | val_loss=1.327712
2025-11-01 19:32:23,173 - models.patchtst - INFO - Epoch   7 | train_loss=0.923939 | val_loss=1.328249
2025-11-01 19:32:30,172 - models.patchtst - INFO - Epoch   8 | train_loss=0.923988 | val_loss=1.327798
2025-11-01 19:32:37,223 - models.patchtst - INFO - Epoch   9 | train_loss=0.923989 | val_loss=1.327754
2025-11-01 19:32:44,345 - models.patchtst - INFO - Epoch  10 | train_loss=0.924006 | val_loss=1.327716
2025-11-01 19:32:51,383 - models.patchtst - INFO - Epoch  11 | train_loss=0.923952 | val_loss=1.327743
2025-11-01 19:32:58,513 - models.patchtst - INFO - Epoch  12 | train_loss=0.924117 | val_loss=1.327651
2025-11-01 19:33:05,770 - models.patchtst - INFO - Epoch  13 | train_loss=0.923905 | val_loss=1.327901
2025-11-01 19:33:12,879 - models.patchtst - INFO - Epoch  14 | train_loss=0.923921 | val_loss=1.328073
2025-11-01 19:33:19,971 - models.patchtst - INFO - Epoch  15 | train_loss=0.923910 | val_loss=1.327878
2025-11-01 19:33:27,021 - models.patchtst - INFO - Epoch  16 | train_loss=0.924001 | val_loss=1.327864
2025-11-01 19:33:34,127 - models.patchtst - INFO - Epoch  17 | train_loss=0.923910 | val_loss=1.327817
2025-11-01 19:33:41,166 - models.patchtst - INFO - Epoch  18 | train_loss=0.923894 | val_loss=1.327791
2025-11-01 19:33:41,167 - models.patchtst - INFO - Early stopping at epoch 18早停触发（连续15轮验证损失未下降），最佳验证损失：1.327618
2025-11-01 19:33:41,167 - main - INFO - 训练NHITS...
2025-11-01 19:33:49,063 - models.nhits - INFO - Epoch   1 | train_loss=615717804.075352 | val_loss=416.028802
2025-11-01 19:33:56,912 - models.nhits - INFO - Epoch   2 | train_loss=227.067418 | val_loss=10.051271
2025-11-01 19:34:04,777 - models.nhits - INFO - Epoch   3 | train_loss=4.250484 | val_loss=0.797358
2025-11-01 19:34:12,632 - models.nhits - INFO - Epoch   4 | train_loss=0.441132 | val_loss=0.187039
2025-11-01 19:34:20,503 - models.nhits - INFO - Epoch   5 | train_loss=0.176381 | val_loss=0.129356
2025-11-01 19:34:28,441 - models.nhits - INFO - Epoch   6 | train_loss=0.116229 | val_loss=0.117710
2025-11-01 19:34:36,327 - models.nhits - INFO - Epoch   7 | train_loss=0.117696 | val_loss=0.146535
2025-11-01 19:34:44,174 - models.nhits - INFO - Epoch   8 | train_loss=0.407756 | val_loss=0.134929
2025-11-01 19:34:52,139 - models.nhits - INFO - Epoch   9 | train_loss=0.099532 | val_loss=0.094489
2025-11-01 19:35:00,144 - models.nhits - INFO - Epoch  10 | train_loss=0.080137 | val_loss=0.109530
2025-11-01 19:35:08,062 - models.nhits - INFO - Epoch  11 | train_loss=0.076511 | val_loss=0.080222
2025-11-01 19:35:15,889 - models.nhits - INFO - Epoch  12 | train_loss=0.073584 | val_loss=0.077721
2025-11-01 19:35:23,694 - models.nhits - INFO - Epoch  13 | train_loss=0.084840 | val_loss=0.125241
2025-11-01 19:35:31,527 - models.nhits - INFO - Epoch  14 | train_loss=0.096703 | val_loss=0.082649
2025-11-01 19:35:39,384 - models.nhits - INFO - Epoch  15 | train_loss=0.067126 | val_loss=0.104015
2025-11-01 19:35:47,209 - models.nhits - INFO - Epoch  16 | train_loss=0.068910 | val_loss=0.091106
2025-11-01 19:35:55,035 - models.nhits - INFO - Epoch  17 | train_loss=0.067786 | val_loss=0.080930
2025-11-01 19:36:03,281 - models.nhits - INFO - Epoch  18 | train_loss=0.157604 | val_loss=0.079321
2025-11-01 19:36:11,409 - models.nhits - INFO - Epoch  19 | train_loss=0.067736 | val_loss=0.096928
2025-11-01 19:36:19,513 - models.nhits - INFO - Epoch  20 | train_loss=0.063264 | val_loss=0.107417
2025-11-01 19:36:27,719 - models.nhits - INFO - Epoch  21 | train_loss=0.065144 | val_loss=0.081183
2025-11-01 19:36:35,830 - models.nhits - INFO - Epoch  22 | train_loss=0.063548 | val_loss=0.081950
2025-11-01 19:36:44,095 - models.nhits - INFO - Epoch  23 | train_loss=0.063988 | val_loss=0.081863
2025-11-01 19:36:52,430 - models.nhits - INFO - Epoch  24 | train_loss=0.052736 | val_loss=0.073401
2025-11-01 19:37:00,501 - models.nhits - INFO - Epoch  25 | train_loss=0.051159 | val_loss=0.077045
2025-11-01 19:37:08,576 - models.nhits - INFO - Epoch  26 | train_loss=0.051784 | val_loss=0.079478
2025-11-01 19:37:16,561 - models.nhits - INFO - Epoch  27 | train_loss=0.051926 | val_loss=0.077124
2025-11-01 19:37:24,504 - models.nhits - INFO - Epoch  28 | train_loss=0.051708 | val_loss=0.067019
2025-11-01 19:37:32,464 - models.nhits - INFO - Epoch  29 | train_loss=0.051375 | val_loss=0.068492
2025-11-01 19:37:40,413 - models.nhits - INFO - Epoch  30 | train_loss=0.052158 | val_loss=0.066924
2025-11-01 19:37:48,253 - models.nhits - INFO - Epoch  31 | train_loss=0.050915 | val_loss=0.067299
2025-11-01 19:37:56,082 - models.nhits - INFO - Epoch  32 | train_loss=0.050993 | val_loss=0.075758
2025-11-01 19:38:03,978 - models.nhits - INFO - Epoch  33 | train_loss=0.049575 | val_loss=0.077756
2025-11-01 19:38:11,902 - models.nhits - INFO - Epoch  34 | train_loss=0.049543 | val_loss=0.071588
2025-11-01 19:38:19,823 - models.nhits - INFO - Epoch  35 | train_loss=0.049286 | val_loss=0.083144
2025-11-01 19:38:27,727 - models.nhits - INFO - Epoch  36 | train_loss=0.049691 | val_loss=0.070610
2025-11-01 19:38:35,657 - models.nhits - INFO - Epoch  37 | train_loss=0.049183 | val_loss=0.076492
2025-11-01 19:38:43,585 - models.nhits - INFO - Epoch  38 | train_loss=0.048914 | val_loss=0.081710
2025-11-01 19:38:51,523 - models.nhits - INFO - Epoch  39 | train_loss=0.049454 | val_loss=0.068555
2025-11-01 19:38:59,439 - models.nhits - INFO - Epoch  40 | train_loss=0.058269 | val_loss=0.087160
2025-11-01 19:39:07,351 - models.nhits - INFO - Epoch  41 | train_loss=0.048432 | val_loss=0.071230
2025-11-01 19:39:15,281 - models.nhits - INFO - Epoch  42 | train_loss=0.044310 | val_loss=0.065934
2025-11-01 19:39:23,197 - models.nhits - INFO - Epoch  43 | train_loss=0.043862 | val_loss=0.069631
2025-11-01 19:39:31,115 - models.nhits - INFO - Epoch  44 | train_loss=0.043683 | val_loss=0.067214
2025-11-01 19:39:39,040 - models.nhits - INFO - Epoch  45 | train_loss=0.043513 | val_loss=0.067666
2025-11-01 19:39:46,942 - models.nhits - INFO - Epoch  46 | train_loss=0.043223 | val_loss=0.070631
2025-11-01 19:39:54,922 - models.nhits - INFO - Epoch  47 | train_loss=0.042781 | val_loss=0.064987
2025-11-01 19:40:02,892 - models.nhits - INFO - Epoch  48 | train_loss=0.043267 | val_loss=0.070293
2025-11-01 19:40:10,863 - models.nhits - INFO - Epoch  49 | train_loss=0.043402 | val_loss=0.066297
2025-11-01 19:40:18,804 - models.nhits - INFO - Epoch  50 | train_loss=0.042745 | val_loss=0.065483
2025-11-01 19:40:26,790 - models.nhits - INFO - Epoch  51 | train_loss=0.042832 | val_loss=0.070876
2025-11-01 19:40:34,817 - models.nhits - INFO - Epoch  52 | train_loss=0.042857 | val_loss=0.065106
2025-11-01 19:40:42,851 - models.nhits - INFO - Epoch  53 | train_loss=0.042884 | val_loss=0.067723
2025-11-01 19:40:51,337 - models.nhits - INFO - Epoch  54 | train_loss=0.042883 | val_loss=0.069819
2025-11-01 19:40:59,500 - models.nhits - INFO - Epoch  55 | train_loss=0.042879 | val_loss=0.064511
2025-11-01 19:41:07,692 - models.nhits - INFO - Epoch  56 | train_loss=0.042800 | val_loss=0.067439
2025-11-01 19:41:15,860 - models.nhits - INFO - Epoch  57 | train_loss=0.042334 | val_loss=0.068454
2025-11-01 19:41:24,005 - models.nhits - INFO - Epoch  58 | train_loss=0.042576 | val_loss=0.071616
2025-11-01 19:41:32,207 - models.nhits - INFO - Epoch  59 | train_loss=0.042190 | val_loss=0.062359
2025-11-01 19:41:40,375 - models.nhits - INFO - Epoch  60 | train_loss=0.041838 | val_loss=0.072926
2025-11-01 19:41:48,482 - models.nhits - INFO - Epoch  61 | train_loss=0.042090 | val_loss=0.069027
2025-11-01 19:41:56,730 - models.nhits - INFO - Epoch  62 | train_loss=0.042251 | val_loss=0.065522
2025-11-01 19:42:05,024 - models.nhits - INFO - Epoch  63 | train_loss=0.042167 | val_loss=0.072132
2025-11-01 19:42:13,729 - models.nhits - INFO - Epoch  64 | train_loss=0.042072 | val_loss=0.065974
2025-11-01 19:42:22,024 - models.nhits - INFO - Epoch  65 | train_loss=0.042507 | val_loss=0.067474
2025-11-01 19:42:30,558 - models.nhits - INFO - Epoch  66 | train_loss=0.041695 | val_loss=0.069487
2025-11-01 19:42:38,813 - models.nhits - INFO - Epoch  67 | train_loss=0.041792 | val_loss=0.064484
2025-11-01 19:42:46,879 - models.nhits - INFO - Epoch  68 | train_loss=0.042064 | val_loss=0.065596
2025-11-01 19:42:55,024 - models.nhits - INFO - Epoch  69 | train_loss=0.041682 | val_loss=0.065747
2025-11-01 19:43:03,263 - models.nhits - INFO - Epoch  70 | train_loss=0.041478 | val_loss=0.067376
2025-11-01 19:43:11,996 - models.nhits - INFO - Epoch  71 | train_loss=0.039513 | val_loss=0.065208
2025-11-01 19:43:20,237 - models.nhits - INFO - Epoch  72 | train_loss=0.039482 | val_loss=0.063362
2025-11-01 19:43:28,501 - models.nhits - INFO - Epoch  73 | train_loss=0.039156 | val_loss=0.066147
2025-11-01 19:43:36,817 - models.nhits - INFO - Epoch  74 | train_loss=0.039338 | val_loss=0.064375
2025-11-01 19:43:36,817 - models.nhits - INFO - Early stopping at epoch 74早停触发（连续15轮验证损失未下降），最佳验证损失：0.062359
2025-11-01 19:43:36,834 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_193128/patchtst_model.pth
2025-11-01 19:43:36,863 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_193128/nhits_model.pth
2025-11-01 19:43:36,863 - main - INFO - 专家模型训练完成
2025-11-01 19:43:36,866 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 19:43:36,866 - main - INFO - 获取专家模型预测...
2025-11-01 19:43:50,396 - main - INFO - 专家预测获取完成
2025-11-01 19:43:50,397 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 19:43:51,609 - __main__ - ERROR - 实验失败: type object 'MPAOptimizer' has no attribute 'StaticWeightOptimizer'
2025-11-02 14:33:53,380 - __main__ - INFO - 初始化实验...
2025-11-02 14:33:53,398 - main - INFO - 使用设备: cuda
2025-11-02 14:33:53,400 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-02 14:33:53,400 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-02 14:33:53,400 - main - INFO - 开始数据加载和预处理...
2025-11-02 14:33:53,410 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 14:33:55,776 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 14:33:55,780 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 14:33:55,783 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 14:33:55,786 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 14:33:55,795 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 14:33:55,795 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 14:33:55,876 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 14:33:55,877 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 14:33:55,877 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 14:33:55,877 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 14:33:55,877 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 14:33:55,956 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 14:33:55,957 - main - INFO - 数据预处理完成:
2025-11-02 14:33:55,957 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 14:33:55,957 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 14:33:55,957 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 14:33:55,957 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-02 14:33:55,957 - main - INFO - 开始训练专家模型...
2025-11-02 14:33:55,958 - main - INFO - 创建PatchTST模型...
2025-11-02 14:33:56,007 - main - INFO - 创建NHITS模型...
2025-11-02 14:33:56,089 - main - INFO - 训练PatchTST...
2025-11-02 14:34:07,474 - models.patchtst - INFO - Epoch   1 | train_loss=0.929559 | val_loss=1.327695
2025-11-02 14:34:14,769 - models.patchtst - INFO - Epoch   2 | train_loss=0.923947 | val_loss=1.327721
2025-11-02 14:34:22,144 - models.patchtst - INFO - Epoch   3 | train_loss=0.923985 | val_loss=1.327744
2025-11-02 14:34:29,512 - models.patchtst - INFO - Epoch   4 | train_loss=0.924037 | val_loss=1.328073
2025-11-02 14:34:36,462 - models.patchtst - INFO - Epoch   5 | train_loss=0.924091 | val_loss=1.328012
2025-11-02 14:34:43,375 - models.patchtst - INFO - Epoch   6 | train_loss=0.923997 | val_loss=1.327819
2025-11-02 14:34:50,300 - models.patchtst - INFO - Epoch   7 | train_loss=0.923981 | val_loss=1.327832
2025-11-02 14:34:57,326 - models.patchtst - INFO - Epoch   8 | train_loss=0.924013 | val_loss=1.327829
2025-11-02 14:35:04,345 - models.patchtst - INFO - Epoch   9 | train_loss=0.923988 | val_loss=1.327705
2025-11-02 14:35:11,368 - models.patchtst - INFO - Epoch  10 | train_loss=0.924027 | val_loss=1.327843
2025-11-02 14:35:18,462 - models.patchtst - INFO - Epoch  11 | train_loss=0.924017 | val_loss=1.327687
2025-11-02 14:35:25,618 - models.patchtst - INFO - Epoch  12 | train_loss=0.923956 | val_loss=1.327962
2025-11-02 14:35:32,738 - models.patchtst - INFO - Epoch  13 | train_loss=0.923884 | val_loss=1.327821
2025-11-02 14:35:39,896 - models.patchtst - INFO - Epoch  14 | train_loss=0.923967 | val_loss=1.327739
2025-11-02 14:35:47,036 - models.patchtst - INFO - Epoch  15 | train_loss=0.923934 | val_loss=1.327790
2025-11-02 14:35:54,160 - models.patchtst - INFO - Epoch  16 | train_loss=0.923864 | val_loss=1.327809
2025-11-02 14:36:01,346 - models.patchtst - INFO - Epoch  17 | train_loss=0.923946 | val_loss=1.327774
2025-11-02 14:36:08,523 - models.patchtst - INFO - Epoch  18 | train_loss=0.923900 | val_loss=1.327772
2025-11-02 14:36:15,686 - models.patchtst - INFO - Epoch  19 | train_loss=0.923931 | val_loss=1.327839
2025-11-02 14:36:23,078 - models.patchtst - INFO - Epoch  20 | train_loss=0.923889 | val_loss=1.327804
2025-11-02 14:36:30,333 - models.patchtst - INFO - Epoch  21 | train_loss=0.923932 | val_loss=1.327808
2025-11-02 14:36:37,573 - models.patchtst - INFO - Epoch  22 | train_loss=0.923954 | val_loss=1.327826
2025-11-02 14:36:44,846 - models.patchtst - INFO - Epoch  23 | train_loss=0.923923 | val_loss=1.327854
2025-11-02 14:36:52,064 - models.patchtst - INFO - Epoch  24 | train_loss=0.923889 | val_loss=1.327827
2025-11-02 14:36:59,310 - models.patchtst - INFO - Epoch  25 | train_loss=0.923891 | val_loss=1.327778
2025-11-02 14:37:06,646 - models.patchtst - INFO - Epoch  26 | train_loss=0.923892 | val_loss=1.327780
2025-11-02 14:37:06,646 - models.patchtst - INFO - Early stopping at epoch 26早停触发（连续15轮验证损失未下降），最佳验证损失：1.327687
2025-11-02 14:37:06,646 - main - INFO - 训练NHITS...
2025-11-02 14:37:14,710 - models.nhits - INFO - Epoch   1 | train_loss=1180802393.888166 | val_loss=6215.221310
2025-11-02 14:37:22,778 - models.nhits - INFO - Epoch   2 | train_loss=609.743249 | val_loss=26.639380
2025-11-02 14:37:30,860 - models.nhits - INFO - Epoch   3 | train_loss=10.982148 | val_loss=1.965379
2025-11-02 14:37:38,958 - models.nhits - INFO - Epoch   4 | train_loss=1.188254 | val_loss=0.349690
2025-11-02 14:37:47,003 - models.nhits - INFO - Epoch   5 | train_loss=0.359608 | val_loss=0.247126
2025-11-02 14:37:55,068 - models.nhits - INFO - Epoch   6 | train_loss=0.283344 | val_loss=0.185463
2025-11-02 14:38:03,140 - models.nhits - INFO - Epoch   7 | train_loss=0.119331 | val_loss=0.099034
2025-11-02 14:38:11,240 - models.nhits - INFO - Epoch   8 | train_loss=0.106288 | val_loss=0.070303
2025-11-02 14:38:19,308 - models.nhits - INFO - Epoch   9 | train_loss=0.070477 | val_loss=0.091732
2025-11-02 14:38:27,378 - models.nhits - INFO - Epoch  10 | train_loss=0.064248 | val_loss=0.074195
2025-11-02 14:38:35,423 - models.nhits - INFO - Epoch  11 | train_loss=0.051674 | val_loss=0.105165
2025-11-02 14:38:43,393 - models.nhits - INFO - Epoch  12 | train_loss=0.053079 | val_loss=0.080575
2025-11-02 14:38:51,384 - models.nhits - INFO - Epoch  13 | train_loss=0.192977 | val_loss=0.053926
2025-11-02 14:38:59,361 - models.nhits - INFO - Epoch  14 | train_loss=0.048907 | val_loss=0.051027
2025-11-02 14:39:07,344 - models.nhits - INFO - Epoch  15 | train_loss=0.045142 | val_loss=0.053143
2025-11-02 14:39:15,320 - models.nhits - INFO - Epoch  16 | train_loss=0.299998 | val_loss=0.055744
2025-11-02 14:39:23,303 - models.nhits - INFO - Epoch  17 | train_loss=0.044282 | val_loss=0.078391
2025-11-02 14:39:31,344 - models.nhits - INFO - Epoch  18 | train_loss=0.369788 | val_loss=0.071827
2025-11-02 14:39:39,337 - models.nhits - INFO - Epoch  19 | train_loss=0.043430 | val_loss=0.042837
2025-11-02 14:39:47,415 - models.nhits - INFO - Epoch  20 | train_loss=0.068365 | val_loss=0.048806
2025-11-02 14:39:55,440 - models.nhits - INFO - Epoch  21 | train_loss=0.041412 | val_loss=0.046221
2025-11-02 14:40:03,429 - models.nhits - INFO - Epoch  22 | train_loss=0.237861 | val_loss=0.050021
2025-11-02 14:40:11,496 - models.nhits - INFO - Epoch  23 | train_loss=0.041191 | val_loss=0.056356
2025-11-02 14:40:19,589 - models.nhits - INFO - Epoch  24 | train_loss=0.036615 | val_loss=0.050896
2025-11-02 14:40:27,666 - models.nhits - INFO - Epoch  25 | train_loss=0.039156 | val_loss=0.046780
2025-11-02 14:40:35,757 - models.nhits - INFO - Epoch  26 | train_loss=0.037716 | val_loss=0.074439
2025-11-02 14:40:43,858 - models.nhits - INFO - Epoch  27 | train_loss=0.702850 | val_loss=0.064602
2025-11-02 14:40:51,942 - models.nhits - INFO - Epoch  28 | train_loss=0.053209 | val_loss=0.059740
2025-11-02 14:41:00,060 - models.nhits - INFO - Epoch  29 | train_loss=0.228054 | val_loss=0.049063
2025-11-02 14:41:08,467 - models.nhits - INFO - Epoch  30 | train_loss=0.044485 | val_loss=0.047591
2025-11-02 14:41:16,876 - models.nhits - INFO - Epoch  31 | train_loss=0.030484 | val_loss=0.039402
2025-11-02 14:41:25,080 - models.nhits - INFO - Epoch  32 | train_loss=0.028746 | val_loss=0.039012
2025-11-02 14:41:33,400 - models.nhits - INFO - Epoch  33 | train_loss=0.029104 | val_loss=0.037882
2025-11-02 14:41:41,751 - models.nhits - INFO - Epoch  34 | train_loss=0.028789 | val_loss=0.044381
2025-11-02 14:41:50,008 - models.nhits - INFO - Epoch  35 | train_loss=0.029384 | val_loss=0.041466
2025-11-02 14:41:58,225 - models.nhits - INFO - Epoch  36 | train_loss=0.028618 | val_loss=0.048896
2025-11-02 14:42:06,533 - models.nhits - INFO - Epoch  37 | train_loss=0.027743 | val_loss=0.037744
2025-11-02 14:42:14,610 - models.nhits - INFO - Epoch  38 | train_loss=0.028302 | val_loss=0.048009
2025-11-02 14:42:22,578 - models.nhits - INFO - Epoch  39 | train_loss=0.027813 | val_loss=0.039068
2025-11-02 14:42:30,659 - models.nhits - INFO - Epoch  40 | train_loss=0.027164 | val_loss=0.034905
2025-11-02 14:42:38,786 - models.nhits - INFO - Epoch  41 | train_loss=0.026514 | val_loss=0.033678
2025-11-02 14:42:46,854 - models.nhits - INFO - Epoch  42 | train_loss=0.026791 | val_loss=0.037053
2025-11-02 14:42:54,915 - models.nhits - INFO - Epoch  43 | train_loss=0.026205 | val_loss=0.036750
2025-11-02 14:43:02,989 - models.nhits - INFO - Epoch  44 | train_loss=0.026054 | val_loss=0.047693
2025-11-02 14:43:11,352 - models.nhits - INFO - Epoch  45 | train_loss=0.025855 | val_loss=0.038709
2025-11-02 14:43:19,706 - models.nhits - INFO - Epoch  46 | train_loss=0.025498 | val_loss=0.037976
2025-11-02 14:43:28,055 - models.nhits - INFO - Epoch  47 | train_loss=0.025919 | val_loss=0.037247
2025-11-02 14:43:36,262 - models.nhits - INFO - Epoch  48 | train_loss=0.025847 | val_loss=0.038657
2025-11-02 14:43:44,480 - models.nhits - INFO - Epoch  49 | train_loss=0.025370 | val_loss=0.035985
2025-11-02 14:43:52,730 - models.nhits - INFO - Epoch  50 | train_loss=0.025379 | val_loss=0.039889
2025-11-02 14:44:00,996 - models.nhits - INFO - Epoch  51 | train_loss=0.024453 | val_loss=0.042090
2025-11-02 14:44:09,544 - models.nhits - INFO - Epoch  52 | train_loss=0.024309 | val_loss=0.031092
2025-11-02 14:44:18,036 - models.nhits - INFO - Epoch  53 | train_loss=0.024226 | val_loss=0.033217
2025-11-02 14:44:26,294 - models.nhits - INFO - Epoch  54 | train_loss=0.023600 | val_loss=0.035111
2025-11-02 14:44:34,541 - models.nhits - INFO - Epoch  55 | train_loss=0.023908 | val_loss=0.031781
2025-11-02 14:44:43,019 - models.nhits - INFO - Epoch  56 | train_loss=0.024099 | val_loss=0.035092
2025-11-02 14:44:51,044 - models.nhits - INFO - Epoch  57 | train_loss=0.023119 | val_loss=0.035133
2025-11-02 14:44:58,992 - models.nhits - INFO - Epoch  58 | train_loss=0.023682 | val_loss=0.036962
2025-11-02 14:45:06,994 - models.nhits - INFO - Epoch  59 | train_loss=0.023115 | val_loss=0.033736
2025-11-02 14:45:14,973 - models.nhits - INFO - Epoch  60 | train_loss=0.023180 | val_loss=0.033500
2025-11-02 14:45:23,025 - models.nhits - INFO - Epoch  61 | train_loss=0.023263 | val_loss=0.032391
2025-11-02 14:45:31,219 - models.nhits - INFO - Epoch  62 | train_loss=0.022339 | val_loss=0.034136
2025-11-02 14:45:39,146 - models.nhits - INFO - Epoch  63 | train_loss=0.022153 | val_loss=0.035817
2025-11-02 14:45:47,139 - models.nhits - INFO - Epoch  64 | train_loss=0.019151 | val_loss=0.034671
2025-11-02 14:45:55,048 - models.nhits - INFO - Epoch  65 | train_loss=0.019132 | val_loss=0.034528
2025-11-02 14:46:02,966 - models.nhits - INFO - Epoch  66 | train_loss=0.018521 | val_loss=0.030713
2025-11-02 14:46:10,911 - models.nhits - INFO - Epoch  67 | train_loss=0.018501 | val_loss=0.029098
2025-11-02 14:46:18,934 - models.nhits - INFO - Epoch  68 | train_loss=0.018171 | val_loss=0.030468
2025-11-02 14:46:26,991 - models.nhits - INFO - Epoch  69 | train_loss=0.018082 | val_loss=0.030637
2025-11-02 14:46:35,201 - models.nhits - INFO - Epoch  70 | train_loss=0.017690 | val_loss=0.039436
2025-11-02 14:46:43,670 - models.nhits - INFO - Epoch  71 | train_loss=0.017505 | val_loss=0.030438
2025-11-02 14:46:51,732 - models.nhits - INFO - Epoch  72 | train_loss=0.017198 | val_loss=0.031286
2025-11-02 14:46:59,782 - models.nhits - INFO - Epoch  73 | train_loss=0.017766 | val_loss=0.033243
2025-11-02 14:47:07,802 - models.nhits - INFO - Epoch  74 | train_loss=0.016631 | val_loss=0.031388
2025-11-02 14:47:15,821 - models.nhits - INFO - Epoch  75 | train_loss=0.016769 | val_loss=0.029295
2025-11-02 14:47:23,852 - models.nhits - INFO - Epoch  76 | train_loss=0.016696 | val_loss=0.032180
2025-11-02 14:47:31,924 - models.nhits - INFO - Epoch  77 | train_loss=0.016669 | val_loss=0.030173
2025-11-02 14:47:39,956 - models.nhits - INFO - Epoch  78 | train_loss=0.016282 | val_loss=0.029588
2025-11-02 14:47:48,009 - models.nhits - INFO - Epoch  79 | train_loss=0.013797 | val_loss=0.029442
2025-11-02 14:47:56,016 - models.nhits - INFO - Epoch  80 | train_loss=0.013613 | val_loss=0.026337
2025-11-02 14:48:04,022 - models.nhits - INFO - Epoch  81 | train_loss=0.013365 | val_loss=0.029524
2025-11-02 14:48:11,921 - models.nhits - INFO - Epoch  82 | train_loss=0.013451 | val_loss=0.026635
2025-11-02 14:48:19,894 - models.nhits - INFO - Epoch  83 | train_loss=0.013131 | val_loss=0.027831
2025-11-02 14:48:27,893 - models.nhits - INFO - Epoch  84 | train_loss=0.013559 | val_loss=0.026574
2025-11-02 14:48:35,952 - models.nhits - INFO - Epoch  85 | train_loss=0.013411 | val_loss=0.028157
2025-11-02 14:48:43,935 - models.nhits - INFO - Epoch  86 | train_loss=0.012924 | val_loss=0.031097
2025-11-02 14:48:51,945 - models.nhits - INFO - Epoch  87 | train_loss=0.013083 | val_loss=0.028267
2025-11-02 14:48:59,889 - models.nhits - INFO - Epoch  88 | train_loss=0.013100 | val_loss=0.025142
2025-11-02 14:49:07,834 - models.nhits - INFO - Epoch  89 | train_loss=0.012597 | val_loss=0.024224
2025-11-02 14:49:15,739 - models.nhits - INFO - Epoch  90 | train_loss=0.012673 | val_loss=0.025436
2025-11-02 14:49:23,666 - models.nhits - INFO - Epoch  91 | train_loss=0.013132 | val_loss=0.027207
2025-11-02 14:49:31,608 - models.nhits - INFO - Epoch  92 | train_loss=0.012932 | val_loss=0.024475
2025-11-02 14:49:39,511 - models.nhits - INFO - Epoch  93 | train_loss=0.012301 | val_loss=0.024079
2025-11-02 14:49:47,531 - models.nhits - INFO - Epoch  94 | train_loss=0.012956 | val_loss=0.027580
2025-11-02 14:49:55,461 - models.nhits - INFO - Epoch  95 | train_loss=0.012386 | val_loss=0.025529
2025-11-02 14:50:03,398 - models.nhits - INFO - Epoch  96 | train_loss=0.012812 | val_loss=0.023562
2025-11-02 14:50:11,325 - models.nhits - INFO - Epoch  97 | train_loss=0.012878 | val_loss=0.025130
2025-11-02 14:50:19,258 - models.nhits - INFO - Epoch  98 | train_loss=0.012532 | val_loss=0.026695
2025-11-02 14:50:27,264 - models.nhits - INFO - Epoch  99 | train_loss=0.012643 | val_loss=0.025456
2025-11-02 14:50:35,327 - models.nhits - INFO - Epoch 100 | train_loss=0.012351 | val_loss=0.025813
2025-11-02 14:50:35,348 - models.patchtst - INFO - 模型已保存到: results\experiment_20251102_143353/patchtst_model.pth
2025-11-02 14:50:35,375 - models.nhits - INFO - 模型已保存到: results\experiment_20251102_143353/nhits_model.pth
2025-11-02 14:50:35,375 - main - INFO - 专家模型训练完成
2025-11-02 14:50:35,378 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-02 14:50:35,378 - main - INFO - 获取专家模型预测...
2025-11-02 14:50:47,625 - main - INFO - 专家预测获取完成
2025-11-02 14:50:47,627 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-02 14:50:48,314 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-11-02 14:50:48,328 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.161743
2025-11-02 14:50:48,331 - __main__ - ERROR - 实验失败: '<' not supported between instances of 'numpy.ndarray' and 'str'
2025-11-02 15:45:04,644 - __main__ - INFO - 初始化实验...
2025-11-02 15:45:04,653 - main - INFO - 使用设备: cuda
2025-11-02 15:45:04,654 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-02 15:45:04,655 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-02 15:45:04,655 - main - INFO - 开始数据加载和预处理...
2025-11-02 15:45:04,663 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 15:45:06,777 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 15:45:06,779 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 15:45:06,781 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 15:45:06,783 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 15:45:06,789 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 15:45:06,789 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 15:45:06,863 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 15:45:06,864 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 15:45:06,864 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 15:45:06,864 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 15:45:06,864 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 15:45:06,941 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 15:45:06,941 - main - INFO - 数据预处理完成:
2025-11-02 15:45:06,941 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 15:45:06,941 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 15:45:06,941 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 15:45:06,941 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-02 15:45:06,942 - main - INFO - 开始训练专家模型...
2025-11-02 15:45:06,942 - main - INFO - 创建PatchTST模型...
2025-11-02 15:45:06,954 - main - INFO - 创建NHITS模型...
2025-11-02 15:45:07,033 - main - INFO - 训练PatchTST...
2025-11-02 15:45:16,916 - models.patchtst - INFO - Epoch   1 | train_loss=0.928485 | val_loss=1.327811
2025-11-02 15:45:23,995 - models.patchtst - INFO - Epoch   2 | train_loss=0.924033 | val_loss=1.327891
2025-11-02 15:45:30,981 - models.patchtst - INFO - Epoch   3 | train_loss=0.924010 | val_loss=1.327969
2025-11-02 15:45:38,071 - models.patchtst - INFO - Epoch   4 | train_loss=0.923993 | val_loss=1.327809
2025-11-02 15:45:45,091 - models.patchtst - INFO - Epoch   5 | train_loss=0.923953 | val_loss=1.327785
2025-11-02 15:45:52,116 - models.patchtst - INFO - Epoch   6 | train_loss=0.923944 | val_loss=1.327698
2025-11-02 15:45:59,200 - models.patchtst - INFO - Epoch   7 | train_loss=0.923968 | val_loss=1.327738
2025-11-02 15:46:06,285 - models.patchtst - INFO - Epoch   8 | train_loss=0.924596 | val_loss=1.327607
2025-11-02 15:46:13,339 - models.patchtst - INFO - Epoch   9 | train_loss=0.924013 | val_loss=1.327675
2025-11-02 15:46:20,445 - models.patchtst - INFO - Epoch  10 | train_loss=0.923917 | val_loss=1.327899
2025-11-02 15:46:27,517 - models.patchtst - INFO - Epoch  11 | train_loss=0.923943 | val_loss=1.327735
2025-11-02 15:46:34,607 - models.patchtst - INFO - Epoch  12 | train_loss=0.923939 | val_loss=1.327597
2025-11-02 15:46:41,685 - models.patchtst - INFO - Epoch  13 | train_loss=0.924022 | val_loss=1.327743
2025-11-02 15:46:48,761 - models.patchtst - INFO - Epoch  14 | train_loss=0.923964 | val_loss=1.327748
2025-11-02 15:46:55,968 - models.patchtst - INFO - Epoch  15 | train_loss=0.923992 | val_loss=1.327635
2025-11-02 15:47:03,064 - models.patchtst - INFO - Epoch  16 | train_loss=0.923991 | val_loss=1.327943
2025-11-02 15:47:10,165 - models.patchtst - INFO - Epoch  17 | train_loss=0.923987 | val_loss=1.327744
2025-11-02 15:47:17,265 - models.patchtst - INFO - Epoch  18 | train_loss=0.923959 | val_loss=1.327726
2025-11-02 15:47:24,431 - models.patchtst - INFO - Epoch  19 | train_loss=0.923897 | val_loss=1.327933
2025-11-02 15:47:31,588 - models.patchtst - INFO - Epoch  20 | train_loss=0.923938 | val_loss=1.327855
2025-11-02 15:47:38,673 - models.patchtst - INFO - Epoch  21 | train_loss=0.923892 | val_loss=1.327795
2025-11-02 15:47:45,754 - models.patchtst - INFO - Epoch  22 | train_loss=0.923930 | val_loss=1.327743
2025-11-02 15:47:52,928 - models.patchtst - INFO - Epoch  23 | train_loss=0.923907 | val_loss=1.327814
2025-11-02 15:48:00,185 - models.patchtst - INFO - Epoch  24 | train_loss=0.923992 | val_loss=1.327772
2025-11-02 15:48:07,337 - models.patchtst - INFO - Epoch  25 | train_loss=0.923931 | val_loss=1.327743
2025-11-02 15:48:14,437 - models.patchtst - INFO - Epoch  26 | train_loss=0.923923 | val_loss=1.327733
2025-11-02 15:48:21,522 - models.patchtst - INFO - Epoch  27 | train_loss=0.923928 | val_loss=1.327805
2025-11-02 15:48:21,523 - models.patchtst - INFO - Early stopping at epoch 27早停触发（连续15轮验证损失未下降），最佳验证损失：1.327597
2025-11-02 15:48:21,523 - main - INFO - 训练NHITS...
2025-11-02 15:48:29,462 - models.nhits - INFO - Epoch   1 | train_loss=418433462.973762 | val_loss=540.788164
2025-11-02 15:48:37,454 - models.nhits - INFO - Epoch   2 | train_loss=271.306496 | val_loss=5.300760
2025-11-02 15:48:45,523 - models.nhits - INFO - Epoch   3 | train_loss=4.536635 | val_loss=0.799403
2025-11-02 15:48:53,650 - models.nhits - INFO - Epoch   4 | train_loss=0.622664 | val_loss=0.191767
2025-11-02 15:49:01,757 - models.nhits - INFO - Epoch   5 | train_loss=0.174997 | val_loss=0.117211
2025-11-02 15:49:09,815 - models.nhits - INFO - Epoch   6 | train_loss=0.079008 | val_loss=0.063208
2025-11-02 15:49:17,906 - models.nhits - INFO - Epoch   7 | train_loss=0.045412 | val_loss=0.059367
2025-11-02 15:49:25,949 - models.nhits - INFO - Epoch   8 | train_loss=0.055887 | val_loss=0.072391
2025-11-02 15:49:33,963 - models.nhits - INFO - Epoch   9 | train_loss=0.046066 | val_loss=0.068651
2025-11-02 15:49:42,043 - models.nhits - INFO - Epoch  10 | train_loss=18.320510 | val_loss=0.918434
2025-11-02 15:49:50,110 - models.nhits - INFO - Epoch  11 | train_loss=0.136851 | val_loss=0.044582
2025-11-02 15:49:58,223 - models.nhits - INFO - Epoch  12 | train_loss=0.119570 | val_loss=0.047049
2025-11-02 15:50:06,304 - models.nhits - INFO - Epoch  13 | train_loss=0.042058 | val_loss=0.190495
2025-11-02 15:50:14,322 - models.nhits - INFO - Epoch  14 | train_loss=0.039606 | val_loss=0.043493
2025-11-02 15:50:22,415 - models.nhits - INFO - Epoch  15 | train_loss=0.033163 | val_loss=0.059825
2025-11-02 15:50:30,532 - models.nhits - INFO - Epoch  16 | train_loss=2.002990 | val_loss=0.049560
2025-11-02 15:50:38,664 - models.nhits - INFO - Epoch  17 | train_loss=0.032353 | val_loss=0.103534
2025-11-02 15:50:46,796 - models.nhits - INFO - Epoch  18 | train_loss=0.085453 | val_loss=0.053376
2025-11-02 15:50:54,915 - models.nhits - INFO - Epoch  19 | train_loss=0.033450 | val_loss=0.093370
2025-11-02 15:51:03,039 - models.nhits - INFO - Epoch  20 | train_loss=0.165776 | val_loss=0.035771
2025-11-02 15:51:11,055 - models.nhits - INFO - Epoch  21 | train_loss=0.043485 | val_loss=0.045878
2025-11-02 15:51:19,046 - models.nhits - INFO - Epoch  22 | train_loss=0.061642 | val_loss=0.046457
2025-11-02 15:51:27,043 - models.nhits - INFO - Epoch  23 | train_loss=0.051556 | val_loss=0.034435
2025-11-02 15:51:35,041 - models.nhits - INFO - Epoch  24 | train_loss=0.029454 | val_loss=0.031641
2025-11-02 15:51:43,015 - models.nhits - INFO - Epoch  25 | train_loss=0.712205 | val_loss=0.050198
2025-11-02 15:51:51,016 - models.nhits - INFO - Epoch  26 | train_loss=0.028954 | val_loss=0.038787
2025-11-02 15:51:59,048 - models.nhits - INFO - Epoch  27 | train_loss=1.634462 | val_loss=0.035787
2025-11-02 15:52:07,067 - models.nhits - INFO - Epoch  28 | train_loss=0.161038 | val_loss=0.039739
2025-11-02 15:52:15,486 - models.nhits - INFO - Epoch  29 | train_loss=0.025107 | val_loss=0.038703
2025-11-02 15:52:23,825 - models.nhits - INFO - Epoch  30 | train_loss=0.245758 | val_loss=0.039504
2025-11-02 15:52:32,053 - models.nhits - INFO - Epoch  31 | train_loss=0.028742 | val_loss=0.053619
2025-11-02 15:52:40,373 - models.nhits - INFO - Epoch  32 | train_loss=0.027254 | val_loss=0.052422
2025-11-02 15:52:48,693 - models.nhits - INFO - Epoch  33 | train_loss=0.047350 | val_loss=0.044657
2025-11-02 15:52:56,994 - models.nhits - INFO - Epoch  34 | train_loss=0.031564 | val_loss=0.038936
2025-11-02 15:53:05,212 - models.nhits - INFO - Epoch  35 | train_loss=0.026246 | val_loss=0.047900
2025-11-02 15:53:13,467 - models.nhits - INFO - Epoch  36 | train_loss=0.019631 | val_loss=0.039347
2025-11-02 15:53:21,665 - models.nhits - INFO - Epoch  37 | train_loss=0.018683 | val_loss=0.039134
2025-11-02 15:53:29,810 - models.nhits - INFO - Epoch  38 | train_loss=0.018202 | val_loss=0.031742
2025-11-02 15:53:37,949 - models.nhits - INFO - Epoch  39 | train_loss=0.022117 | val_loss=0.035045
2025-11-02 15:53:37,949 - models.nhits - INFO - Early stopping at epoch 39早停触发（连续15轮验证损失未下降），最佳验证损失：0.031641
2025-11-02 15:53:37,967 - models.patchtst - INFO - 模型已保存到: results\experiment_20251102_154504/patchtst_model.pth
2025-11-02 15:53:37,993 - models.nhits - INFO - 模型已保存到: results\experiment_20251102_154504/nhits_model.pth
2025-11-02 15:53:37,993 - main - INFO - 专家模型训练完成
2025-11-02 15:53:37,997 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-02 15:53:37,997 - main - INFO - 获取专家模型预测...
2025-11-02 15:53:50,380 - main - INFO - 专家预测获取完成
2025-11-02 15:53:50,381 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-02 15:53:51,041 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = 0.188063
2025-11-02 15:53:51,056 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.188063
2025-11-02 15:53:51,058 - src.strategies.mpa_optimizer - INFO - 在第 11 代收敛
2025-11-02 15:53:56,619 - main - INFO - 策略A快速模式完成 - 最优权重: [9.83873244e-07 9.99999016e-01], 验证集RMSE: 0.188063
2025-11-02 15:53:56,620 - main - INFO - 实现策略B快速模式：广义线性融合（max_iterations=20）...
2025-11-02 15:53:57,281 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = 0.969987
2025-11-02 15:53:57,343 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.190960
2025-11-02 15:54:02,934 - main - INFO - 策略B快速模式完成 - 最优系数: [-9.70030923e-04 -3.67007680e+00  9.93664585e-01], 验证集RMSE: 0.187666
2025-11-02 15:54:02,934 - __main__ - INFO - 快速验证模式完成！
2025-11-02 19:40:28,034 - __main__ - INFO - 初始化实验...
2025-11-02 19:40:28,046 - main - INFO - 使用设备: cuda
2025-11-02 19:40:28,047 - __main__ - INFO - 开始完整实验...
2025-11-02 19:40:28,048 - main - INFO - 开始完整实验流程...
2025-11-02 19:40:28,048 - main - INFO - 开始数据加载和预处理...
2025-11-02 19:40:28,055 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 19:40:30,334 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 19:40:30,339 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 19:40:30,341 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 19:40:30,345 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 19:40:30,354 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 19:40:30,354 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 19:40:30,449 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 19:40:30,449 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 19:40:30,449 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 19:40:30,451 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 19:40:30,451 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 19:40:30,515 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 19:40:30,515 - main - INFO - 数据预处理完成:
2025-11-02 19:40:30,515 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 19:40:30,516 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 19:40:30,516 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 19:40:30,516 - main - INFO - 开始专家模型超参数优化...
2025-11-02 19:40:30,524 - main - INFO - 优化PatchTST超参数...
2025-11-02 19:40:30,547 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,548 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,549 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,549 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,549 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,551 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,551 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,552 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,553 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,553 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,554 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,555 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,555 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,556 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,557 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,557 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,558 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,559 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,559 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,560 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,561 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,561 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,562 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,563 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,563 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,564 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,564 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,565 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,566 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,566 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,567 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,568 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,568 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,569 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,569 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,571 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,572 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,572 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,573 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,573 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,574 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,575 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,577 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,577 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,578 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,578 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,579 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,580 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,581 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,581 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 19:40:30,582 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-02 19:40:30,582 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 19:40:30,587 - main - INFO - 优化NHITS超参数...
2025-11-02 19:40:30,597 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,598 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,599 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,599 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,601 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,601 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,602 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,603 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,603 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,604 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,605 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,605 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,606 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,606 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,607 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,608 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,608 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,609 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,609 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,611 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,612 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,612 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,613 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,613 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,614 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,615 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,615 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,616 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,617 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,617 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,618 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,618 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,619 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,619 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,619 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,621 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,622 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,622 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,623 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,623 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,624 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,624 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,625 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,626 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,626 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,627 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,627 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,628 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,629 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,629 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 19:40:30,630 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-02 19:40:30,630 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 19:40:30,636 - main - INFO - 超参数优化完成
2025-11-02 19:40:30,636 - main - INFO - 开始训练专家模型...
2025-11-02 19:40:30,636 - main - INFO - 创建PatchTST模型...
2025-11-02 19:40:30,675 - main - INFO - 创建NHITS模型...
2025-11-02 19:40:30,755 - main - INFO - 训练PatchTST...
2025-11-02 19:40:42,354 - models.patchtst - INFO - Epoch   1 | train_loss=0.930152 | val_loss=1.327780
2025-11-02 19:40:49,764 - models.patchtst - INFO - Epoch   2 | train_loss=0.924063 | val_loss=1.327839
2025-11-02 19:40:57,506 - models.patchtst - INFO - Epoch   3 | train_loss=0.924037 | val_loss=1.327921
2025-11-02 19:41:05,686 - models.patchtst - INFO - Epoch   4 | train_loss=0.923907 | val_loss=1.327771
2025-11-02 19:41:13,585 - models.patchtst - INFO - Epoch   5 | train_loss=0.923982 | val_loss=1.327695
2025-11-02 19:41:21,413 - models.patchtst - INFO - Epoch   6 | train_loss=0.924020 | val_loss=1.327764
2025-11-02 19:41:28,742 - models.patchtst - INFO - Epoch   7 | train_loss=0.923936 | val_loss=1.327701
2025-11-02 19:41:36,001 - models.patchtst - INFO - Epoch   8 | train_loss=0.923958 | val_loss=1.327726
2025-11-02 19:41:43,267 - models.patchtst - INFO - Epoch   9 | train_loss=0.924010 | val_loss=1.327663
2025-11-02 19:41:50,546 - models.patchtst - INFO - Epoch  10 | train_loss=0.924048 | val_loss=1.327712
2025-11-02 19:41:57,740 - models.patchtst - INFO - Epoch  11 | train_loss=0.923979 | val_loss=1.327723
2025-11-02 19:42:04,973 - models.patchtst - INFO - Epoch  12 | train_loss=0.923967 | val_loss=1.327828
2025-11-02 19:42:12,245 - models.patchtst - INFO - Epoch  13 | train_loss=0.923913 | val_loss=1.327730
2025-11-02 19:42:19,485 - models.patchtst - INFO - Epoch  14 | train_loss=0.923944 | val_loss=1.327726
2025-11-02 19:42:26,879 - models.patchtst - INFO - Epoch  15 | train_loss=0.923920 | val_loss=1.327673
2025-11-02 19:42:34,148 - models.patchtst - INFO - Epoch  16 | train_loss=0.923912 | val_loss=1.327751
2025-11-02 19:42:41,355 - models.patchtst - INFO - Epoch  17 | train_loss=0.923852 | val_loss=1.327714
2025-11-02 19:42:48,508 - models.patchtst - INFO - Epoch  18 | train_loss=0.923948 | val_loss=1.327801
2025-11-02 19:42:55,626 - models.patchtst - INFO - Epoch  19 | train_loss=0.923868 | val_loss=1.327812
2025-11-02 19:43:02,808 - models.patchtst - INFO - Epoch  20 | train_loss=0.923910 | val_loss=1.327797
2025-11-02 19:43:09,880 - models.patchtst - INFO - Epoch  21 | train_loss=0.924012 | val_loss=1.327764
2025-11-02 19:43:17,021 - models.patchtst - INFO - Epoch  22 | train_loss=0.923905 | val_loss=1.327794
2025-11-02 19:43:24,134 - models.patchtst - INFO - Epoch  23 | train_loss=0.923920 | val_loss=1.327818
2025-11-02 19:43:31,196 - models.patchtst - INFO - Epoch  24 | train_loss=0.923899 | val_loss=1.327823
2025-11-02 19:43:31,196 - models.patchtst - INFO - Early stopping at epoch 24早停触发（连续15轮验证损失未下降），最佳验证损失：1.327663
2025-11-02 19:43:31,196 - main - INFO - 训练NHITS...
2025-11-02 19:43:39,090 - models.nhits - INFO - Epoch   1 | train_loss=390177119.361511 | val_loss=518.348203
2025-11-02 19:43:46,993 - models.nhits - INFO - Epoch   2 | train_loss=96.505579 | val_loss=7.843985
2025-11-02 19:43:54,909 - models.nhits - INFO - Epoch   3 | train_loss=2.019396 | val_loss=0.463185
2025-11-02 19:44:02,954 - models.nhits - INFO - Epoch   4 | train_loss=0.247672 | val_loss=0.130642
2025-11-02 19:44:11,055 - models.nhits - INFO - Epoch   5 | train_loss=0.102655 | val_loss=0.056681
2025-11-02 19:44:19,144 - models.nhits - INFO - Epoch   6 | train_loss=0.066401 | val_loss=0.059131
2025-11-02 19:44:27,272 - models.nhits - INFO - Epoch   7 | train_loss=0.060783 | val_loss=0.063780
2025-11-02 19:44:35,369 - models.nhits - INFO - Epoch   8 | train_loss=0.088569 | val_loss=0.059283
2025-11-02 19:44:43,300 - models.nhits - INFO - Epoch   9 | train_loss=0.051881 | val_loss=0.047558
2025-11-02 19:44:51,298 - models.nhits - INFO - Epoch  10 | train_loss=0.045647 | val_loss=0.077660
2025-11-02 19:44:59,295 - models.nhits - INFO - Epoch  11 | train_loss=0.050975 | val_loss=0.048024
2025-11-02 19:45:07,311 - models.nhits - INFO - Epoch  12 | train_loss=0.040914 | val_loss=0.091714
2025-11-02 19:45:15,276 - models.nhits - INFO - Epoch  13 | train_loss=0.041168 | val_loss=0.057097
2025-11-02 19:45:23,258 - models.nhits - INFO - Epoch  14 | train_loss=0.969081 | val_loss=0.060264
2025-11-02 19:45:31,296 - models.nhits - INFO - Epoch  15 | train_loss=0.039796 | val_loss=0.040442
2025-11-02 19:45:39,378 - models.nhits - INFO - Epoch  16 | train_loss=0.037666 | val_loss=0.048445
2025-11-02 19:45:47,473 - models.nhits - INFO - Epoch  17 | train_loss=0.086606 | val_loss=0.071206
2025-11-02 19:45:55,519 - models.nhits - INFO - Epoch  18 | train_loss=0.037257 | val_loss=0.049403
2025-11-02 19:46:03,436 - models.nhits - INFO - Epoch  19 | train_loss=0.034498 | val_loss=0.045504
2025-11-02 19:46:11,375 - models.nhits - INFO - Epoch  20 | train_loss=3.461376 | val_loss=0.037048
2025-11-02 19:46:19,297 - models.nhits - INFO - Epoch  21 | train_loss=0.047181 | val_loss=0.042950
2025-11-02 19:46:27,343 - models.nhits - INFO - Epoch  22 | train_loss=0.034087 | val_loss=0.040042
2025-11-02 19:46:35,389 - models.nhits - INFO - Epoch  23 | train_loss=0.044025 | val_loss=0.044929
2025-11-02 19:46:43,321 - models.nhits - INFO - Epoch  24 | train_loss=0.034463 | val_loss=0.053948
2025-11-02 19:46:51,305 - models.nhits - INFO - Epoch  25 | train_loss=0.034339 | val_loss=0.035895
2025-11-02 19:46:59,391 - models.nhits - INFO - Epoch  26 | train_loss=0.043218 | val_loss=0.044238
2025-11-02 19:47:07,320 - models.nhits - INFO - Epoch  27 | train_loss=0.034232 | val_loss=0.042766
2025-11-02 19:47:15,283 - models.nhits - INFO - Epoch  28 | train_loss=0.036532 | val_loss=0.044018
2025-11-02 19:47:23,246 - models.nhits - INFO - Epoch  29 | train_loss=0.062216 | val_loss=0.057058
2025-11-02 19:47:31,154 - models.nhits - INFO - Epoch  30 | train_loss=0.165405 | val_loss=0.043598
2025-11-02 19:47:39,071 - models.nhits - INFO - Epoch  31 | train_loss=0.032173 | val_loss=0.038483
2025-11-02 19:47:47,013 - models.nhits - INFO - Epoch  32 | train_loss=0.031743 | val_loss=0.047927
2025-11-02 19:47:54,885 - models.nhits - INFO - Epoch  33 | train_loss=0.032396 | val_loss=0.041028
2025-11-02 19:48:02,806 - models.nhits - INFO - Epoch  34 | train_loss=0.030800 | val_loss=0.039698
2025-11-02 19:48:10,722 - models.nhits - INFO - Epoch  35 | train_loss=0.031266 | val_loss=0.043065
2025-11-02 19:48:18,635 - models.nhits - INFO - Epoch  36 | train_loss=0.043119 | val_loss=0.044343
2025-11-02 19:48:26,573 - models.nhits - INFO - Epoch  37 | train_loss=0.023943 | val_loss=0.040853
2025-11-02 19:48:34,578 - models.nhits - INFO - Epoch  38 | train_loss=0.023536 | val_loss=0.036475
2025-11-02 19:48:42,638 - models.nhits - INFO - Epoch  39 | train_loss=0.023074 | val_loss=0.041829
2025-11-02 19:48:50,670 - models.nhits - INFO - Epoch  40 | train_loss=0.021926 | val_loss=0.032860
2025-11-02 19:48:58,625 - models.nhits - INFO - Epoch  41 | train_loss=0.021796 | val_loss=0.031940
2025-11-02 19:49:06,550 - models.nhits - INFO - Epoch  42 | train_loss=0.021633 | val_loss=0.031499
2025-11-02 19:49:14,497 - models.nhits - INFO - Epoch  43 | train_loss=0.020528 | val_loss=0.031223
2025-11-02 19:49:22,450 - models.nhits - INFO - Epoch  44 | train_loss=0.021306 | val_loss=0.034369
2025-11-02 19:49:30,367 - models.nhits - INFO - Epoch  45 | train_loss=0.020653 | val_loss=0.033502
2025-11-02 19:49:38,313 - models.nhits - INFO - Epoch  46 | train_loss=0.020517 | val_loss=0.035639
2025-11-02 19:49:46,256 - models.nhits - INFO - Epoch  47 | train_loss=0.021157 | val_loss=0.032207
2025-11-02 19:49:54,182 - models.nhits - INFO - Epoch  48 | train_loss=0.021022 | val_loss=0.030771
2025-11-02 19:50:02,088 - models.nhits - INFO - Epoch  49 | train_loss=0.020077 | val_loss=0.036377
2025-11-02 19:50:10,033 - models.nhits - INFO - Epoch  50 | train_loss=0.024178 | val_loss=0.033818
2025-11-02 19:50:17,961 - models.nhits - INFO - Epoch  51 | train_loss=0.020292 | val_loss=0.033296
2025-11-02 19:50:25,887 - models.nhits - INFO - Epoch  52 | train_loss=0.019547 | val_loss=0.074853
2025-11-02 19:50:34,112 - models.nhits - INFO - Epoch  53 | train_loss=0.020123 | val_loss=0.033479
2025-11-02 19:50:42,374 - models.nhits - INFO - Epoch  54 | train_loss=0.020121 | val_loss=0.031356
2025-11-02 19:50:50,585 - models.nhits - INFO - Epoch  55 | train_loss=0.021524 | val_loss=0.031967
2025-11-02 19:50:58,740 - models.nhits - INFO - Epoch  56 | train_loss=0.018842 | val_loss=0.033412
2025-11-02 19:51:06,929 - models.nhits - INFO - Epoch  57 | train_loss=0.018763 | val_loss=0.035505
2025-11-02 19:51:15,061 - models.nhits - INFO - Epoch  58 | train_loss=0.019107 | val_loss=0.033410
2025-11-02 19:51:23,265 - models.nhits - INFO - Epoch  59 | train_loss=0.019135 | val_loss=0.034839
2025-11-02 19:51:31,408 - models.nhits - INFO - Epoch  60 | train_loss=0.015227 | val_loss=0.029894
2025-11-02 19:51:39,624 - models.nhits - INFO - Epoch  61 | train_loss=0.015040 | val_loss=0.030253
2025-11-02 19:51:47,789 - models.nhits - INFO - Epoch  62 | train_loss=0.014706 | val_loss=0.029227
2025-11-02 19:51:55,984 - models.nhits - INFO - Epoch  63 | train_loss=0.014577 | val_loss=0.030831
2025-11-02 19:52:04,213 - models.nhits - INFO - Epoch  64 | train_loss=0.013889 | val_loss=0.029265
2025-11-02 19:52:12,488 - models.nhits - INFO - Epoch  65 | train_loss=0.014408 | val_loss=0.025966
2025-11-02 19:52:20,732 - models.nhits - INFO - Epoch  66 | train_loss=0.013440 | val_loss=0.031500
2025-11-02 19:52:29,015 - models.nhits - INFO - Epoch  67 | train_loss=0.013790 | val_loss=0.027989
2025-11-02 19:52:37,337 - models.nhits - INFO - Epoch  68 | train_loss=0.013048 | val_loss=0.027897
2025-11-02 19:52:45,501 - models.nhits - INFO - Epoch  69 | train_loss=0.013547 | val_loss=0.026784
2025-11-02 19:52:53,676 - models.nhits - INFO - Epoch  70 | train_loss=0.013272 | val_loss=0.028257
2025-11-02 19:53:01,766 - models.nhits - INFO - Epoch  71 | train_loss=0.013137 | val_loss=0.032068
2025-11-02 19:53:09,978 - models.nhits - INFO - Epoch  72 | train_loss=0.012741 | val_loss=0.029554
2025-11-02 19:53:18,082 - models.nhits - INFO - Epoch  73 | train_loss=0.012974 | val_loss=0.032453
2025-11-02 19:53:26,222 - models.nhits - INFO - Epoch  74 | train_loss=0.013426 | val_loss=0.031915
2025-11-02 19:53:34,330 - models.nhits - INFO - Epoch  75 | train_loss=0.012922 | val_loss=0.027126
2025-11-02 19:53:42,567 - models.nhits - INFO - Epoch  76 | train_loss=0.012626 | val_loss=0.027061
2025-11-02 19:53:50,806 - models.nhits - INFO - Epoch  77 | train_loss=0.011286 | val_loss=0.025912
2025-11-02 19:53:59,064 - models.nhits - INFO - Epoch  78 | train_loss=0.010478 | val_loss=0.024082
2025-11-02 19:54:07,294 - models.nhits - INFO - Epoch  79 | train_loss=0.010439 | val_loss=0.025295
2025-11-02 19:54:15,544 - models.nhits - INFO - Epoch  80 | train_loss=0.010132 | val_loss=0.024101
2025-11-02 19:54:23,788 - models.nhits - INFO - Epoch  81 | train_loss=0.010043 | val_loss=0.029982
2025-11-02 19:54:32,065 - models.nhits - INFO - Epoch  82 | train_loss=0.010173 | val_loss=0.024990
2025-11-02 19:54:40,273 - models.nhits - INFO - Epoch  83 | train_loss=0.009969 | val_loss=0.027254
2025-11-02 19:54:48,520 - models.nhits - INFO - Epoch  84 | train_loss=0.009849 | val_loss=0.024238
2025-11-02 19:54:56,744 - models.nhits - INFO - Epoch  85 | train_loss=0.009867 | val_loss=0.027206
2025-11-02 19:55:04,985 - models.nhits - INFO - Epoch  86 | train_loss=0.009613 | val_loss=0.026901
2025-11-02 19:55:13,295 - models.nhits - INFO - Epoch  87 | train_loss=0.009871 | val_loss=0.024243
2025-11-02 19:55:21,538 - models.nhits - INFO - Epoch  88 | train_loss=0.009834 | val_loss=0.025063
2025-11-02 19:55:29,811 - models.nhits - INFO - Epoch  89 | train_loss=0.009492 | val_loss=0.026874
2025-11-02 19:55:38,095 - models.nhits - INFO - Epoch  90 | train_loss=0.008770 | val_loss=0.026404
2025-11-02 19:55:46,402 - models.nhits - INFO - Epoch  91 | train_loss=0.008618 | val_loss=0.025100
2025-11-02 19:55:54,662 - models.nhits - INFO - Epoch  92 | train_loss=0.008438 | val_loss=0.024799
2025-11-02 19:56:02,901 - models.nhits - INFO - Epoch  93 | train_loss=0.008506 | val_loss=0.025737
2025-11-02 19:56:02,902 - models.nhits - INFO - Early stopping at epoch 93早停触发（连续15轮验证损失未下降），最佳验证损失：0.024082
2025-11-02 19:56:02,918 - models.patchtst - INFO - 模型已保存到: results\experiment_20251102_194028/patchtst_model.pth
2025-11-02 19:56:02,949 - models.nhits - INFO - 模型已保存到: results\experiment_20251102_194028/nhits_model.pth
2025-11-02 19:56:02,949 - main - INFO - 专家模型训练完成
2025-11-02 19:56:02,953 - main - INFO - 获取专家模型预测...
2025-11-02 19:56:16,101 - main - INFO - 专家预测获取完成
2025-11-02 19:56:16,102 - main - INFO - 实现策略A：静态优化权重...
2025-11-02 19:56:16,766 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-11-02 19:56:16,775 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 1.151925
2025-11-02 19:56:16,776 - src.strategies.mpa_optimizer - INFO - 在第 12 代收敛
2025-11-02 19:56:22,744 - main - INFO - 策略A完成 - 最优权重: [1. 0.], 验证集RMSE: 1.151925
2025-11-02 19:56:22,744 - main - INFO - 实现策略B：广义线性融合...
2025-11-02 19:56:23,416 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = 0.900250
2025-11-02 19:56:23,483 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.900250
2025-11-02 19:56:23,491 - src.strategies.mpa_optimizer - INFO - 在第 11 代收敛
2025-11-02 19:56:29,530 - main - INFO - 策略B完成 - 最优系数: [-0.11379126 -3.23882308  0.23384598], 验证集RMSE: 0.900250
2025-11-02 19:56:29,531 - main - INFO - 实现策略C：动态门控网络...
2025-11-02 19:56:29,741 - __main__ - ERROR - 实验失败: '<=' not supported between instances of 'float' and 'str'
2025-11-02 22:55:08,715 - __main__ - INFO - 初始化实验...
2025-11-02 22:55:08,726 - main - INFO - 使用设备: cuda
2025-11-02 22:55:08,728 - __main__ - INFO - 开始完整实验...
2025-11-02 22:55:08,729 - main - INFO - 开始完整实验流程...
2025-11-02 22:55:08,729 - main - INFO - 开始数据加载和预处理...
2025-11-02 22:55:08,737 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 22:55:10,908 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 22:55:10,912 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 22:55:10,915 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 22:55:10,917 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 22:55:10,925 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 22:55:10,925 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 22:55:11,009 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 22:55:11,009 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 22:55:11,009 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 22:55:11,009 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 22:55:11,009 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 22:55:11,095 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 22:55:11,096 - main - INFO - 数据预处理完成:
2025-11-02 22:55:11,096 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 22:55:11,096 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 22:55:11,096 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 22:55:11,096 - main - INFO - 开始专家模型超参数优化...
2025-11-02 22:55:11,105 - main - INFO - 优化PatchTST超参数...
2025-11-02 22:55:11,126 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,126 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,128 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,128 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,129 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,130 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,131 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,131 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,132 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,132 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,133 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,133 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,134 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,135 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,135 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,136 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,136 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,138 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,138 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,139 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,139 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,140 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,141 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,141 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,143 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,143 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,145 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,145 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,146 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,148 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,149 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,149 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,151 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,153 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,154 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,154 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,159 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,159 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,160 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 22:55:11,160 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-02 22:55:11,161 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 22:55:11,165 - main - INFO - 优化NHITS超参数...
2025-11-02 22:55:11,176 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,178 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,179 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,179 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,180 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,181 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,181 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,182 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,183 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,183 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,184 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,184 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,185 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,186 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,186 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,187 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,187 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,188 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,188 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,189 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,189 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,190 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,190 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,192 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,192 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,193 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,193 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,194 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,194 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,195 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,195 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,196 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,197 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,197 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,198 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,199 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,199 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,200 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,201 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,201 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,202 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,202 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,203 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,203 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,204 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,204 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,205 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,206 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,206 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,207 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 22:55:11,208 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-02 22:55:11,209 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 22:55:11,214 - main - INFO - 超参数优化完成
2025-11-02 22:55:11,214 - main - INFO - 开始训练专家模型...
2025-11-02 22:55:11,214 - main - INFO - 创建PatchTST模型...
2025-11-02 22:55:11,252 - main - INFO - 创建NHITS模型...
2025-11-02 22:55:11,339 - main - INFO - 训练PatchTST...
2025-11-02 22:55:11,498 - __main__ - ERROR - 实验失败: 'PatchTSTTrainer' object has no attribute 'config'
2025-11-02 23:02:45,733 - __main__ - INFO - 初始化实验...
2025-11-02 23:02:45,742 - main - INFO - 使用设备: cuda
2025-11-02 23:02:45,743 - __main__ - INFO - 开始完整实验...
2025-11-02 23:02:45,744 - main - INFO - 开始完整实验流程...
2025-11-02 23:02:45,744 - main - INFO - 开始数据加载和预处理...
2025-11-02 23:02:45,752 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 23:02:47,825 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 23:02:47,828 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 23:02:47,832 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 23:02:47,834 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 23:02:47,839 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 23:02:47,839 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 23:02:47,939 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 23:02:47,939 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 23:02:47,939 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 23:02:47,939 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 23:02:47,940 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 23:02:48,029 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 23:02:48,029 - main - INFO - 数据预处理完成:
2025-11-02 23:02:48,029 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 23:02:48,029 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 23:02:48,030 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 23:02:48,030 - main - INFO - 开始专家模型超参数优化...
2025-11-02 23:02:48,038 - main - INFO - 优化PatchTST超参数...
2025-11-02 23:02:48,056 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,056 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,057 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,058 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,058 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,059 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,060 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,061 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,061 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,062 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,063 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,063 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,064 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,065 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,066 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,066 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,067 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,067 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,067 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,068 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,068 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,069 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,069 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,070 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,071 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,071 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,072 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,073 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,073 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,075 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,076 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,076 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,076 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,077 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,077 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,078 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,079 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,079 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,080 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,080 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,081 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,081 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,083 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,084 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,084 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,085 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,086 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,086 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,087 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,087 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:02:48,088 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-02 23:02:48,088 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 23:02:48,093 - main - INFO - 优化NHITS超参数...
2025-11-02 23:02:48,103 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,104 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,105 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,105 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,106 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,106 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,107 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,109 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,110 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,110 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,111 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,112 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,112 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,113 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,114 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,114 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,119 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,119 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,121 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,121 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,122 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,122 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,123 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,125 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,125 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,125 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,127 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,127 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,128 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,129 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,129 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,130 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,131 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,131 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,132 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,132 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,133 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,133 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:02:48,134 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-02 23:02:48,134 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 23:02:48,139 - main - INFO - 超参数优化完成
2025-11-02 23:02:48,139 - main - INFO - 开始训练专家模型...
2025-11-02 23:02:48,139 - main - INFO - 创建PatchTST模型...
2025-11-02 23:02:48,150 - main - INFO - 创建NHITS模型...
2025-11-02 23:02:48,220 - main - INFO - 训练PatchTST...
2025-11-02 23:02:48,319 - __main__ - ERROR - 实验失败: name 'config' is not defined
2025-11-02 23:04:19,962 - __main__ - INFO - 初始化实验...
2025-11-02 23:04:19,971 - main - INFO - 使用设备: cuda
2025-11-02 23:04:19,972 - __main__ - INFO - 开始完整实验...
2025-11-02 23:04:19,972 - main - INFO - 开始完整实验流程...
2025-11-02 23:04:19,973 - main - INFO - 开始数据加载和预处理...
2025-11-02 23:04:19,981 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 23:04:22,095 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 23:04:22,098 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 23:04:22,100 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 23:04:22,103 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 23:04:22,109 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 23:04:22,109 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 23:04:22,182 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 23:04:22,182 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 23:04:22,183 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 23:04:22,183 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 23:04:22,183 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 23:04:22,273 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 23:04:22,273 - main - INFO - 数据预处理完成:
2025-11-02 23:04:22,273 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 23:04:22,273 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 23:04:22,273 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 23:04:22,274 - main - INFO - 开始专家模型超参数优化...
2025-11-02 23:04:22,283 - main - INFO - 优化PatchTST超参数...
2025-11-02 23:04:22,295 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,295 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,297 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,298 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,298 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,299 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,300 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,300 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,301 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,302 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,302 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,303 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,303 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,304 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,304 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,305 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,305 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,307 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,307 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,308 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,308 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,309 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,309 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,310 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,311 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,311 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,312 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,313 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,313 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,314 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,315 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,315 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,317 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,317 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,318 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,319 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,320 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,321 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,321 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,322 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,323 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,324 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,324 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,325 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,326 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,326 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,327 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,327 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:04:22,329 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-02 23:04:22,329 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 23:04:22,333 - main - INFO - 优化NHITS超参数...
2025-11-02 23:04:22,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,345 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,346 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,347 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,348 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,348 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,349 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,350 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,350 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,351 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,352 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,353 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,353 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,354 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,355 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,356 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,357 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,357 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,358 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,359 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,359 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,360 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,361 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,361 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,362 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,364 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,364 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,366 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,367 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,367 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,371 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,371 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,374 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,374 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,376 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:04:22,376 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-02 23:04:22,376 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 23:04:22,381 - main - INFO - 超参数优化完成
2025-11-02 23:04:22,381 - main - INFO - 开始训练专家模型...
2025-11-02 23:04:22,381 - main - INFO - 创建PatchTST模型...
2025-11-02 23:04:22,396 - main - INFO - 创建NHITS模型...
2025-11-02 23:04:22,457 - main - INFO - 训练PatchTST...
2025-11-02 23:04:22,582 - __main__ - ERROR - 实验失败: name 'config' is not defined
2025-11-02 23:08:26,637 - __main__ - INFO - 初始化实验...
2025-11-02 23:08:26,645 - main - INFO - 使用设备: cuda
2025-11-02 23:08:26,646 - __main__ - INFO - 开始完整实验...
2025-11-02 23:08:26,648 - main - INFO - 开始完整实验流程...
2025-11-02 23:08:26,648 - main - INFO - 开始数据加载和预处理...
2025-11-02 23:08:26,655 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-02 23:08:28,748 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-02 23:08:28,752 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 23:08:28,754 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-02 23:08:28,755 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-02 23:08:28,763 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-02 23:08:28,763 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-02 23:08:28,834 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-02 23:08:28,834 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-02 23:08:28,834 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-02 23:08:28,835 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-02 23:08:28,835 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-02 23:08:28,922 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-02 23:08:28,922 - main - INFO - 数据预处理完成:
2025-11-02 23:08:28,923 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-02 23:08:28,923 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-02 23:08:28,923 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-02 23:08:28,923 - main - INFO - 开始专家模型超参数优化...
2025-11-02 23:08:28,932 - main - INFO - 优化PatchTST超参数...
2025-11-02 23:08:28,947 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,948 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,949 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,950 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,950 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,952 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,952 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,953 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,954 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,955 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,955 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,957 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,957 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,958 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,959 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,959 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,960 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,961 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,961 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,962 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,963 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,964 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,965 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,965 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,965 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,966 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,967 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,968 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,968 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,969 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,969 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,970 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,971 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,971 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,972 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,973 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,973 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,974 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,975 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,975 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,976 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,977 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,978 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,978 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,979 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,980 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,981 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,981 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,982 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,983 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-02 23:08:28,983 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-02 23:08:28,983 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 23:08:28,987 - main - INFO - 优化NHITS超参数...
2025-11-02 23:08:28,997 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:28,998 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:28,999 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,000 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,000 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,001 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,001 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,002 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,003 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,003 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,004 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,005 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,005 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,006 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,008 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,008 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,009 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,009 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,010 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,011 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,011 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,012 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,013 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,014 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,014 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,015 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,015 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,016 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,017 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,017 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,017 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,018 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,018 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,019 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,019 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,020 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,021 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,021 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,022 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,022 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,023 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,023 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,024 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,024 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,025 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,025 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,025 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,027 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,028 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,028 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-02 23:08:29,029 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-02 23:08:29,029 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-02 23:08:29,033 - main - INFO - 超参数优化完成
2025-11-02 23:08:29,033 - main - INFO - 开始训练专家模型...
2025-11-02 23:08:29,033 - main - INFO - 创建PatchTST模型...
2025-11-02 23:08:29,043 - main - INFO - 创建NHITS模型...
2025-11-02 23:08:29,114 - main - INFO - 训练PatchTST...
2025-11-02 23:08:39,574 - models.patchtst - INFO - Epoch   1 | train_loss=0.928199 | val_loss=1.327937
2025-11-02 23:08:46,488 - models.patchtst - INFO - Epoch   2 | train_loss=0.923858 | val_loss=1.328066
2025-11-02 23:08:53,423 - models.patchtst - INFO - Epoch   3 | train_loss=0.924036 | val_loss=1.327803
2025-11-02 23:09:00,459 - models.patchtst - INFO - Epoch   4 | train_loss=0.924026 | val_loss=1.327844
2025-11-02 23:09:07,451 - models.patchtst - INFO - Epoch   5 | train_loss=0.923904 | val_loss=1.327961
2025-11-02 23:09:14,518 - models.patchtst - INFO - Epoch   6 | train_loss=0.923998 | val_loss=1.327750
2025-11-02 23:09:21,582 - models.patchtst - INFO - Epoch   7 | train_loss=0.923978 | val_loss=1.327641
2025-11-02 23:09:28,636 - models.patchtst - INFO - Epoch   8 | train_loss=0.923884 | val_loss=1.327751
2025-11-02 23:09:35,689 - models.patchtst - INFO - Epoch   9 | train_loss=0.923968 | val_loss=1.327749
2025-11-02 23:09:42,781 - models.patchtst - INFO - Epoch  10 | train_loss=0.923909 | val_loss=1.327631
2025-11-02 23:09:49,813 - models.patchtst - INFO - Epoch  11 | train_loss=0.923988 | val_loss=1.327726
2025-11-02 23:09:56,853 - models.patchtst - INFO - Epoch  12 | train_loss=0.924120 | val_loss=1.327612
2025-11-02 23:10:03,939 - models.patchtst - INFO - Epoch  13 | train_loss=0.923970 | val_loss=1.327975
2025-11-02 23:10:11,038 - models.patchtst - INFO - Epoch  14 | train_loss=0.924015 | val_loss=1.327770
2025-11-02 23:10:18,112 - models.patchtst - INFO - Epoch  15 | train_loss=0.924235 | val_loss=1.327917
2025-11-02 23:10:25,208 - models.patchtst - INFO - Epoch  16 | train_loss=0.923948 | val_loss=1.327710
2025-11-02 23:10:32,292 - models.patchtst - INFO - Epoch  17 | train_loss=0.923990 | val_loss=1.327753
2025-11-02 23:10:39,394 - models.patchtst - INFO - Epoch  18 | train_loss=0.923935 | val_loss=1.327783
2025-11-02 23:10:46,424 - models.patchtst - INFO - Epoch  19 | train_loss=0.923892 | val_loss=1.327914
2025-11-02 23:10:53,503 - models.patchtst - INFO - Epoch  20 | train_loss=0.924046 | val_loss=1.327816
2025-11-02 23:11:00,575 - models.patchtst - INFO - Epoch  21 | train_loss=0.923882 | val_loss=1.327675
2025-11-02 23:11:07,598 - models.patchtst - INFO - Epoch  22 | train_loss=0.924043 | val_loss=1.327850
2025-11-02 23:11:14,631 - models.patchtst - INFO - Epoch  23 | train_loss=0.924045 | val_loss=1.327844
2025-11-02 23:11:21,663 - models.patchtst - INFO - Epoch  24 | train_loss=0.923900 | val_loss=1.327815
2025-11-02 23:11:28,685 - models.patchtst - INFO - Epoch  25 | train_loss=0.923934 | val_loss=1.327673
2025-11-02 23:11:35,763 - models.patchtst - INFO - Epoch  26 | train_loss=0.923929 | val_loss=1.327724
2025-11-02 23:11:42,808 - models.patchtst - INFO - Epoch  27 | train_loss=0.923882 | val_loss=1.327727
2025-11-02 23:11:42,808 - models.patchtst - INFO - Early stopping at epoch 27早停触发（连续15轮验证损失未下降），最佳验证损失：1.327612
2025-11-02 23:11:42,809 - main - INFO - 训练NHITS...
2025-11-02 23:11:50,674 - models.nhits - INFO - Epoch   1 | train_loss=282557052.462212 | val_loss=225.608013
2025-11-02 23:11:58,561 - models.nhits - INFO - Epoch   2 | train_loss=263.667556 | val_loss=6.418450
2025-11-02 23:12:06,468 - models.nhits - INFO - Epoch   3 | train_loss=6.377642 | val_loss=0.769613
2025-11-02 23:12:14,383 - models.nhits - INFO - Epoch   4 | train_loss=0.536595 | val_loss=0.351409
2025-11-02 23:12:22,292 - models.nhits - INFO - Epoch   5 | train_loss=0.257785 | val_loss=0.144207
2025-11-02 23:12:30,190 - models.nhits - INFO - Epoch   6 | train_loss=0.118293 | val_loss=0.095627
2025-11-02 23:12:38,101 - models.nhits - INFO - Epoch   7 | train_loss=0.097893 | val_loss=0.053755
2025-11-02 23:12:45,998 - models.nhits - INFO - Epoch   8 | train_loss=0.089296 | val_loss=0.123609
2025-11-02 23:12:53,875 - models.nhits - INFO - Epoch   9 | train_loss=0.055222 | val_loss=0.068930
2025-11-02 23:13:02,158 - models.nhits - INFO - Epoch  10 | train_loss=0.054391 | val_loss=0.088477
2025-11-02 23:13:10,334 - models.nhits - INFO - Epoch  11 | train_loss=0.051731 | val_loss=0.059594
2025-11-02 23:13:18,543 - models.nhits - INFO - Epoch  12 | train_loss=0.046515 | val_loss=0.045613
2025-11-02 23:13:26,718 - models.nhits - INFO - Epoch  13 | train_loss=0.046785 | val_loss=0.042956
2025-11-02 23:13:34,848 - models.nhits - INFO - Epoch  14 | train_loss=0.040800 | val_loss=0.062569
2025-11-02 23:13:43,134 - models.nhits - INFO - Epoch  15 | train_loss=0.044272 | val_loss=0.114832
2025-11-02 23:13:51,334 - models.nhits - INFO - Epoch  16 | train_loss=0.049357 | val_loss=0.047282
2025-11-02 23:13:59,502 - models.nhits - INFO - Epoch  17 | train_loss=0.041003 | val_loss=0.053021
2025-11-02 23:14:07,499 - models.nhits - INFO - Epoch  18 | train_loss=0.040259 | val_loss=0.046130
2025-11-02 23:14:15,400 - models.nhits - INFO - Epoch  19 | train_loss=0.530260 | val_loss=0.952387
2025-11-02 23:14:23,258 - models.nhits - INFO - Epoch  20 | train_loss=0.067493 | val_loss=0.040831
2025-11-02 23:14:31,193 - models.nhits - INFO - Epoch  21 | train_loss=0.037042 | val_loss=0.053117
2025-11-02 23:14:39,080 - models.nhits - INFO - Epoch  22 | train_loss=0.036146 | val_loss=0.053775
2025-11-02 23:14:46,992 - models.nhits - INFO - Epoch  23 | train_loss=0.037952 | val_loss=0.042387
2025-11-02 23:14:54,862 - models.nhits - INFO - Epoch  24 | train_loss=0.033680 | val_loss=0.047755
2025-11-02 23:15:02,747 - models.nhits - INFO - Epoch  25 | train_loss=0.745029 | val_loss=0.040190
2025-11-02 23:15:10,643 - models.nhits - INFO - Epoch  26 | train_loss=0.044791 | val_loss=0.036713
2025-11-02 23:15:18,548 - models.nhits - INFO - Epoch  27 | train_loss=0.035664 | val_loss=0.065269
2025-11-02 23:15:26,460 - models.nhits - INFO - Epoch  28 | train_loss=0.036392 | val_loss=0.043470
2025-11-02 23:15:34,387 - models.nhits - INFO - Epoch  29 | train_loss=0.040517 | val_loss=0.040307
2025-11-02 23:15:42,317 - models.nhits - INFO - Epoch  30 | train_loss=0.127271 | val_loss=0.040251
2025-11-02 23:15:50,217 - models.nhits - INFO - Epoch  31 | train_loss=0.032712 | val_loss=0.042142
2025-11-02 23:15:58,145 - models.nhits - INFO - Epoch  32 | train_loss=0.033151 | val_loss=0.043046
2025-11-02 23:16:06,039 - models.nhits - INFO - Epoch  33 | train_loss=0.032246 | val_loss=0.042274
2025-11-02 23:16:13,952 - models.nhits - INFO - Epoch  34 | train_loss=0.055856 | val_loss=0.041785
2025-11-02 23:16:21,852 - models.nhits - INFO - Epoch  35 | train_loss=0.180677 | val_loss=1.152771
2025-11-02 23:16:29,763 - models.nhits - INFO - Epoch  36 | train_loss=1.183959 | val_loss=0.054823
2025-11-02 23:16:37,652 - models.nhits - INFO - Epoch  37 | train_loss=0.031797 | val_loss=0.036306
2025-11-02 23:16:45,559 - models.nhits - INFO - Epoch  38 | train_loss=0.030329 | val_loss=0.047156
2025-11-02 23:16:53,542 - models.nhits - INFO - Epoch  39 | train_loss=0.078665 | val_loss=0.053061
2025-11-02 23:17:01,517 - models.nhits - INFO - Epoch  40 | train_loss=0.068566 | val_loss=0.046384
2025-11-02 23:17:09,473 - models.nhits - INFO - Epoch  41 | train_loss=0.029744 | val_loss=0.036015
2025-11-02 23:17:17,454 - models.nhits - INFO - Epoch  42 | train_loss=0.034180 | val_loss=0.039389
2025-11-02 23:17:25,467 - models.nhits - INFO - Epoch  43 | train_loss=0.029876 | val_loss=0.044168
2025-11-02 23:17:33,468 - models.nhits - INFO - Epoch  44 | train_loss=0.032848 | val_loss=0.045245
2025-11-02 23:17:41,437 - models.nhits - INFO - Epoch  45 | train_loss=0.029531 | val_loss=0.036735
2025-11-02 23:17:49,409 - models.nhits - INFO - Epoch  46 | train_loss=0.028417 | val_loss=2.115875
2025-11-02 23:17:57,358 - models.nhits - INFO - Epoch  47 | train_loss=51.244608 | val_loss=0.038894
2025-11-02 23:18:05,646 - models.nhits - INFO - Epoch  48 | train_loss=0.029226 | val_loss=0.029758
2025-11-02 23:18:14,376 - models.nhits - INFO - Epoch  49 | train_loss=0.028687 | val_loss=0.039022
2025-11-02 23:18:22,581 - models.nhits - INFO - Epoch  50 | train_loss=0.033957 | val_loss=0.034581
2025-11-02 23:18:30,759 - models.nhits - INFO - Epoch  51 | train_loss=0.079249 | val_loss=0.068205
2025-11-02 23:18:38,971 - models.nhits - INFO - Epoch  52 | train_loss=0.031017 | val_loss=0.041729
2025-11-02 23:18:47,293 - models.nhits - INFO - Epoch  53 | train_loss=0.028205 | val_loss=0.043395
2025-11-02 23:18:55,563 - models.nhits - INFO - Epoch  54 | train_loss=0.029195 | val_loss=0.050117
2025-11-02 23:19:03,791 - models.nhits - INFO - Epoch  55 | train_loss=0.027697 | val_loss=0.034541
2025-11-02 23:19:12,038 - models.nhits - INFO - Epoch  56 | train_loss=0.352677 | val_loss=0.041234
2025-11-02 23:19:20,210 - models.nhits - INFO - Epoch  57 | train_loss=0.026957 | val_loss=0.045210
2025-11-02 23:19:28,329 - models.nhits - INFO - Epoch  58 | train_loss=0.034699 | val_loss=0.050456
2025-11-02 23:19:36,508 - models.nhits - INFO - Epoch  59 | train_loss=0.028551 | val_loss=0.034639
2025-11-02 23:19:44,639 - models.nhits - INFO - Epoch  60 | train_loss=0.053859 | val_loss=0.033405
2025-11-02 23:19:52,666 - models.nhits - INFO - Epoch  61 | train_loss=0.028710 | val_loss=0.033794
2025-11-02 23:20:00,764 - models.nhits - INFO - Epoch  62 | train_loss=0.029930 | val_loss=0.034166
2025-11-02 23:20:08,900 - models.nhits - INFO - Epoch  63 | train_loss=0.256429 | val_loss=0.036925
2025-11-02 23:20:08,900 - models.nhits - INFO - Early stopping at epoch 63早停触发（连续15轮验证损失未下降），最佳验证损失：0.029758
2025-11-02 23:20:08,921 - models.patchtst - INFO - 模型已保存到: results\experiment_20251102_230826/patchtst_model.pth
2025-11-02 23:20:08,948 - models.nhits - INFO - 模型已保存到: results\experiment_20251102_230826/nhits_model.pth
2025-11-02 23:20:08,948 - main - INFO - 专家模型训练完成
2025-11-02 23:20:08,951 - main - INFO - 获取专家模型预测...
2025-11-02 23:20:22,094 - main - INFO - 专家预测获取完成
2025-11-02 23:20:22,095 - main - INFO - 实现策略A：静态优化权重...
2025-11-02 23:20:22,827 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-11-02 23:20:22,834 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.192352
2025-11-02 23:20:22,838 - src.strategies.mpa_optimizer - INFO - 在第 14 代收敛
2025-11-02 23:20:28,894 - main - INFO - 策略A完成 - 最优权重: [0. 1.], 验证集RMSE: 0.192352
2025-11-02 23:20:28,894 - main - INFO - 实现策略B：广义线性融合...
2025-11-02 23:20:29,556 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = 2.196919
2025-11-02 23:20:29,618 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.841627
2025-11-02 23:20:29,654 - src.strategies.mpa_optimizer - INFO - 在第 16 代收敛
2025-11-02 23:20:35,633 - main - INFO - 策略B完成 - 最优系数: [ 0.83879389 -4.81082517  0.96422242], 验证集RMSE: 0.841627
2025-11-02 23:20:35,633 - main - INFO - 实现策略C：动态门控网络...
2025-11-02 23:20:35,841 - __main__ - ERROR - 实验失败: 'NoneType' object is not subscriptable
2025-11-03 09:48:02,716 - __main__ - INFO - 初始化实验...
2025-11-03 09:48:02,729 - main - INFO - 使用设备: cuda
2025-11-03 09:48:02,731 - __main__ - INFO - 开始完整实验...
2025-11-03 09:48:02,731 - main - INFO - 开始完整实验流程...
2025-11-03 09:48:02,731 - main - INFO - 开始数据加载和预处理...
2025-11-03 09:48:02,743 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-03 09:48:05,034 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-03 09:48:05,037 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-03 09:48:05,041 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-03 09:48:05,042 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-03 09:48:05,050 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-03 09:48:05,050 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-03 09:48:05,121 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-03 09:48:05,121 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-03 09:48:05,121 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-03 09:48:05,123 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-03 09:48:05,123 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-03 09:48:05,200 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-03 09:48:05,200 - main - INFO - 数据预处理完成:
2025-11-03 09:48:05,200 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-03 09:48:05,200 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-03 09:48:05,200 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-03 09:48:05,200 - main - INFO - 开始专家模型超参数优化...
2025-11-03 09:48:05,208 - main - INFO - 优化PatchTST超参数...
2025-11-03 09:48:05,232 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,233 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,233 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,234 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,235 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,235 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,236 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,237 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,237 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,238 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,239 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,239 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,240 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,242 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,243 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,243 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,244 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,245 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,245 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,246 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,247 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,247 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,248 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,248 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,249 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,249 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,250 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,251 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,251 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,252 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,252 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,253 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,253 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,254 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,254 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,255 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,255 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,256 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,256 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,257 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,257 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,258 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,258 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,259 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,260 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,260 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,260 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,262 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,262 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,263 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 09:48:05,263 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-03 09:48:05,263 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-03 09:48:05,267 - main - INFO - 优化NHITS超参数...
2025-11-03 09:48:05,278 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,279 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,279 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,280 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,280 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,281 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,281 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,283 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,283 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,284 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,284 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,285 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,285 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,286 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,287 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,287 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,288 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,288 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,289 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,290 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,290 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,291 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,291 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,293 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,293 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,294 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,295 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,295 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,296 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,296 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,297 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,297 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,297 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,298 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,298 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,299 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,299 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,300 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,301 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,301 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,301 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,303 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,303 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,304 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,305 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,305 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,306 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,306 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,307 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,308 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 09:48:05,308 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-03 09:48:05,308 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-03 09:48:05,314 - main - INFO - 超参数优化完成
2025-11-03 09:48:05,314 - main - INFO - 开始训练专家模型...
2025-11-03 09:48:05,315 - main - INFO - 创建PatchTST模型...
2025-11-03 09:48:05,353 - main - INFO - 创建NHITS模型...
2025-11-03 09:48:05,429 - main - INFO - 训练PatchTST...
2025-11-03 09:48:16,824 - models.patchtst - INFO - Epoch   1 | train_loss=0.928972 | val_loss=1.327690
2025-11-03 09:48:23,838 - models.patchtst - INFO - Epoch   2 | train_loss=0.924027 | val_loss=1.327688
2025-11-03 09:48:31,188 - models.patchtst - INFO - Epoch   3 | train_loss=0.923961 | val_loss=1.327740
2025-11-03 09:48:38,431 - models.patchtst - INFO - Epoch   4 | train_loss=0.923971 | val_loss=1.327664
2025-11-03 09:48:45,636 - models.patchtst - INFO - Epoch   5 | train_loss=0.924017 | val_loss=1.327654
2025-11-03 09:48:52,887 - models.patchtst - INFO - Epoch   6 | train_loss=0.923962 | val_loss=1.327783
2025-11-03 09:49:00,167 - models.patchtst - INFO - Epoch   7 | train_loss=0.923978 | val_loss=1.327765
2025-11-03 09:49:07,364 - models.patchtst - INFO - Epoch   8 | train_loss=0.924397 | val_loss=1.327844
2025-11-03 09:49:14,580 - models.patchtst - INFO - Epoch   9 | train_loss=0.923948 | val_loss=1.327656
2025-11-03 09:49:21,895 - models.patchtst - INFO - Epoch  10 | train_loss=0.923939 | val_loss=1.328020
2025-11-03 09:49:29,275 - models.patchtst - INFO - Epoch  11 | train_loss=0.923986 | val_loss=1.327703
2025-11-03 09:49:36,458 - models.patchtst - INFO - Epoch  12 | train_loss=0.923909 | val_loss=1.327976
2025-11-03 09:49:43,773 - models.patchtst - INFO - Epoch  13 | train_loss=0.923978 | val_loss=1.327630
2025-11-03 09:49:51,060 - models.patchtst - INFO - Epoch  14 | train_loss=0.924000 | val_loss=1.328040
2025-11-03 09:49:58,252 - models.patchtst - INFO - Epoch  15 | train_loss=0.924032 | val_loss=1.327909
2025-11-03 09:50:05,508 - models.patchtst - INFO - Epoch  16 | train_loss=0.923883 | val_loss=1.327620
2025-11-03 09:50:12,733 - models.patchtst - INFO - Epoch  17 | train_loss=0.923964 | val_loss=1.327801
2025-11-03 09:50:19,949 - models.patchtst - INFO - Epoch  18 | train_loss=0.923946 | val_loss=1.327724
2025-11-03 09:50:27,113 - models.patchtst - INFO - Epoch  19 | train_loss=0.924007 | val_loss=1.327748
2025-11-03 09:50:34,315 - models.patchtst - INFO - Epoch  20 | train_loss=0.923862 | val_loss=1.327764
2025-11-03 09:50:41,547 - models.patchtst - INFO - Epoch  21 | train_loss=0.923971 | val_loss=1.327797
2025-11-03 09:50:48,721 - models.patchtst - INFO - Epoch  22 | train_loss=0.923948 | val_loss=1.327823
2025-11-03 09:50:55,945 - models.patchtst - INFO - Epoch  23 | train_loss=0.923919 | val_loss=1.327692
2025-11-03 09:51:03,121 - models.patchtst - INFO - Epoch  24 | train_loss=0.923902 | val_loss=1.327821
2025-11-03 09:51:10,310 - models.patchtst - INFO - Epoch  25 | train_loss=0.923987 | val_loss=1.327833
2025-11-03 09:51:17,897 - models.patchtst - INFO - Epoch  26 | train_loss=0.923960 | val_loss=1.327828
2025-11-03 09:51:25,004 - models.patchtst - INFO - Epoch  27 | train_loss=0.923883 | val_loss=1.327791
2025-11-03 09:51:32,266 - models.patchtst - INFO - Epoch  28 | train_loss=0.923912 | val_loss=1.327862
2025-11-03 09:51:39,518 - models.patchtst - INFO - Epoch  29 | train_loss=0.923953 | val_loss=1.327747
2025-11-03 09:51:46,806 - models.patchtst - INFO - Epoch  30 | train_loss=0.923921 | val_loss=1.327886
2025-11-03 09:51:54,191 - models.patchtst - INFO - Epoch  31 | train_loss=0.923882 | val_loss=1.327928
2025-11-03 09:51:54,191 - models.patchtst - INFO - Early stopping at epoch 31早停触发（连续15轮验证损失未下降），最佳验证损失：1.327620
2025-11-03 09:51:54,191 - main - INFO - 训练NHITS...
2025-11-03 09:52:02,595 - models.nhits - INFO - Epoch   1 | train_loss=311312440.926520 | val_loss=329.012095
2025-11-03 09:52:10,597 - models.nhits - INFO - Epoch   2 | train_loss=134.560448 | val_loss=9.106983
2025-11-03 09:52:18,728 - models.nhits - INFO - Epoch   3 | train_loss=3.124761 | val_loss=0.621064
2025-11-03 09:52:26,871 - models.nhits - INFO - Epoch   4 | train_loss=0.887016 | val_loss=0.257872
2025-11-03 09:52:35,025 - models.nhits - INFO - Epoch   5 | train_loss=0.221991 | val_loss=0.167057
2025-11-03 09:52:43,237 - models.nhits - INFO - Epoch   6 | train_loss=0.098558 | val_loss=0.105645
2025-11-03 09:52:51,403 - models.nhits - INFO - Epoch   7 | train_loss=0.115765 | val_loss=0.086567
2025-11-03 09:52:59,532 - models.nhits - INFO - Epoch   8 | train_loss=0.058110 | val_loss=0.101950
2025-11-03 09:53:07,838 - models.nhits - INFO - Epoch   9 | train_loss=0.059830 | val_loss=0.067868
2025-11-03 09:53:15,989 - models.nhits - INFO - Epoch  10 | train_loss=0.049340 | val_loss=0.051398
2025-11-03 09:53:24,178 - models.nhits - INFO - Epoch  11 | train_loss=0.056375 | val_loss=0.049194
2025-11-03 09:53:32,071 - models.nhits - INFO - Epoch  12 | train_loss=0.044087 | val_loss=0.048135
2025-11-03 09:53:39,836 - models.nhits - INFO - Epoch  13 | train_loss=0.044384 | val_loss=0.047299
2025-11-03 09:53:47,618 - models.nhits - INFO - Epoch  14 | train_loss=0.043355 | val_loss=0.070240
2025-11-03 09:53:55,412 - models.nhits - INFO - Epoch  15 | train_loss=0.046590 | val_loss=0.054437
2025-11-03 09:54:03,267 - models.nhits - INFO - Epoch  16 | train_loss=1.200542 | val_loss=0.047421
2025-11-03 09:54:11,071 - models.nhits - INFO - Epoch  17 | train_loss=0.039134 | val_loss=0.051015
2025-11-03 09:54:18,875 - models.nhits - INFO - Epoch  18 | train_loss=0.038817 | val_loss=0.044323
2025-11-03 09:54:26,903 - models.nhits - INFO - Epoch  19 | train_loss=0.087229 | val_loss=0.046011
2025-11-03 09:54:35,337 - models.nhits - INFO - Epoch  20 | train_loss=0.035824 | val_loss=0.051636
2025-11-03 09:54:44,069 - models.nhits - INFO - Epoch  21 | train_loss=0.046673 | val_loss=0.041652
2025-11-03 09:54:52,817 - models.nhits - INFO - Epoch  22 | train_loss=0.037451 | val_loss=0.046796
2025-11-03 09:55:01,107 - models.nhits - INFO - Epoch  23 | train_loss=0.033980 | val_loss=0.038415
2025-11-03 09:55:09,589 - models.nhits - INFO - Epoch  24 | train_loss=0.035817 | val_loss=0.046061
2025-11-03 09:55:17,997 - models.nhits - INFO - Epoch  25 | train_loss=0.034918 | val_loss=0.044071
2025-11-03 09:55:26,081 - models.nhits - INFO - Epoch  26 | train_loss=0.423747 | val_loss=0.074713
2025-11-03 09:55:34,194 - models.nhits - INFO - Epoch  27 | train_loss=0.127971 | val_loss=0.045036
2025-11-03 09:55:42,279 - models.nhits - INFO - Epoch  28 | train_loss=0.034252 | val_loss=0.042531
2025-11-03 09:55:50,435 - models.nhits - INFO - Epoch  29 | train_loss=0.033321 | val_loss=0.046083
2025-11-03 09:55:58,632 - models.nhits - INFO - Epoch  30 | train_loss=0.034220 | val_loss=0.085906
2025-11-03 09:56:06,797 - models.nhits - INFO - Epoch  31 | train_loss=0.048490 | val_loss=0.042599
2025-11-03 09:56:14,941 - models.nhits - INFO - Epoch  32 | train_loss=0.081733 | val_loss=0.047768
2025-11-03 09:56:23,172 - models.nhits - INFO - Epoch  33 | train_loss=0.033377 | val_loss=0.039457
2025-11-03 09:56:31,619 - models.nhits - INFO - Epoch  34 | train_loss=0.030667 | val_loss=0.036469
2025-11-03 09:56:39,730 - models.nhits - INFO - Epoch  35 | train_loss=0.033647 | val_loss=0.039306
2025-11-03 09:56:47,796 - models.nhits - INFO - Epoch  36 | train_loss=0.054842 | val_loss=0.039340
2025-11-03 09:56:56,253 - models.nhits - INFO - Epoch  37 | train_loss=0.031985 | val_loss=0.041649
2025-11-03 09:57:04,773 - models.nhits - INFO - Epoch  38 | train_loss=0.030210 | val_loss=0.051876
2025-11-03 09:57:13,199 - models.nhits - INFO - Epoch  39 | train_loss=0.029172 | val_loss=0.038960
2025-11-03 09:57:21,406 - models.nhits - INFO - Epoch  40 | train_loss=1.493181 | val_loss=0.040837
2025-11-03 09:57:29,554 - models.nhits - INFO - Epoch  41 | train_loss=0.054472 | val_loss=0.048302
2025-11-03 09:57:37,690 - models.nhits - INFO - Epoch  42 | train_loss=0.028110 | val_loss=0.039855
2025-11-03 09:57:45,798 - models.nhits - INFO - Epoch  43 | train_loss=0.106271 | val_loss=0.035976
2025-11-03 09:57:53,913 - models.nhits - INFO - Epoch  44 | train_loss=0.028015 | val_loss=0.037276
2025-11-03 09:58:02,114 - models.nhits - INFO - Epoch  45 | train_loss=0.028047 | val_loss=0.033879
2025-11-03 09:58:10,332 - models.nhits - INFO - Epoch  46 | train_loss=0.027595 | val_loss=0.040775
2025-11-03 09:58:18,529 - models.nhits - INFO - Epoch  47 | train_loss=0.036312 | val_loss=0.045260
2025-11-03 09:58:26,738 - models.nhits - INFO - Epoch  48 | train_loss=0.528698 | val_loss=0.061246
2025-11-03 09:58:35,102 - models.nhits - INFO - Epoch  49 | train_loss=0.136873 | val_loss=0.035921
2025-11-03 09:58:43,205 - models.nhits - INFO - Epoch  50 | train_loss=0.076371 | val_loss=0.036067
2025-11-03 09:58:51,396 - models.nhits - INFO - Epoch  51 | train_loss=0.029271 | val_loss=0.033723
2025-11-03 09:58:59,597 - models.nhits - INFO - Epoch  52 | train_loss=0.027151 | val_loss=0.036583
2025-11-03 09:59:07,802 - models.nhits - INFO - Epoch  53 | train_loss=0.029280 | val_loss=0.041021
2025-11-03 09:59:15,965 - models.nhits - INFO - Epoch  54 | train_loss=0.031232 | val_loss=0.037755
2025-11-03 09:59:24,179 - models.nhits - INFO - Epoch  55 | train_loss=0.027808 | val_loss=0.040575
2025-11-03 09:59:32,376 - models.nhits - INFO - Epoch  56 | train_loss=0.125538 | val_loss=0.035055
2025-11-03 09:59:40,568 - models.nhits - INFO - Epoch  57 | train_loss=0.027008 | val_loss=0.033174
2025-11-03 09:59:48,771 - models.nhits - INFO - Epoch  58 | train_loss=0.177779 | val_loss=0.046593
2025-11-03 09:59:56,940 - models.nhits - INFO - Epoch  59 | train_loss=0.026863 | val_loss=0.035070
2025-11-03 10:00:05,093 - models.nhits - INFO - Epoch  60 | train_loss=0.282457 | val_loss=0.038690
2025-11-03 10:00:13,268 - models.nhits - INFO - Epoch  61 | train_loss=0.028434 | val_loss=0.037150
2025-11-03 10:00:21,398 - models.nhits - INFO - Epoch  62 | train_loss=0.026898 | val_loss=0.033463
2025-11-03 10:00:29,572 - models.nhits - INFO - Epoch  63 | train_loss=0.226826 | val_loss=0.032842
2025-11-03 10:00:37,773 - models.nhits - INFO - Epoch  64 | train_loss=0.029484 | val_loss=0.045156
2025-11-03 10:00:45,938 - models.nhits - INFO - Epoch  65 | train_loss=0.027092 | val_loss=0.037369
2025-11-03 10:00:54,142 - models.nhits - INFO - Epoch  66 | train_loss=10.636323 | val_loss=1.112727
2025-11-03 10:01:02,485 - models.nhits - INFO - Epoch  67 | train_loss=7618.037724 | val_loss=0.035033
2025-11-03 10:01:10,654 - models.nhits - INFO - Epoch  68 | train_loss=0.025892 | val_loss=0.040042
2025-11-03 10:01:18,977 - models.nhits - INFO - Epoch  69 | train_loss=0.025732 | val_loss=0.035275
2025-11-03 10:01:27,309 - models.nhits - INFO - Epoch  70 | train_loss=0.034781 | val_loss=0.056123
2025-11-03 10:01:35,490 - models.nhits - INFO - Epoch  71 | train_loss=0.026455 | val_loss=0.038033
2025-11-03 10:01:43,728 - models.nhits - INFO - Epoch  72 | train_loss=0.026089 | val_loss=0.033789
2025-11-03 10:01:52,376 - models.nhits - INFO - Epoch  73 | train_loss=0.025980 | val_loss=0.041760
2025-11-03 10:02:00,436 - models.nhits - INFO - Epoch  74 | train_loss=0.028246 | val_loss=0.033079
2025-11-03 10:02:08,367 - models.nhits - INFO - Epoch  75 | train_loss=0.479895 | val_loss=0.041247
2025-11-03 10:02:16,235 - models.nhits - INFO - Epoch  76 | train_loss=0.029509 | val_loss=0.039056
2025-11-03 10:02:24,140 - models.nhits - INFO - Epoch  77 | train_loss=0.025273 | val_loss=0.044799
2025-11-03 10:02:32,049 - models.nhits - INFO - Epoch  78 | train_loss=0.026745 | val_loss=0.044568
2025-11-03 10:02:32,050 - models.nhits - INFO - Early stopping at epoch 78早停触发（连续15轮验证损失未下降），最佳验证损失：0.032842
2025-11-03 10:02:32,067 - models.patchtst - INFO - 模型已保存到: results\experiment_20251103_094802/patchtst_model.pth
2025-11-03 10:02:32,095 - models.nhits - INFO - 模型已保存到: results\experiment_20251103_094802/nhits_model.pth
2025-11-03 10:02:32,096 - main - INFO - 专家模型训练完成
2025-11-03 10:02:32,099 - main - INFO - 获取专家模型预测...
2025-11-03 10:02:44,650 - main - INFO - 专家预测获取完成
2025-11-03 10:02:44,652 - main - INFO - 实现策略A：静态优化权重...
2025-11-03 10:02:45,334 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-11-03 10:02:45,342 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.211443
2025-11-03 10:02:45,349 - src.strategies.mpa_optimizer - INFO - 在第 20 代收敛
2025-11-03 10:02:50,966 - main - INFO - 策略A完成 - 最优权重: [0. 1.], 验证集RMSE: 0.211443
2025-11-03 10:02:50,966 - main - INFO - 实现策略B：广义线性融合...
2025-11-03 10:02:51,605 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = 0.411278
2025-11-03 10:02:51,668 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.411278
2025-11-03 10:02:51,674 - src.strategies.mpa_optimizer - INFO - 在第 11 代收敛
2025-11-03 10:02:57,304 - main - INFO - 策略B完成 - 最优系数: [-0.25597846  2.99339016  0.87450527], 验证集RMSE: 0.411278
2025-11-03 10:02:57,305 - main - INFO - 实现策略C：动态门控网络...
2025-11-03 10:02:57,512 - main - INFO - 训练动态门控网络...
2025-11-03 10:02:57,513 - __main__ - ERROR - 实验失败: 'DynamicFusionTrainer' object has no attribute 'train_model'
2025-11-03 10:13:19,992 - __main__ - INFO - 初始化实验...
2025-11-03 10:13:20,002 - main - INFO - 使用设备: cuda
2025-11-03 10:13:20,003 - __main__ - INFO - 开始完整实验...
2025-11-03 10:13:20,003 - main - INFO - 开始完整实验流程...
2025-11-03 10:13:20,003 - main - INFO - 开始数据加载和预处理...
2025-11-03 10:13:20,011 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-03 10:13:22,088 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-03 10:13:22,089 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-03 10:13:22,092 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-03 10:13:22,094 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-03 10:13:22,101 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-03 10:13:22,101 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-03 10:13:22,172 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-03 10:13:22,172 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-03 10:13:22,173 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-03 10:13:22,173 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-03 10:13:22,173 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-03 10:13:22,257 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-03 10:13:22,257 - main - INFO - 数据预处理完成:
2025-11-03 10:13:22,257 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-03 10:13:22,258 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-03 10:13:22,258 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-03 10:13:22,258 - main - INFO - 开始专家模型超参数优化...
2025-11-03 10:13:22,267 - main - INFO - 优化PatchTST超参数...
2025-11-03 10:13:22,278 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,279 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,279 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,279 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,281 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,282 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,282 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,283 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,284 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,284 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,286 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,286 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,287 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,288 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,288 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,290 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,290 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,291 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,291 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,292 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,293 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,294 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,294 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,296 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,296 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,297 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,298 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,299 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,299 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,300 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,300 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,301 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,301 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,303 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,304 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,304 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,305 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,305 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,306 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,306 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,308 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,308 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,309 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,310 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,311 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,311 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,312 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,313 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,313 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,314 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-11-03 10:13:22,314 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-11-03 10:13:22,314 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-03 10:13:22,318 - main - INFO - 优化NHITS超参数...
2025-11-03 10:13:22,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,329 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,330 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,330 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,332 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,334 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,334 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,337 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,339 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,339 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,340 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,340 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,342 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,342 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,345 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,345 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,346 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,347 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,347 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,348 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,348 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,349 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,350 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,350 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,351 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,351 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,352 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,353 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,353 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,354 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,355 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,356 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,356 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,357 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,358 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,358 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,360 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,360 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,361 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-11-03 10:13:22,361 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-11-03 10:13:22,361 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-11-03 10:13:22,366 - main - INFO - 超参数优化完成
2025-11-03 10:13:22,366 - main - INFO - 开始训练专家模型...
2025-11-03 10:13:22,366 - main - INFO - 创建PatchTST模型...
2025-11-03 10:13:22,377 - main - INFO - 创建NHITS模型...
2025-11-03 10:13:22,454 - main - INFO - 训练PatchTST...
2025-11-03 10:13:31,283 - models.patchtst - INFO - Epoch   1 | train_loss=0.928475 | val_loss=1.327926
2025-11-03 10:13:38,353 - models.patchtst - INFO - Epoch   2 | train_loss=0.923983 | val_loss=1.327754
2025-11-03 10:13:45,663 - models.patchtst - INFO - Epoch   3 | train_loss=0.923880 | val_loss=1.328048
2025-11-03 10:13:52,583 - models.patchtst - INFO - Epoch   4 | train_loss=0.923989 | val_loss=1.327771
2025-11-03 10:13:59,597 - models.patchtst - INFO - Epoch   5 | train_loss=0.923936 | val_loss=1.328016
2025-11-03 10:14:06,686 - models.patchtst - INFO - Epoch   6 | train_loss=0.924018 | val_loss=1.327773
2025-11-03 10:14:13,658 - models.patchtst - INFO - Epoch   7 | train_loss=0.924007 | val_loss=1.327823
2025-11-03 10:14:20,669 - models.patchtst - INFO - Epoch   8 | train_loss=0.923970 | val_loss=1.328069
2025-11-03 10:14:27,886 - models.patchtst - INFO - Epoch   9 | train_loss=0.924024 | val_loss=1.327661
2025-11-03 10:14:34,923 - models.patchtst - INFO - Epoch  10 | train_loss=0.924006 | val_loss=1.327751
2025-11-03 10:14:41,901 - models.patchtst - INFO - Epoch  11 | train_loss=0.924011 | val_loss=1.327702
2025-11-03 10:14:48,878 - models.patchtst - INFO - Epoch  12 | train_loss=0.923906 | val_loss=1.327848
2025-11-03 10:14:55,955 - models.patchtst - INFO - Epoch  13 | train_loss=0.924030 | val_loss=1.327668
2025-11-03 10:15:02,921 - models.patchtst - INFO - Epoch  14 | train_loss=0.923983 | val_loss=1.327835
2025-11-03 10:15:09,991 - models.patchtst - INFO - Epoch  15 | train_loss=0.923968 | val_loss=1.327740
2025-11-03 10:15:17,629 - models.patchtst - INFO - Epoch  16 | train_loss=0.923927 | val_loss=1.327893
2025-11-03 10:15:26,665 - models.patchtst - INFO - Epoch  17 | train_loss=0.923973 | val_loss=1.327999
2025-11-03 10:15:34,513 - models.patchtst - INFO - Epoch  18 | train_loss=0.923985 | val_loss=1.327807
2025-11-03 10:15:42,456 - models.patchtst - INFO - Epoch  19 | train_loss=0.924029 | val_loss=1.327745
2025-11-03 10:15:50,076 - models.patchtst - INFO - Epoch  20 | train_loss=0.923871 | val_loss=1.327738
2025-11-03 10:15:57,169 - models.patchtst - INFO - Epoch  21 | train_loss=0.923941 | val_loss=1.327736
2025-11-03 10:16:04,213 - models.patchtst - INFO - Epoch  22 | train_loss=0.923892 | val_loss=1.327653
2025-11-03 10:16:11,399 - models.patchtst - INFO - Epoch  23 | train_loss=0.924004 | val_loss=1.327762
2025-11-03 10:16:19,851 - models.patchtst - INFO - Epoch  24 | train_loss=0.923963 | val_loss=1.327708
2025-11-03 10:16:27,860 - models.patchtst - INFO - Epoch  25 | train_loss=0.923913 | val_loss=1.327789
2025-11-03 10:16:35,718 - models.patchtst - INFO - Epoch  26 | train_loss=0.924007 | val_loss=1.327861
2025-11-03 10:16:44,107 - models.patchtst - INFO - Epoch  27 | train_loss=0.923965 | val_loss=1.327845
2025-11-03 10:16:51,359 - models.patchtst - INFO - Epoch  28 | train_loss=0.923973 | val_loss=1.327833
2025-11-03 10:16:59,002 - models.patchtst - INFO - Epoch  29 | train_loss=0.923950 | val_loss=1.327804
2025-11-03 10:17:07,223 - models.patchtst - INFO - Epoch  30 | train_loss=0.923945 | val_loss=1.327768
2025-11-03 10:17:15,376 - models.patchtst - INFO - Epoch  31 | train_loss=0.923890 | val_loss=1.327898
2025-11-03 10:17:23,493 - models.patchtst - INFO - Epoch  32 | train_loss=0.923925 | val_loss=1.327865
2025-11-03 10:17:31,749 - models.patchtst - INFO - Epoch  33 | train_loss=0.923873 | val_loss=1.327807
2025-11-03 10:17:39,689 - models.patchtst - INFO - Epoch  34 | train_loss=0.923924 | val_loss=1.327772
2025-11-03 10:17:47,175 - models.patchtst - INFO - Epoch  35 | train_loss=0.923866 | val_loss=1.327736
2025-11-03 10:17:55,355 - models.patchtst - INFO - Epoch  36 | train_loss=0.923893 | val_loss=1.327780
2025-11-03 10:18:03,576 - models.patchtst - INFO - Epoch  37 | train_loss=0.923930 | val_loss=1.327796
2025-11-03 10:18:03,576 - models.patchtst - INFO - Early stopping at epoch 37早停触发（连续15轮验证损失未下降），最佳验证损失：1.327653
2025-11-03 10:18:03,576 - main - INFO - 训练NHITS...
2025-11-03 10:18:12,392 - models.nhits - INFO - Epoch   1 | train_loss=792501748.301937 | val_loss=1526.158451
2025-11-03 10:18:23,051 - models.nhits - INFO - Epoch   2 | train_loss=179.400305 | val_loss=17.137876
2025-11-03 10:18:31,923 - models.nhits - INFO - Epoch   3 | train_loss=3.879135 | val_loss=0.587536
2025-11-03 10:18:41,254 - models.nhits - INFO - Epoch   4 | train_loss=0.334203 | val_loss=0.271295
2025-11-03 10:18:50,777 - models.nhits - INFO - Epoch   5 | train_loss=0.544617 | val_loss=0.083061
2025-11-03 10:18:59,609 - models.nhits - INFO - Epoch   6 | train_loss=0.084370 | val_loss=0.093526
2025-11-03 10:19:09,168 - models.nhits - INFO - Epoch   7 | train_loss=0.063574 | val_loss=0.069289
2025-11-03 10:19:18,424 - models.nhits - INFO - Epoch   8 | train_loss=0.065763 | val_loss=0.069532
2025-11-03 10:19:28,119 - models.nhits - INFO - Epoch   9 | train_loss=0.053941 | val_loss=0.060698
2025-11-03 10:19:37,343 - models.nhits - INFO - Epoch  10 | train_loss=0.045972 | val_loss=0.075578
2025-11-03 10:19:46,013 - models.nhits - INFO - Epoch  11 | train_loss=0.047638 | val_loss=0.054161
2025-11-03 10:19:53,982 - models.nhits - INFO - Epoch  12 | train_loss=0.041889 | val_loss=0.053159
2025-11-03 10:20:01,949 - models.nhits - INFO - Epoch  13 | train_loss=0.067886 | val_loss=0.052706
2025-11-03 10:20:09,903 - models.nhits - INFO - Epoch  14 | train_loss=0.041256 | val_loss=0.049253
2025-11-03 10:20:17,949 - models.nhits - INFO - Epoch  15 | train_loss=0.048123 | val_loss=0.048661
2025-11-03 10:20:26,859 - models.nhits - INFO - Epoch  16 | train_loss=0.039797 | val_loss=0.045400
2025-11-03 10:20:36,505 - models.nhits - INFO - Epoch  17 | train_loss=0.038603 | val_loss=0.044838
2025-11-03 10:20:45,578 - models.nhits - INFO - Epoch  18 | train_loss=0.130201 | val_loss=0.058352
2025-11-03 10:20:55,212 - models.nhits - INFO - Epoch  19 | train_loss=0.040239 | val_loss=0.054266
2025-11-03 10:21:05,172 - models.nhits - INFO - Epoch  20 | train_loss=0.037485 | val_loss=0.045614
2025-11-03 10:21:15,481 - models.nhits - INFO - Epoch  21 | train_loss=0.035632 | val_loss=0.043476
2025-11-03 10:21:24,046 - models.nhits - INFO - Epoch  22 | train_loss=0.035437 | val_loss=0.064451
2025-11-03 10:21:32,632 - models.nhits - INFO - Epoch  23 | train_loss=0.059869 | val_loss=0.044050
2025-11-03 10:21:41,597 - models.nhits - INFO - Epoch  24 | train_loss=0.036281 | val_loss=0.048169
2025-11-03 10:21:50,196 - models.nhits - INFO - Epoch  25 | train_loss=0.040602 | val_loss=0.055389
2025-11-03 10:21:58,936 - models.nhits - INFO - Epoch  26 | train_loss=0.075516 | val_loss=0.055739
2025-11-03 10:22:07,613 - models.nhits - INFO - Epoch  27 | train_loss=0.033902 | val_loss=0.040104
2025-11-03 10:22:16,266 - models.nhits - INFO - Epoch  28 | train_loss=0.034947 | val_loss=0.054371
2025-11-03 10:22:24,915 - models.nhits - INFO - Epoch  29 | train_loss=0.036079 | val_loss=0.048094
2025-11-03 10:22:33,665 - models.nhits - INFO - Epoch  30 | train_loss=0.042817 | val_loss=0.050382
2025-11-03 10:22:42,298 - models.nhits - INFO - Epoch  31 | train_loss=0.045349 | val_loss=0.052848
2025-11-03 10:22:50,942 - models.nhits - INFO - Epoch  32 | train_loss=0.033117 | val_loss=0.040816
2025-11-03 10:22:59,622 - models.nhits - INFO - Epoch  33 | train_loss=0.033556 | val_loss=0.038750
2025-11-03 10:23:08,334 - models.nhits - INFO - Epoch  34 | train_loss=0.037324 | val_loss=0.044450
2025-11-03 10:23:16,899 - models.nhits - INFO - Epoch  35 | train_loss=0.037527 | val_loss=0.052065
2025-11-03 10:23:25,589 - models.nhits - INFO - Epoch  36 | train_loss=0.042920 | val_loss=0.044495
2025-11-03 10:23:34,455 - models.nhits - INFO - Epoch  37 | train_loss=0.036279 | val_loss=0.047003
2025-11-03 10:23:43,036 - models.nhits - INFO - Epoch  38 | train_loss=0.033454 | val_loss=0.054518
2025-11-03 10:23:51,652 - models.nhits - INFO - Epoch  39 | train_loss=0.031857 | val_loss=0.045340
2025-11-03 10:24:00,293 - models.nhits - INFO - Epoch  40 | train_loss=0.045060 | val_loss=0.048699
2025-11-03 10:24:08,893 - models.nhits - INFO - Epoch  41 | train_loss=0.038721 | val_loss=0.048312
2025-11-03 10:24:17,413 - models.nhits - INFO - Epoch  42 | train_loss=0.031676 | val_loss=0.041020
2025-11-03 10:24:26,064 - models.nhits - INFO - Epoch  43 | train_loss=0.030654 | val_loss=0.044055
2025-11-03 10:24:34,622 - models.nhits - INFO - Epoch  44 | train_loss=0.032631 | val_loss=0.046433
2025-11-03 10:24:43,326 - models.nhits - INFO - Epoch  45 | train_loss=0.037258 | val_loss=0.038723
2025-11-03 10:24:53,256 - models.nhits - INFO - Epoch  46 | train_loss=0.035306 | val_loss=0.042738
2025-11-03 10:25:02,836 - models.nhits - INFO - Epoch  47 | train_loss=0.034744 | val_loss=0.048308
2025-11-03 10:25:12,132 - models.nhits - INFO - Epoch  48 | train_loss=0.033021 | val_loss=0.058727
2025-11-03 10:25:21,177 - models.nhits - INFO - Epoch  49 | train_loss=0.437219 | val_loss=0.040045
2025-11-03 10:25:31,101 - models.nhits - INFO - Epoch  50 | train_loss=0.030398 | val_loss=0.045076
2025-11-03 10:25:41,142 - models.nhits - INFO - Epoch  51 | train_loss=0.038267 | val_loss=0.040133
2025-11-03 10:25:50,580 - models.nhits - INFO - Epoch  52 | train_loss=0.112945 | val_loss=0.040593
2025-11-03 10:26:00,244 - models.nhits - INFO - Epoch  53 | train_loss=0.028474 | val_loss=0.040326
2025-11-03 10:26:09,332 - models.nhits - INFO - Epoch  54 | train_loss=0.035185 | val_loss=0.053400
2025-11-03 10:26:18,163 - models.nhits - INFO - Epoch  55 | train_loss=0.032176 | val_loss=0.045256
2025-11-03 10:26:26,219 - models.nhits - INFO - Epoch  56 | train_loss=0.030075 | val_loss=0.040020
2025-11-03 10:26:34,091 - models.nhits - INFO - Epoch  57 | train_loss=0.030892 | val_loss=0.047345
2025-11-03 10:26:42,033 - models.nhits - INFO - Epoch  58 | train_loss=0.043038 | val_loss=0.088808
2025-11-03 10:26:50,088 - models.nhits - INFO - Epoch  59 | train_loss=0.028007 | val_loss=0.046098
2025-11-03 10:26:58,066 - models.nhits - INFO - Epoch  60 | train_loss=0.187100 | val_loss=0.049541
2025-11-03 10:26:58,066 - models.nhits - INFO - Early stopping at epoch 60早停触发（连续15轮验证损失未下降），最佳验证损失：0.038723
2025-11-03 10:26:58,088 - models.patchtst - INFO - 模型已保存到: results\experiment_20251103_101320/patchtst_model.pth
2025-11-03 10:26:58,114 - models.nhits - INFO - 模型已保存到: results\experiment_20251103_101320/nhits_model.pth
2025-11-03 10:26:58,115 - main - INFO - 专家模型训练完成
2025-11-03 10:26:58,117 - main - INFO - 获取专家模型预测...
2025-11-03 10:27:10,898 - main - INFO - 专家预测获取完成
2025-11-03 10:27:10,900 - main - INFO - 实现策略A：静态优化权重...
2025-11-03 10:27:11,599 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-11-03 10:27:11,607 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = inf
2025-11-03 10:27:11,617 - src.strategies.mpa_optimizer - INFO - 迭代 20: 最优适应度 = 1.151922
2025-11-03 10:27:11,628 - src.strategies.mpa_optimizer - INFO - 迭代 30: 最优适应度 = 0.222515
2025-11-03 10:27:11,634 - src.strategies.mpa_optimizer - INFO - 在第 32 代收敛
2025-11-03 10:27:17,500 - main - INFO - 策略A完成 - 最优权重: [0. 1.], 验证集RMSE: 0.222515
2025-11-03 10:27:17,500 - main - INFO - 实现策略B：广义线性融合...
2025-11-03 10:27:18,164 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = 1.077081
2025-11-03 10:27:18,227 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.281432
2025-11-03 10:27:18,264 - src.strategies.mpa_optimizer - INFO - 在第 16 代收敛
2025-11-03 10:27:23,979 - main - INFO - 策略B完成 - 最优系数: [-0.07593565  1.12893983  0.90287823], 验证集RMSE: 0.281432
2025-11-03 10:27:23,980 - main - INFO - 实现策略C：动态门控网络...
2025-11-03 10:27:24,240 - main - INFO - 训练动态门控网络...
2025-11-03 10:27:30,856 - src.strategies.gating_network - INFO - Epoch   1 | train_loss=0.122895 | val_loss=0.037886
2025-11-03 10:27:36,746 - src.strategies.gating_network - INFO - Epoch   2 | train_loss=0.042616 | val_loss=0.036688
2025-11-03 10:27:44,245 - src.strategies.gating_network - INFO - Epoch   3 | train_loss=0.038204 | val_loss=0.036436
2025-11-03 10:27:50,814 - src.strategies.gating_network - INFO - Epoch   4 | train_loss=0.034048 | val_loss=0.040418
2025-11-03 10:27:58,984 - src.strategies.gating_network - INFO - Epoch   5 | train_loss=0.032635 | val_loss=0.037541
2025-11-03 10:28:05,556 - src.strategies.gating_network - INFO - Epoch   6 | train_loss=0.029568 | val_loss=0.037549
2025-11-03 10:28:11,774 - src.strategies.gating_network - INFO - Epoch   7 | train_loss=0.026968 | val_loss=0.036480
2025-11-03 10:28:17,998 - src.strategies.gating_network - INFO - Epoch   8 | train_loss=0.023836 | val_loss=0.036233
2025-11-03 10:28:24,160 - src.strategies.gating_network - INFO - Epoch   9 | train_loss=0.020291 | val_loss=0.036294
2025-11-03 10:28:31,640 - src.strategies.gating_network - INFO - Epoch  10 | train_loss=0.017247 | val_loss=0.035735
2025-11-03 10:28:40,151 - src.strategies.gating_network - INFO - Epoch  11 | train_loss=0.014604 | val_loss=0.035845
2025-11-03 10:28:47,521 - src.strategies.gating_network - INFO - Epoch  12 | train_loss=0.012795 | val_loss=0.037321
2025-11-03 10:28:55,689 - src.strategies.gating_network - INFO - Epoch  13 | train_loss=0.010886 | val_loss=0.033844
2025-11-03 10:29:01,700 - src.strategies.gating_network - INFO - Epoch  14 | train_loss=0.009677 | val_loss=0.034346
2025-11-03 10:29:07,704 - src.strategies.gating_network - INFO - Epoch  15 | train_loss=0.008688 | val_loss=0.038037
2025-11-03 10:29:13,849 - src.strategies.gating_network - INFO - Epoch  16 | train_loss=0.007813 | val_loss=0.036713
2025-11-03 10:29:20,995 - src.strategies.gating_network - INFO - Epoch  17 | train_loss=0.006979 | val_loss=0.036243
2025-11-03 10:29:27,114 - src.strategies.gating_network - INFO - Epoch  18 | train_loss=0.006563 | val_loss=0.036280
2025-11-03 10:29:33,221 - src.strategies.gating_network - INFO - Epoch  19 | train_loss=0.005840 | val_loss=0.037191
2025-11-03 10:29:39,456 - src.strategies.gating_network - INFO - Epoch  20 | train_loss=0.005400 | val_loss=0.035962
2025-11-03 10:29:45,467 - src.strategies.gating_network - INFO - Epoch  21 | train_loss=0.005566 | val_loss=0.034847
2025-11-03 10:29:51,814 - src.strategies.gating_network - INFO - Epoch  22 | train_loss=0.004909 | val_loss=0.036008
2025-11-03 10:29:57,953 - src.strategies.gating_network - INFO - Epoch  23 | train_loss=0.004676 | val_loss=0.038576
2025-11-03 10:30:04,715 - src.strategies.gating_network - INFO - Epoch  24 | train_loss=0.004781 | val_loss=0.037014
2025-11-03 10:30:10,936 - src.strategies.gating_network - INFO - Epoch  25 | train_loss=0.004406 | val_loss=0.038563
2025-11-03 10:30:17,204 - src.strategies.gating_network - INFO - Epoch  26 | train_loss=0.004052 | val_loss=0.035423
2025-11-03 10:30:23,425 - src.strategies.gating_network - INFO - Epoch  27 | train_loss=0.003874 | val_loss=0.037003
2025-11-03 10:30:30,697 - src.strategies.gating_network - INFO - Epoch  28 | train_loss=0.003939 | val_loss=0.036511
2025-11-03 10:30:30,697 - src.strategies.gating_network - INFO - 早停触发（连续15轮验证损失未下降），最佳验证损失：0.033844
2025-11-03 10:30:38,408 - src.strategies.gating_network - INFO - 动态融合模型已保存到: results\experiment_20251103_101320/dynamic_fusion_model.pth
2025-11-03 10:30:38,412 - main - INFO - 策略C完成
2025-11-03 10:30:38,417 - main - INFO - 评估所有策略...
2025-11-03 10:31:47,894 - main - INFO - 评估完成，结果已保存
2025-11-03 10:31:47,894 - main - INFO - 生成可视化结果...
2025-11-03 10:31:50,465 - main - INFO - 策略C中，w1有 41057 个时刻超出[0,1]范围
2025-11-03 10:31:50,466 - main - INFO - 策略C中，w2有 60179 个时刻超出[0,1]范围
2025-11-03 10:31:51,206 - main - INFO - 可视化完成
2025-11-03 10:31:51,214 - main - INFO - 完整实验流程完成
2025-11-03 10:31:51,215 - __main__ - INFO - 实验成功完成！
