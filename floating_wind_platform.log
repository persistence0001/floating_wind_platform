2025-10-29 16:43:15,802 - __main__ - INFO - 初始化实验...
2025-10-29 16:43:15,812 - main - INFO - 使用设备: cuda
2025-10-29 16:43:15,814 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-29 16:43:15,815 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-29 16:43:15,815 - main - INFO - 开始数据加载和预处理...
2025-10-29 16:43:15,823 - src.data_preprocessing.data_loader - ERROR - 数据加载失败: 'file_path'
2025-10-29 16:43:15,823 - __main__ - ERROR - 实验失败: 'file_path'
2025-10-29 17:00:27,702 - __main__ - INFO - 初始化实验...
2025-10-29 17:00:27,711 - main - INFO - 使用设备: cuda
2025-10-29 17:00:27,716 - __main__ - INFO - 开始完整实验...
2025-10-29 17:00:27,716 - main - INFO - 开始完整实验流程...
2025-10-29 17:00:27,716 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:00:27,724 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:00:29,958 - src.data_preprocessing.data_loader - ERROR - 数据加载失败: 'Time'
2025-10-29 17:00:29,958 - __main__ - ERROR - 实验失败: 'Time'
2025-10-29 17:05:13,799 - __main__ - INFO - 初始化实验...
2025-10-29 17:05:13,808 - main - INFO - 使用设备: cuda
2025-10-29 17:05:13,810 - __main__ - INFO - 开始完整实验...
2025-10-29 17:05:13,810 - main - INFO - 开始完整实验流程...
2025-10-29 17:05:13,810 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:05:13,818 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:05:15,956 - __main__ - ERROR - 实验失败: 缺少必需列: ['Wave1Elev']
2025-10-29 17:11:37,091 - __main__ - INFO - 初始化实验...
2025-10-29 17:11:37,100 - main - INFO - 使用设备: cuda
2025-10-29 17:11:37,100 - __main__ - INFO - 开始完整实验...
2025-10-29 17:11:37,101 - main - INFO - 开始完整实验流程...
2025-10-29 17:11:37,101 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:11:37,108 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:11:39,243 - __main__ - ERROR - 实验失败: 缺少必需列: ['Wave1Elev', 'PtfmSurge', 'PtfmSway', 'PtfmHeave', 'PtfmRoll', 'PtfmPitch', 'PtfmYaw']
2025-10-29 17:26:24,339 - __main__ - INFO - 初始化实验...
2025-10-29 17:26:24,347 - main - INFO - 使用设备: cuda
2025-10-29 17:26:24,350 - __main__ - INFO - 开始完整实验...
2025-10-29 17:26:24,350 - main - INFO - 开始完整实验流程...
2025-10-29 17:26:24,350 - main - INFO - 开始数据加载和预处理...
2025-10-29 17:26:24,357 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 17:26:26,480 - __main__ - ERROR - 实验失败: can only concatenate str (not "float") to str
2025-10-29 18:38:33,408 - __main__ - INFO - 初始化实验...
2025-10-29 18:38:33,416 - main - INFO - 使用设备: cuda
2025-10-29 18:38:33,428 - __main__ - INFO - 开始完整实验...
2025-10-29 18:38:33,428 - main - INFO - 开始完整实验流程...
2025-10-29 18:38:33,428 - main - INFO - 开始数据加载和预处理...
2025-10-29 18:38:33,436 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 18:38:35,521 - src.data_preprocessing.data_loader - WARNING - 发现缺失值:
Wave1Elev    2
PtfmSurge    2
PtfmSway     2
PtfmHeave    2
PtfmRoll     2
PtfmPitch    2
PtfmYaw      2
dtype: int64
2025-10-29 18:38:35,532 - __main__ - ERROR - 实验失败: Interpolation with NaNs in the index has not been implemented. Try filling those NaNs before interpolating.
2025-10-29 18:58:32,452 - __main__ - INFO - 初始化实验...
2025-10-29 18:58:32,462 - main - INFO - 使用设备: cuda
2025-10-29 18:58:32,467 - __main__ - INFO - 开始完整实验...
2025-10-29 18:58:32,467 - main - INFO - 开始完整实验流程...
2025-10-29 18:58:32,467 - main - INFO - 开始数据加载和预处理...
2025-10-29 18:58:32,474 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 18:58:34,531 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 18:58:34,535 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 18:58:34,537 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 18:58:34,539 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 18:58:34,542 - __main__ - ERROR - 实验失败: preprocess_data() takes 1 positional argument but 2 were given
2025-10-29 19:04:30,326 - __main__ - INFO - 初始化实验...
2025-10-29 19:04:30,335 - main - INFO - 使用设备: cuda
2025-10-29 19:04:30,336 - __main__ - INFO - 开始完整实验...
2025-10-29 19:04:30,336 - main - INFO - 开始完整实验流程...
2025-10-29 19:04:30,336 - main - INFO - 开始数据加载和预处理...
2025-10-29 19:04:30,346 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 19:04:32,578 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 19:04:32,580 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:04:32,582 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 19:04:32,585 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:04:32,595 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 19:04:32,596 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 19:04:32,678 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 19:04:32,761 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 19:04:32,761 - main - INFO - 数据预处理完成:
2025-10-29 19:04:32,761 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 19:04:32,761 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 19:04:32,761 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 19:04:32,762 - main - INFO - 开始专家模型超参数优化...
2025-10-29 19:04:32,771 - main - INFO - 优化PatchTST超参数...
2025-10-29 19:04:32,796 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,797 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,797 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,798 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,799 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,799 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,799 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,800 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,800 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,801 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,801 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,802 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,802 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,802 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,803 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,803 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,804 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,804 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,805 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,805 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,806 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,806 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,807 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,808 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,808 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,809 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,809 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,810 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,810 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,811 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,813 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,814 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,814 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,814 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,815 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,815 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,816 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,816 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,817 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,817 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,817 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,818 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,818 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,819 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,819 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-29 19:04:32,820 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:04:32,826 - main - INFO - 优化NHITS超参数...
2025-10-29 19:04:32,838 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,838 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,839 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,840 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,840 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,841 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,841 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,842 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,842 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,842 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,843 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,844 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,844 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,845 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,845 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,845 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,846 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,846 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,846 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,847 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,847 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,848 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,849 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,849 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,849 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,850 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,850 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,851 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,851 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,852 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,852 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,853 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,853 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,854 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,854 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,855 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,855 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,855 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,856 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,856 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,857 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,857 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,858 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,858 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,859 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,859 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,859 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,860 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,860 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,861 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:04:32,861 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-29 19:04:32,861 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:04:32,867 - main - INFO - 超参数优化完成
2025-10-29 19:04:32,867 - main - INFO - 开始训练专家模型...
2025-10-29 19:04:32,867 - main - INFO - 创建PatchTST模型...
2025-10-29 19:04:32,903 - main - INFO - 创建NHITS模型...
2025-10-29 19:04:32,913 - __main__ - ERROR - 实验失败: str is not a Module subclass
2025-10-29 19:15:05,935 - __main__ - INFO - 初始化实验...
2025-10-29 19:15:05,944 - main - INFO - 使用设备: cuda
2025-10-29 19:15:05,945 - __main__ - INFO - 开始完整实验...
2025-10-29 19:15:05,945 - main - INFO - 开始完整实验流程...
2025-10-29 19:15:05,945 - main - INFO - 开始数据加载和预处理...
2025-10-29 19:15:05,953 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 19:15:08,121 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 19:15:08,125 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:15:08,128 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 19:15:08,130 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 19:15:08,135 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 19:15:08,135 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 19:15:08,211 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 19:15:08,297 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 19:15:08,297 - main - INFO - 数据预处理完成:
2025-10-29 19:15:08,297 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 19:15:08,297 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 19:15:08,297 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 19:15:08,297 - main - INFO - 开始专家模型超参数优化...
2025-10-29 19:15:08,306 - main - INFO - 优化PatchTST超参数...
2025-10-29 19:15:08,322 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,322 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,323 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,323 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,324 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,324 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,325 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,325 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,326 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,326 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,327 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,327 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,328 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,329 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,329 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,330 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,330 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,331 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,332 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,332 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,333 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,333 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,334 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,334 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,335 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,336 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,337 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,337 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,338 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,339 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,339 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,340 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,340 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,341 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,343 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-29 19:15:08,344 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-29 19:15:08,345 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:15:08,350 - main - INFO - 优化NHITS超参数...
2025-10-29 19:15:08,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,363 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,364 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,364 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,365 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,367 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,367 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,368 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,369 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,369 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,370 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,371 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,371 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,372 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,373 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,374 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,374 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,375 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,375 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,375 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,376 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,376 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,377 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,377 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,377 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,378 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,378 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,379 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,379 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,379 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,380 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,380 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,381 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,383 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,383 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-29 19:15:08,383 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-29 19:15:08,384 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-29 19:15:08,389 - main - INFO - 超参数优化完成
2025-10-29 19:15:08,389 - main - INFO - 开始训练专家模型...
2025-10-29 19:15:08,389 - main - INFO - 创建PatchTST模型...
2025-10-29 19:15:08,402 - main - INFO - 创建NHITS模型...
2025-10-29 19:15:08,464 - main - INFO - 训练PatchTST...
2025-10-29 19:15:08,617 - __main__ - ERROR - 实验失败: __init__() got an unexpected keyword argument 'batch_size'
2025-10-29 20:16:43,097 - __main__ - INFO - 初始化实验...
2025-10-29 20:16:43,107 - main - INFO - 使用设备: cuda
2025-10-29 20:16:43,108 - __main__ - INFO - 开始完整实验...
2025-10-29 20:16:43,108 - main - INFO - 开始完整实验流程...
2025-10-29 20:16:43,108 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:16:43,116 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:16:45,302 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:16:45,303 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:16:45,306 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:16:45,308 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:16:45,313 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:16:45,313 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:16:45,395 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:16:45,395 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:16:45,396 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:16:45,396 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:16:45,396 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:16:45,497 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:16:45,497 - main - INFO - 数据预处理完成:
2025-10-29 20:16:45,498 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:16:45,498 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:16:45,498 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:16:45,498 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:16:45,508 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:16:45,553 - __main__ - ERROR - 实验失败: batch_size should be a positive integer value, but got batch_size=tensor([[ 1.2946,  1.2079,  1.1213,  ..., -1.0728, -1.1160, -1.1342],
        [ 1.2079,  1.1213,  1.0094,  ..., -1.1160, -1.1342, -1.1524],
        [ 1.1213,  1.0094,  0.8975,  ..., -1.1342, -1.1524, -1.1472],
        ...,
        [ 0.2753,  0.2629,  0.2506,  ..., -0.3080, -0.3343, -0.3560],
        [ 0.2629,  0.2506,  0.2319,  ..., -0.3343, -0.3560, -0.3776],
        [ 0.2506,  0.2319,  0.2132,  ..., -0.3560, -0.3776, -0.3935]])
2025-10-29 20:32:54,321 - __main__ - INFO - 初始化实验...
2025-10-29 20:32:54,331 - main - INFO - 使用设备: cuda
2025-10-29 20:32:54,332 - __main__ - INFO - 开始完整实验...
2025-10-29 20:32:54,332 - main - INFO - 开始完整实验流程...
2025-10-29 20:32:54,332 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:32:54,339 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:32:56,434 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:32:56,436 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:32:56,438 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:32:56,440 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:32:56,445 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:32:56,446 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:32:56,521 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:32:56,598 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:32:56,598 - main - INFO - 数据预处理完成:
2025-10-29 20:32:56,598 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:32:56,598 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:32:56,598 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:32:56,598 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:32:56,606 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:32:56,621 - __main__ - ERROR - 实验失败: batch_size should be a positive integer value, but got batch_size=tensor([[ 1.2946,  1.2079,  1.1213,  ..., -1.0728, -1.1160, -1.1342],
        [ 1.2079,  1.1213,  1.0094,  ..., -1.1160, -1.1342, -1.1524],
        [ 1.1213,  1.0094,  0.8975,  ..., -1.1342, -1.1524, -1.1472],
        ...,
        [ 0.2753,  0.2629,  0.2506,  ..., -0.3080, -0.3343, -0.3560],
        [ 0.2629,  0.2506,  0.2319,  ..., -0.3343, -0.3560, -0.3776],
        [ 0.2506,  0.2319,  0.2132,  ..., -0.3560, -0.3776, -0.3935]])
2025-10-29 20:34:29,880 - __main__ - INFO - 初始化实验...
2025-10-29 20:34:29,888 - main - INFO - 使用设备: cuda
2025-10-29 20:34:29,889 - __main__ - INFO - 开始完整实验...
2025-10-29 20:34:29,889 - main - INFO - 开始完整实验流程...
2025-10-29 20:34:29,889 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:34:29,897 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:34:31,994 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:34:31,996 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:34:31,998 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:34:32,000 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:34:32,005 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:34:32,006 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:34:32,073 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:34:32,156 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:34:32,156 - main - INFO - 数据预处理完成:
2025-10-29 20:34:32,156 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:34:32,156 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:34:32,156 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:34:32,156 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:34:32,164 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:34:32,164 - __main__ - ERROR - 实验失败: name 'TensorDataset' is not defined
2025-10-29 20:38:38,613 - __main__ - INFO - 初始化实验...
2025-10-29 20:38:38,627 - main - INFO - 使用设备: cuda
2025-10-29 20:38:38,632 - __main__ - INFO - 开始完整实验...
2025-10-29 20:38:38,632 - main - INFO - 开始完整实验流程...
2025-10-29 20:38:38,632 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:38:38,641 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:38:40,990 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:38:40,992 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:38:40,995 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:38:40,997 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:38:41,002 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:38:41,002 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:38:41,089 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:38:41,176 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:38:41,177 - main - INFO - 数据预处理完成:
2025-10-29 20:38:41,177 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:38:41,177 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:38:41,177 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:38:41,177 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:38:41,185 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:38:41,202 - __main__ - ERROR - 实验失败: name 'params' is not defined
2025-10-29 20:51:25,286 - __main__ - INFO - 初始化实验...
2025-10-29 20:51:25,296 - main - INFO - 使用设备: cuda
2025-10-29 20:51:25,297 - __main__ - INFO - 开始完整实验...
2025-10-29 20:51:25,297 - main - INFO - 开始完整实验流程...
2025-10-29 20:51:25,297 - main - INFO - 开始数据加载和预处理...
2025-10-29 20:51:25,307 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 20:51:27,409 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 20:51:27,411 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:51:27,414 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 20:51:27,416 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 20:51:27,421 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 20:51:27,421 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 20:51:27,490 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 20:51:27,491 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 20:51:27,571 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 20:51:27,571 - main - INFO - 数据预处理完成:
2025-10-29 20:51:27,571 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 20:51:27,571 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 20:51:27,571 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 20:51:27,571 - main - INFO - 开始专家模型超参数优化...
2025-10-29 20:51:27,579 - main - INFO - 优化PatchTST超参数...
2025-10-29 20:51:27,579 - __main__ - ERROR - 实验失败: optimize_patchtst() takes 5 positional arguments but 6 were given
2025-10-29 21:08:27,249 - __main__ - INFO - 初始化实验...
2025-10-29 21:08:27,258 - main - INFO - 使用设备: cuda
2025-10-29 21:08:27,259 - __main__ - INFO - 开始完整实验...
2025-10-29 21:08:27,259 - main - INFO - 开始完整实验流程...
2025-10-29 21:08:27,259 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:08:27,267 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:08:29,354 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:08:29,357 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:08:29,359 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:08:29,360 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:08:29,366 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:08:29,367 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:08:29,451 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:08:29,534 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:08:29,534 - main - INFO - 数据预处理完成:
2025-10-29 21:08:29,534 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:08:29,534 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:08:29,535 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:08:29,535 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:08:29,544 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:08:29,544 - __main__ - ERROR - 实验失败: optimize_patchtst() got an unexpected keyword argument 'params'
2025-10-29 21:18:33,628 - __main__ - INFO - 初始化实验...
2025-10-29 21:18:33,638 - main - INFO - 使用设备: cuda
2025-10-29 21:18:33,638 - __main__ - INFO - 开始完整实验...
2025-10-29 21:18:33,638 - main - INFO - 开始完整实验流程...
2025-10-29 21:18:33,638 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:18:33,647 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:18:35,764 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:18:35,766 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:18:35,768 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:18:35,770 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:18:35,776 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:18:35,776 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:18:35,845 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:18:35,846 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:18:35,928 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:18:35,928 - main - INFO - 数据预处理完成:
2025-10-29 21:18:35,928 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:18:35,928 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:18:35,928 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:18:35,929 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:18:35,936 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:18:35,936 - __main__ - ERROR - 实验失败: optimize_patchtst() got an unexpected keyword argument 'params'
2025-10-29 21:23:29,873 - __main__ - INFO - 初始化实验...
2025-10-29 21:23:29,881 - main - INFO - 使用设备: cuda
2025-10-29 21:23:29,882 - __main__ - INFO - 开始完整实验...
2025-10-29 21:23:29,882 - main - INFO - 开始完整实验流程...
2025-10-29 21:23:29,882 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:23:29,890 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:23:31,983 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:23:31,984 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:23:31,988 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:23:31,989 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:23:31,994 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:23:31,994 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:23:32,074 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:23:32,158 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:23:32,158 - main - INFO - 数据预处理完成:
2025-10-29 21:23:32,158 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:23:32,158 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:23:32,158 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:23:32,158 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:23:32,167 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:23:32,167 - __main__ - ERROR - 实验失败: optimize_patchtst() got an unexpected keyword argument 'params'
2025-10-29 21:33:56,776 - __main__ - INFO - 初始化实验...
2025-10-29 21:33:56,785 - main - INFO - 使用设备: cuda
2025-10-29 21:33:56,786 - __main__ - INFO - 开始完整实验...
2025-10-29 21:33:56,786 - main - INFO - 开始完整实验流程...
2025-10-29 21:33:56,787 - main - INFO - 开始数据加载和预处理...
2025-10-29 21:33:56,794 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-29 21:33:58,901 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-29 21:33:58,904 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:33:58,906 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-29 21:33:58,908 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-29 21:33:58,913 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-29 21:33:58,913 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-29 21:33:58,987 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-29 21:33:58,987 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-29 21:33:58,987 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-29 21:33:58,988 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-29 21:33:58,988 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-29 21:33:59,068 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-29 21:33:59,068 - main - INFO - 数据预处理完成:
2025-10-29 21:33:59,068 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-29 21:33:59,068 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-29 21:33:59,068 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-29 21:33:59,068 - main - INFO - 开始专家模型超参数优化...
2025-10-29 21:33:59,077 - main - INFO - 优化PatchTST超参数...
2025-10-29 21:33:59,077 - __main__ - ERROR - 实验失败: name 'hp' is not defined
2025-10-31 14:03:33,997 - __main__ - INFO - 初始化实验...
2025-10-31 14:03:34,013 - main - INFO - 使用设备: cuda
2025-10-31 14:03:34,015 - __main__ - INFO - 开始完整实验...
2025-10-31 14:03:34,015 - main - INFO - 开始完整实验流程...
2025-10-31 14:03:34,015 - main - INFO - 开始数据加载和预处理...
2025-10-31 14:03:34,024 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 14:03:36,854 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 14:03:36,857 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:03:36,859 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 14:03:36,861 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:03:36,867 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 14:03:36,867 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 14:03:36,961 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 14:03:36,961 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 14:03:36,961 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 14:03:36,962 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 14:03:36,962 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 14:03:37,082 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 14:03:37,082 - main - INFO - 数据预处理完成:
2025-10-31 14:03:37,082 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 14:03:37,082 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 14:03:37,082 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 14:03:37,082 - main - INFO - 开始专家模型超参数优化...
2025-10-31 14:03:37,098 - main - INFO - 优化PatchTST超参数...
2025-10-31 14:03:37,156 - __main__ - ERROR - 实验失败: batch_size should be a positive integer value, but got batch_size=tensor([[ 0.2319,  0.2132,  0.1893,  ..., -0.3776, -0.3935, -0.4093],
        [ 0.2132,  0.1893,  0.1653,  ..., -0.3935, -0.4093, -0.4185],
        [ 0.1893,  0.1653,  0.1371,  ..., -0.4093, -0.4185, -0.4277],
        ...,
        [-0.8700, -0.6814, -0.4928,  ...,  1.4538,  1.3598,  1.2264],
        [-0.6814, -0.4928, -0.2894,  ...,  1.3598,  1.2264,  1.0930],
        [-0.4928, -0.2894, -0.0860,  ...,  1.2264,  1.0930,  0.9287]])
2025-10-31 14:14:12,288 - __main__ - INFO - 初始化实验...
2025-10-31 14:14:12,310 - main - INFO - 使用设备: cuda
2025-10-31 14:14:12,314 - __main__ - INFO - 开始完整实验...
2025-10-31 14:14:12,315 - main - INFO - 开始完整实验流程...
2025-10-31 14:14:12,315 - main - INFO - 开始数据加载和预处理...
2025-10-31 14:14:12,328 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 14:14:15,224 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 14:14:15,226 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:14:15,229 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 14:14:15,232 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 14:14:15,238 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 14:14:15,238 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 14:14:15,344 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 14:14:15,345 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 14:14:15,480 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 14:14:15,480 - main - INFO - 数据预处理完成:
2025-10-31 14:14:15,480 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 14:14:15,480 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 14:14:15,480 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 14:14:15,480 - main - INFO - 开始专家模型超参数优化...
2025-10-31 14:14:15,498 - main - INFO - 优化PatchTST超参数...
2025-10-31 14:14:15,513 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,514 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,515 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,515 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,516 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,517 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,517 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,518 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,518 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,519 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,519 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,520 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,520 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,521 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,521 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,521 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,522 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,522 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,523 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,524 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,524 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,525 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,526 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,526 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,527 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,527 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,529 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,529 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,529 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,530 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,530 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,531 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,532 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,532 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,533 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,534 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,534 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,535 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,535 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,535 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,536 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,537 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,537 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,538 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,539 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,539 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,540 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,540 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,541 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,542 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 14:14:15,542 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-31 14:14:15,542 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 14:14:15,547 - main - INFO - 优化NHITS超参数...
2025-10-31 14:14:15,557 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,558 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,559 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,559 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,561 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,561 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,562 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,562 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,563 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,563 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,564 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,565 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,565 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,566 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,567 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,567 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,568 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,568 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,570 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,570 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,570 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,571 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,571 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,572 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,572 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,573 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,574 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,574 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,575 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,576 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,576 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,577 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,578 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,578 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,580 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,580 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,581 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,581 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,582 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,582 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,583 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,583 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,584 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,584 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,586 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,587 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,588 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,588 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,589 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,590 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 14:14:15,590 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-31 14:14:15,590 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 14:14:15,594 - main - INFO - 超参数优化完成
2025-10-31 14:14:15,594 - main - INFO - 开始训练专家模型...
2025-10-31 14:14:15,594 - main - INFO - 创建PatchTST模型...
2025-10-31 14:14:15,626 - main - INFO - 创建NHITS模型...
2025-10-31 14:14:15,709 - main - INFO - 训练PatchTST...
2025-10-31 14:14:16,459 - __main__ - ERROR - 实验失败: 'PatchTSTTrainer' object has no attribute 'train_model'
2025-10-31 15:31:30,216 - __main__ - INFO - 初始化实验...
2025-10-31 15:31:30,231 - main - INFO - 使用设备: cuda
2025-10-31 15:31:30,232 - __main__ - INFO - 开始完整实验...
2025-10-31 15:31:30,232 - main - INFO - 开始完整实验流程...
2025-10-31 15:31:30,233 - main - INFO - 开始数据加载和预处理...
2025-10-31 15:31:30,244 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 15:31:32,834 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 15:31:32,838 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:31:32,841 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 15:31:32,844 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:31:32,850 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 15:31:32,851 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 15:31:32,933 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 15:31:32,934 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 15:31:33,060 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 15:31:33,060 - main - INFO - 数据预处理完成:
2025-10-31 15:31:33,061 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 15:31:33,061 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 15:31:33,061 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 15:31:33,061 - main - INFO - 开始专家模型超参数优化...
2025-10-31 15:31:33,074 - main - INFO - 优化PatchTST超参数...
2025-10-31 15:31:33,101 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,101 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,102 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,103 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,103 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,104 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,104 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,105 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,105 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,106 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,106 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,107 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,107 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,108 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,110 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,110 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,111 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,111 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,112 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,112 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,113 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,113 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,114 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,114 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,115 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,116 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,116 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,117 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,118 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,120 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,121 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,121 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,122 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,122 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,123 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,123 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,124 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:31:33,125 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-31 15:31:33,125 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:31:33,130 - main - INFO - 优化NHITS超参数...
2025-10-31 15:31:33,140 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,140 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,141 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,141 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,142 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,143 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,143 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,144 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,146 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,146 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,147 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,148 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,148 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,149 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,149 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,150 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,151 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,151 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,152 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,154 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,154 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,155 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,156 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,157 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,157 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,158 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,159 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,160 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,160 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,161 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,161 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,161 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,162 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:31:33,162 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-31 15:31:33,162 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:31:33,167 - main - INFO - 超参数优化完成
2025-10-31 15:31:33,167 - main - INFO - 开始训练专家模型...
2025-10-31 15:31:33,167 - main - INFO - 创建PatchTST模型...
2025-10-31 15:31:33,211 - main - INFO - 创建NHITS模型...
2025-10-31 15:31:33,286 - main - INFO - 训练PatchTST...
2025-10-31 15:31:48,745 - __main__ - ERROR - 实验失败: unsupported format string passed to NoneType.__format__
2025-10-31 15:39:17,696 - __main__ - INFO - 初始化实验...
2025-10-31 15:39:17,711 - main - INFO - 使用设备: cuda
2025-10-31 15:39:17,714 - __main__ - INFO - 开始完整实验...
2025-10-31 15:39:17,715 - main - INFO - 开始完整实验流程...
2025-10-31 15:39:17,715 - main - INFO - 开始数据加载和预处理...
2025-10-31 15:39:17,725 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 15:39:20,212 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 15:39:20,215 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:39:20,218 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 15:39:20,220 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 15:39:20,228 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 15:39:20,228 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 15:39:20,308 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 15:39:20,309 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 15:39:20,422 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 15:39:20,422 - main - INFO - 数据预处理完成:
2025-10-31 15:39:20,422 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 15:39:20,423 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 15:39:20,423 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 15:39:20,423 - main - INFO - 开始专家模型超参数优化...
2025-10-31 15:39:20,434 - main - INFO - 优化PatchTST超参数...
2025-10-31 15:39:20,447 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,448 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,448 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,449 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,449 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,450 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,450 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,451 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,452 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,452 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,453 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,453 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,454 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,454 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,455 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,456 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,456 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,456 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,458 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,458 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,459 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,459 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,459 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,460 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,460 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,461 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,462 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,462 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,463 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,463 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,464 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,464 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,465 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,465 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,466 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,466 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,466 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,468 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,468 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,469 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,469 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,469 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,470 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,470 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,471 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,471 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,473 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,473 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,474 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,474 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.patchtst'
2025-10-31 15:39:20,474 - src.utils.hyperparameter_optimization - INFO - PatchTST最佳试验: {}
2025-10-31 15:39:20,475 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:39:20,477 - main - INFO - 优化NHITS超参数...
2025-10-31 15:39:20,485 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,486 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,488 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,488 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,489 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,489 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,490 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,490 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,491 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,491 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,492 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,492 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,492 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,493 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,493 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,494 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,494 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,495 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,495 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,496 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,496 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,497 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,497 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,498 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,498 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,498 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,499 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,499 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,500 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,500 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,500 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,501 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,501 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,502 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,502 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,502 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,503 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,503 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,504 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,504 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,505 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,505 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,506 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,508 - src.utils.hyperparameter_optimization - ERROR - 试验失败: No module named 'src.models.nhits'
2025-10-31 15:39:20,508 - src.utils.hyperparameter_optimization - INFO - NHITS最佳试验: {}
2025-10-31 15:39:20,508 - src.utils.hyperparameter_optimization - INFO - 最佳验证损失: inf
2025-10-31 15:39:20,513 - main - INFO - 超参数优化完成
2025-10-31 15:39:20,514 - main - INFO - 开始训练专家模型...
2025-10-31 15:39:20,514 - main - INFO - 创建PatchTST模型...
2025-10-31 15:39:20,525 - main - INFO - 创建NHITS模型...
2025-10-31 15:39:20,595 - main - INFO - 训练PatchTST...
2025-10-31 15:39:33,283 - models.patchtst - INFO - Epoch   1 | train_loss=0.927869 | val_loss=1.327825
2025-10-31 15:39:43,305 - models.patchtst - INFO - Epoch   2 | train_loss=0.924054 | val_loss=1.327774
2025-10-31 15:39:53,846 - models.patchtst - INFO - Epoch   3 | train_loss=0.923918 | val_loss=1.327781
2025-10-31 15:40:04,510 - models.patchtst - INFO - Epoch   4 | train_loss=0.924005 | val_loss=1.327734
2025-10-31 15:40:14,779 - models.patchtst - INFO - Epoch   5 | train_loss=0.923960 | val_loss=1.327734
2025-10-31 15:40:25,024 - models.patchtst - INFO - Epoch   6 | train_loss=0.923967 | val_loss=1.327799
2025-10-31 15:40:35,145 - models.patchtst - INFO - Epoch   7 | train_loss=0.923934 | val_loss=1.328027
2025-10-31 15:40:45,725 - models.patchtst - INFO - Epoch   8 | train_loss=0.923971 | val_loss=1.327790
2025-10-31 15:40:55,824 - models.patchtst - INFO - Epoch   9 | train_loss=0.924017 | val_loss=1.327831
2025-10-31 15:41:06,523 - models.patchtst - INFO - Epoch  10 | train_loss=0.924314 | val_loss=1.327968
2025-10-31 15:41:17,048 - models.patchtst - INFO - Epoch  11 | train_loss=0.924092 | val_loss=1.327922
2025-10-31 15:41:27,543 - models.patchtst - INFO - Epoch  12 | train_loss=0.923883 | val_loss=1.327907
2025-10-31 15:41:37,861 - models.patchtst - INFO - Epoch  13 | train_loss=0.923949 | val_loss=1.327865
2025-10-31 15:41:48,030 - models.patchtst - INFO - Epoch  14 | train_loss=0.923880 | val_loss=1.327905
2025-10-31 15:41:58,309 - models.patchtst - INFO - Epoch  15 | train_loss=0.923922 | val_loss=1.327823
2025-10-31 15:42:08,933 - models.patchtst - INFO - Epoch  16 | train_loss=0.923985 | val_loss=1.327784
2025-10-31 15:42:19,465 - models.patchtst - INFO - Epoch  17 | train_loss=0.923839 | val_loss=1.327730
2025-10-31 15:42:30,062 - models.patchtst - INFO - Epoch  18 | train_loss=0.923902 | val_loss=1.327687
2025-10-31 15:42:40,437 - models.patchtst - INFO - Epoch  19 | train_loss=0.923886 | val_loss=1.327806
2025-10-31 15:42:50,736 - models.patchtst - INFO - Epoch  20 | train_loss=0.923940 | val_loss=1.327795
2025-10-31 15:43:01,241 - models.patchtst - INFO - Epoch  21 | train_loss=0.923929 | val_loss=1.327829
2025-10-31 15:43:11,473 - models.patchtst - INFO - Epoch  22 | train_loss=0.923891 | val_loss=1.327868
2025-10-31 15:43:21,898 - models.patchtst - INFO - Epoch  23 | train_loss=0.923887 | val_loss=1.327762
2025-10-31 15:43:32,311 - models.patchtst - INFO - Epoch  24 | train_loss=0.923936 | val_loss=1.327797
2025-10-31 15:43:42,695 - models.patchtst - INFO - Epoch  25 | train_loss=0.923925 | val_loss=1.327754
2025-10-31 15:43:53,188 - models.patchtst - INFO - Epoch  26 | train_loss=0.923958 | val_loss=1.327727
2025-10-31 15:44:03,785 - models.patchtst - INFO - Epoch  27 | train_loss=0.923980 | val_loss=1.327734
2025-10-31 15:44:14,063 - models.patchtst - INFO - Epoch  28 | train_loss=0.923874 | val_loss=1.327783
2025-10-31 15:44:24,367 - models.patchtst - INFO - Epoch  29 | train_loss=0.923909 | val_loss=1.327835
2025-10-31 15:44:34,775 - models.patchtst - INFO - Epoch  30 | train_loss=0.923892 | val_loss=1.327841
2025-10-31 15:44:45,320 - models.patchtst - INFO - Epoch  31 | train_loss=0.923874 | val_loss=1.327772
2025-10-31 15:44:55,832 - models.patchtst - INFO - Epoch  32 | train_loss=0.923955 | val_loss=1.327753
2025-10-31 15:45:04,022 - models.patchtst - INFO - Epoch  33 | train_loss=0.923890 | val_loss=1.327788
2025-10-31 15:45:04,022 - models.patchtst - INFO - Early stopping at epoch 33早停触发（连续15轮验证损失未下降），最佳验证损失：1.327687
2025-10-31 15:45:04,022 - main - INFO - 训练NHITS...
2025-10-31 15:45:11,968 - models.nhits - INFO - Epoch   1 | train_loss=489095653.310498 | val_loss=3152.715940
2025-10-31 15:45:20,024 - models.nhits - INFO - Epoch   2 | train_loss=405.746615 | val_loss=1.074739
2025-10-31 15:45:28,517 - models.nhits - INFO - Epoch   3 | train_loss=0.483789 | val_loss=0.245722
2025-10-31 15:45:36,724 - models.nhits - INFO - Epoch   4 | train_loss=0.233342 | val_loss=0.098467
2025-10-31 15:45:45,143 - models.nhits - INFO - Epoch   5 | train_loss=0.100315 | val_loss=0.125074
2025-10-31 15:45:53,335 - models.nhits - INFO - Epoch   6 | train_loss=0.130511 | val_loss=0.085337
2025-10-31 15:46:01,379 - models.nhits - INFO - Epoch   7 | train_loss=0.080563 | val_loss=0.114948
2025-10-31 15:46:09,902 - models.nhits - INFO - Epoch   8 | train_loss=5.296878 | val_loss=0.137993
2025-10-31 15:46:17,928 - models.nhits - INFO - Epoch   9 | train_loss=0.071374 | val_loss=0.101499
2025-10-31 15:46:26,042 - models.nhits - INFO - Epoch  10 | train_loss=0.072014 | val_loss=0.133484
2025-10-31 15:46:34,060 - models.nhits - INFO - Epoch  11 | train_loss=0.070031 | val_loss=0.091513
2025-10-31 15:46:42,052 - models.nhits - INFO - Epoch  12 | train_loss=0.068585 | val_loss=0.080133
2025-10-31 15:46:50,061 - models.nhits - INFO - Epoch  13 | train_loss=0.065235 | val_loss=0.082091
2025-10-31 15:46:58,169 - models.nhits - INFO - Epoch  14 | train_loss=0.068331 | val_loss=0.119304
2025-10-31 15:47:06,680 - models.nhits - INFO - Epoch  15 | train_loss=0.063992 | val_loss=0.096098
2025-10-31 15:47:15,536 - models.nhits - INFO - Epoch  16 | train_loss=0.105489 | val_loss=0.089699
2025-10-31 15:47:24,365 - models.nhits - INFO - Epoch  17 | train_loss=0.064401 | val_loss=0.081413
2025-10-31 15:47:32,644 - models.nhits - INFO - Epoch  18 | train_loss=0.062458 | val_loss=0.100864
2025-10-31 15:47:40,753 - models.nhits - INFO - Epoch  19 | train_loss=0.066462 | val_loss=0.083629
2025-10-31 15:47:48,852 - models.nhits - INFO - Epoch  20 | train_loss=0.059988 | val_loss=0.077885
2025-10-31 15:47:56,970 - models.nhits - INFO - Epoch  21 | train_loss=0.064419 | val_loss=0.081294
2025-10-31 15:48:04,949 - models.nhits - INFO - Epoch  22 | train_loss=0.058914 | val_loss=0.074578
2025-10-31 15:48:12,908 - models.nhits - INFO - Epoch  23 | train_loss=0.060278 | val_loss=0.084576
2025-10-31 15:48:21,071 - models.nhits - INFO - Epoch  24 | train_loss=0.201753 | val_loss=0.089741
2025-10-31 15:48:29,023 - models.nhits - INFO - Epoch  25 | train_loss=0.059630 | val_loss=0.096877
2025-10-31 15:48:36,916 - models.nhits - INFO - Epoch  26 | train_loss=0.099338 | val_loss=0.208181
2025-10-31 15:48:44,917 - models.nhits - INFO - Epoch  27 | train_loss=0.073099 | val_loss=0.072956
2025-10-31 15:48:53,112 - models.nhits - INFO - Epoch  28 | train_loss=0.059335 | val_loss=0.088489
2025-10-31 15:49:01,268 - models.nhits - INFO - Epoch  29 | train_loss=0.142197 | val_loss=0.081398
2025-10-31 15:49:09,510 - models.nhits - INFO - Epoch  30 | train_loss=0.057056 | val_loss=0.081621
2025-10-31 15:49:17,525 - models.nhits - INFO - Epoch  31 | train_loss=0.057452 | val_loss=0.076460
2025-10-31 15:49:25,611 - models.nhits - INFO - Epoch  32 | train_loss=0.055477 | val_loss=0.073862
2025-10-31 15:49:33,759 - models.nhits - INFO - Epoch  33 | train_loss=0.066344 | val_loss=0.086352
2025-10-31 15:49:41,892 - models.nhits - INFO - Epoch  34 | train_loss=0.057983 | val_loss=0.099354
2025-10-31 15:49:49,801 - models.nhits - INFO - Epoch  35 | train_loss=0.098034 | val_loss=0.081849
2025-10-31 15:49:58,017 - models.nhits - INFO - Epoch  36 | train_loss=0.056185 | val_loss=0.091025
2025-10-31 15:50:06,179 - models.nhits - INFO - Epoch  37 | train_loss=0.057927 | val_loss=0.095565
2025-10-31 15:50:14,302 - models.nhits - INFO - Epoch  38 | train_loss=0.054361 | val_loss=0.084949
2025-10-31 15:50:22,250 - models.nhits - INFO - Epoch  39 | train_loss=0.046664 | val_loss=0.092809
2025-10-31 15:50:30,180 - models.nhits - INFO - Epoch  40 | train_loss=0.046599 | val_loss=0.070649
2025-10-31 15:50:38,224 - models.nhits - INFO - Epoch  41 | train_loss=0.045264 | val_loss=0.068284
2025-10-31 15:50:46,276 - models.nhits - INFO - Epoch  42 | train_loss=0.045358 | val_loss=0.067349
2025-10-31 15:50:54,301 - models.nhits - INFO - Epoch  43 | train_loss=0.045717 | val_loss=0.066542
2025-10-31 15:51:02,161 - models.nhits - INFO - Epoch  44 | train_loss=0.045401 | val_loss=0.070764
2025-10-31 15:51:10,042 - models.nhits - INFO - Epoch  45 | train_loss=0.045246 | val_loss=0.068988
2025-10-31 15:51:17,927 - models.nhits - INFO - Epoch  46 | train_loss=0.044527 | val_loss=0.063991
2025-10-31 15:51:25,854 - models.nhits - INFO - Epoch  47 | train_loss=0.044653 | val_loss=0.071798
2025-10-31 15:51:33,764 - models.nhits - INFO - Epoch  48 | train_loss=0.045339 | val_loss=0.072215
2025-10-31 15:51:41,608 - models.nhits - INFO - Epoch  49 | train_loss=0.044694 | val_loss=0.072899
2025-10-31 15:51:49,512 - models.nhits - INFO - Epoch  50 | train_loss=0.044454 | val_loss=0.064443
2025-10-31 15:51:57,480 - models.nhits - INFO - Epoch  51 | train_loss=0.044538 | val_loss=0.070821
2025-10-31 15:52:05,526 - models.nhits - INFO - Epoch  52 | train_loss=0.044154 | val_loss=0.065720
2025-10-31 15:52:13,988 - models.nhits - INFO - Epoch  53 | train_loss=0.047175 | val_loss=0.065633
2025-10-31 15:52:22,336 - models.nhits - INFO - Epoch  54 | train_loss=0.043859 | val_loss=0.071740
2025-10-31 15:52:30,562 - models.nhits - INFO - Epoch  55 | train_loss=0.043501 | val_loss=0.071726
2025-10-31 15:52:38,753 - models.nhits - INFO - Epoch  56 | train_loss=0.050849 | val_loss=0.091997
2025-10-31 15:52:46,909 - models.nhits - INFO - Epoch  57 | train_loss=0.045089 | val_loss=0.068903
2025-10-31 15:52:55,031 - models.nhits - INFO - Epoch  58 | train_loss=0.040156 | val_loss=0.066100
2025-10-31 15:53:03,248 - models.nhits - INFO - Epoch  59 | train_loss=0.039875 | val_loss=0.062749
2025-10-31 15:53:11,554 - models.nhits - INFO - Epoch  60 | train_loss=0.040133 | val_loss=0.065897
2025-10-31 15:53:19,724 - models.nhits - INFO - Epoch  61 | train_loss=0.039443 | val_loss=0.065793
2025-10-31 15:53:27,963 - models.nhits - INFO - Epoch  62 | train_loss=0.039330 | val_loss=0.065678
2025-10-31 15:53:36,163 - models.nhits - INFO - Epoch  63 | train_loss=0.039476 | val_loss=0.065348
2025-10-31 15:53:44,194 - models.nhits - INFO - Epoch  64 | train_loss=0.039179 | val_loss=0.067882
2025-10-31 15:53:52,262 - models.nhits - INFO - Epoch  65 | train_loss=0.038955 | val_loss=0.068782
2025-10-31 15:54:00,386 - models.nhits - INFO - Epoch  66 | train_loss=0.039140 | val_loss=0.064217
2025-10-31 15:54:08,492 - models.nhits - INFO - Epoch  67 | train_loss=0.039087 | val_loss=0.065272
2025-10-31 15:54:16,612 - models.nhits - INFO - Epoch  68 | train_loss=0.038954 | val_loss=0.067954
2025-10-31 15:54:24,705 - models.nhits - INFO - Epoch  69 | train_loss=0.038856 | val_loss=0.063788
2025-10-31 15:54:32,801 - models.nhits - INFO - Epoch  70 | train_loss=0.038798 | val_loss=0.068440
2025-10-31 15:54:40,795 - models.nhits - INFO - Epoch  71 | train_loss=0.036739 | val_loss=0.064809
2025-10-31 15:54:48,861 - models.nhits - INFO - Epoch  72 | train_loss=0.036566 | val_loss=0.063497
2025-10-31 15:54:57,228 - models.nhits - INFO - Epoch  73 | train_loss=0.036631 | val_loss=0.063886
2025-10-31 15:55:05,949 - models.nhits - INFO - Epoch  74 | train_loss=0.036275 | val_loss=0.063817
2025-10-31 15:55:05,950 - models.nhits - INFO - Early stopping at epoch 74早停触发（连续15轮验证损失未下降），最佳验证损失：0.062749
2025-10-31 15:55:05,972 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_153917/patchtst_model.pth
2025-10-31 15:55:06,001 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_153917/nhits_model.pth
2025-10-31 15:55:06,001 - main - INFO - 专家模型训练完成
2025-10-31 15:55:06,004 - main - INFO - 获取专家模型预测...
2025-10-31 15:55:18,661 - main - INFO - 专家预测获取完成
2025-10-31 15:55:18,662 - main - INFO - 实现策略A：静态优化权重...
2025-10-31 15:55:19,327 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-10-31 15:55:19,335 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = 0.251383
2025-10-31 15:55:19,337 - __main__ - ERROR - 实验失败: '<' not supported between instances of 'numpy.ndarray' and 'str'
2025-10-31 19:05:44,502 - __main__ - INFO - 初始化实验...
2025-10-31 19:05:44,512 - main - INFO - 使用设备: cuda
2025-10-31 19:05:44,515 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 19:05:44,515 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 19:05:44,515 - main - INFO - 开始数据加载和预处理...
2025-10-31 19:05:44,524 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 19:05:46,705 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 19:05:46,708 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:05:46,711 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 19:05:46,713 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:05:46,719 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 19:05:46,719 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 19:05:46,794 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 19:05:46,794 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 19:05:46,794 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 19:05:46,795 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 19:05:46,795 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 19:05:46,859 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 19:05:46,859 - main - INFO - 数据预处理完成:
2025-10-31 19:05:46,859 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 19:05:46,859 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 19:05:46,859 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 19:05:46,859 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 19:05:46,861 - main - INFO - 开始训练专家模型...
2025-10-31 19:05:46,861 - main - INFO - 创建PatchTST模型...
2025-10-31 19:05:46,906 - main - INFO - 创建NHITS模型...
2025-10-31 19:05:46,981 - main - INFO - 训练PatchTST...
2025-10-31 19:05:58,371 - models.patchtst - INFO - Epoch   1 | train_loss=0.927905 | val_loss=1.327706
2025-10-31 19:06:06,209 - models.patchtst - INFO - Epoch   2 | train_loss=0.924078 | val_loss=1.327847
2025-10-31 19:06:13,263 - models.patchtst - INFO - Epoch   3 | train_loss=0.923897 | val_loss=1.327648
2025-10-31 19:06:20,409 - models.patchtst - INFO - Epoch   4 | train_loss=0.924024 | val_loss=1.327782
2025-10-31 19:06:27,701 - models.patchtst - INFO - Epoch   5 | train_loss=0.923970 | val_loss=1.327686
2025-10-31 19:06:27,701 - main - INFO - 训练NHITS...
2025-10-31 19:06:35,681 - models.nhits - INFO - Epoch   1 | train_loss=270561872.983907 | val_loss=467.550551
2025-10-31 19:06:43,592 - models.nhits - INFO - Epoch   2 | train_loss=106.032330 | val_loss=1.256432
2025-10-31 19:06:51,445 - models.nhits - INFO - Epoch   3 | train_loss=1.016784 | val_loss=0.235574
2025-10-31 19:06:59,376 - models.nhits - INFO - Epoch   4 | train_loss=0.143393 | val_loss=0.065247
2025-10-31 19:07:07,249 - models.nhits - INFO - Epoch   5 | train_loss=0.045890 | val_loss=0.052084
2025-10-31 19:07:07,265 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_190544/patchtst_model.pth
2025-10-31 19:07:07,292 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_190544/nhits_model.pth
2025-10-31 19:07:07,292 - main - INFO - 专家模型训练完成
2025-10-31 19:07:07,295 - main - INFO - 获取专家模型预测...
2025-10-31 19:07:19,718 - main - INFO - 专家预测获取完成
2025-10-31 19:07:19,719 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 19:07:19,719 - main - INFO - 实现策略A：静态优化权重...
2025-10-31 19:07:20,339 - src.strategies.mpa_optimizer - INFO - 迭代 0: 最优适应度 = inf
2025-10-31 19:07:20,347 - src.strategies.mpa_optimizer - INFO - 迭代 10: 最优适应度 = inf
2025-10-31 19:07:20,347 - __main__ - ERROR - 实验失败: '<' not supported between instances of 'numpy.ndarray' and 'str'
2025-10-31 19:18:53,806 - __main__ - INFO - 初始化实验...
2025-10-31 19:18:53,815 - main - INFO - 使用设备: cuda
2025-10-31 19:18:53,817 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 19:18:53,817 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 19:18:53,818 - main - INFO - 开始数据加载和预处理...
2025-10-31 19:18:53,825 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 19:18:55,922 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 19:18:55,925 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:18:55,928 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 19:18:55,932 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 19:18:55,940 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 19:18:55,940 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 19:18:56,039 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 19:18:56,040 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 19:18:56,131 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 19:18:56,131 - main - INFO - 数据预处理完成:
2025-10-31 19:18:56,132 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 19:18:56,132 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 19:18:56,132 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 19:18:56,132 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 19:18:56,132 - main - INFO - 开始训练专家模型...
2025-10-31 19:18:56,132 - main - INFO - 创建PatchTST模型...
2025-10-31 19:18:56,152 - main - INFO - 创建NHITS模型...
2025-10-31 19:18:56,239 - main - INFO - 训练PatchTST...
2025-10-31 19:19:05,692 - models.patchtst - INFO - Epoch   1 | train_loss=0.930020 | val_loss=1.327765
2025-10-31 19:19:12,850 - models.patchtst - INFO - Epoch   2 | train_loss=0.923965 | val_loss=1.327681
2025-10-31 19:19:19,830 - models.patchtst - INFO - Epoch   3 | train_loss=0.923927 | val_loss=1.327925
2025-10-31 19:19:26,881 - models.patchtst - INFO - Epoch   4 | train_loss=0.923984 | val_loss=1.327996
2025-10-31 19:19:34,075 - models.patchtst - INFO - Epoch   5 | train_loss=0.923964 | val_loss=1.327919
2025-10-31 19:19:34,076 - main - INFO - 训练NHITS...
2025-10-31 19:19:41,965 - models.nhits - INFO - Epoch   1 | train_loss=1024214555.330064 | val_loss=700.984497
2025-10-31 19:19:49,892 - models.nhits - INFO - Epoch   2 | train_loss=256.355035 | val_loss=3.160791
2025-10-31 19:19:57,863 - models.nhits - INFO - Epoch   3 | train_loss=0.625988 | val_loss=0.171291
2025-10-31 19:20:05,951 - models.nhits - INFO - Epoch   4 | train_loss=0.127113 | val_loss=0.079061
2025-10-31 19:20:14,042 - models.nhits - INFO - Epoch   5 | train_loss=0.047931 | val_loss=0.070744
2025-10-31 19:20:14,063 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_191853/patchtst_model.pth
2025-10-31 19:20:14,093 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_191853/nhits_model.pth
2025-10-31 19:20:14,093 - main - INFO - 专家模型训练完成
2025-10-31 19:20:14,097 - main - INFO - 获取专家模型预测...
2025-10-31 19:20:26,706 - main - INFO - 专家预测获取完成
2025-10-31 19:20:26,706 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 19:20:26,707 - main - INFO - 实现策略A：静态优化权重...
2025-10-31 19:20:27,382 - __main__ - ERROR - 实验失败: __init__() got an unexpected keyword argument 'quick_iterations'
2025-10-31 21:02:57,924 - __main__ - INFO - 初始化实验...
2025-10-31 21:02:57,932 - main - INFO - 使用设备: cuda
2025-10-31 21:02:57,934 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 21:02:57,934 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 21:02:57,934 - main - INFO - 开始数据加载和预处理...
2025-10-31 21:02:57,943 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 21:02:59,991 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 21:02:59,994 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:02:59,996 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 21:02:59,999 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:03:00,006 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 21:03:00,006 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 21:03:00,109 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 21:03:00,109 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 21:03:00,111 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 21:03:00,111 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 21:03:00,111 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 21:03:00,195 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 21:03:00,195 - main - INFO - 数据预处理完成:
2025-10-31 21:03:00,196 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 21:03:00,196 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 21:03:00,196 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 21:03:00,196 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 21:03:00,196 - main - INFO - 开始训练专家模型...
2025-10-31 21:03:00,196 - main - INFO - 创建PatchTST模型...
2025-10-31 21:03:00,210 - main - INFO - 创建NHITS模型...
2025-10-31 21:03:00,291 - main - INFO - 训练PatchTST...
2025-10-31 21:03:09,814 - models.patchtst - INFO - Epoch   1 | train_loss=0.926916 | val_loss=1.327601
2025-10-31 21:03:16,890 - models.patchtst - INFO - Epoch   2 | train_loss=0.923928 | val_loss=1.327772
2025-10-31 21:03:24,117 - models.patchtst - INFO - Epoch   3 | train_loss=0.923982 | val_loss=1.327709
2025-10-31 21:03:31,041 - models.patchtst - INFO - Epoch   4 | train_loss=0.924158 | val_loss=1.327947
2025-10-31 21:03:38,103 - models.patchtst - INFO - Epoch   5 | train_loss=0.923976 | val_loss=1.327727
2025-10-31 21:03:45,255 - models.patchtst - INFO - Epoch   6 | train_loss=0.923960 | val_loss=1.327616
2025-10-31 21:03:52,232 - models.patchtst - INFO - Epoch   7 | train_loss=0.923922 | val_loss=1.327895
2025-10-31 21:03:59,274 - models.patchtst - INFO - Epoch   8 | train_loss=0.923970 | val_loss=1.328070
2025-10-31 21:04:06,345 - models.patchtst - INFO - Epoch   9 | train_loss=0.924055 | val_loss=1.327914
2025-10-31 21:04:13,341 - models.patchtst - INFO - Epoch  10 | train_loss=0.923974 | val_loss=1.327924
2025-10-31 21:04:20,415 - models.patchtst - INFO - Epoch  11 | train_loss=0.923995 | val_loss=1.327872
2025-10-31 21:04:27,428 - models.patchtst - INFO - Epoch  12 | train_loss=0.923891 | val_loss=1.327721
2025-10-31 21:04:34,393 - models.patchtst - INFO - Epoch  13 | train_loss=0.923946 | val_loss=1.327719
2025-10-31 21:04:41,432 - models.patchtst - INFO - Epoch  14 | train_loss=0.923890 | val_loss=1.327796
2025-10-31 21:04:48,505 - models.patchtst - INFO - Epoch  15 | train_loss=0.923971 | val_loss=1.327792
2025-10-31 21:04:55,575 - models.patchtst - INFO - Epoch  16 | train_loss=0.923915 | val_loss=1.327738
2025-10-31 21:04:55,575 - models.patchtst - INFO - Early stopping at epoch 16早停触发（连续15轮验证损失未下降），最佳验证损失：1.327601
2025-10-31 21:04:55,575 - main - INFO - 训练NHITS...
2025-10-31 21:05:03,547 - models.nhits - INFO - Epoch   1 | train_loss=142982947.711818 | val_loss=1514.754999
2025-10-31 21:05:11,464 - models.nhits - INFO - Epoch   2 | train_loss=130.079976 | val_loss=1.667725
2025-10-31 21:05:19,415 - models.nhits - INFO - Epoch   3 | train_loss=1.202995 | val_loss=0.130437
2025-10-31 21:05:27,343 - models.nhits - INFO - Epoch   4 | train_loss=0.228182 | val_loss=0.103175
2025-10-31 21:05:35,312 - models.nhits - INFO - Epoch   5 | train_loss=0.231288 | val_loss=0.099406
2025-10-31 21:05:43,355 - models.nhits - INFO - Epoch   6 | train_loss=0.065731 | val_loss=0.060304
2025-10-31 21:05:51,311 - models.nhits - INFO - Epoch   7 | train_loss=0.052798 | val_loss=0.056530
2025-10-31 21:05:59,276 - models.nhits - INFO - Epoch   8 | train_loss=0.057506 | val_loss=0.053902
2025-10-31 21:06:07,229 - models.nhits - INFO - Epoch   9 | train_loss=0.048899 | val_loss=0.074760
2025-10-31 21:06:15,286 - models.nhits - INFO - Epoch  10 | train_loss=0.045761 | val_loss=0.083458
2025-10-31 21:06:23,282 - models.nhits - INFO - Epoch  11 | train_loss=0.045600 | val_loss=0.052253
2025-10-31 21:06:31,273 - models.nhits - INFO - Epoch  12 | train_loss=0.076082 | val_loss=0.341558
2025-10-31 21:06:39,345 - models.nhits - INFO - Epoch  13 | train_loss=0.050670 | val_loss=0.086635
2025-10-31 21:06:47,326 - models.nhits - INFO - Epoch  14 | train_loss=0.044703 | val_loss=0.063842
2025-10-31 21:06:55,300 - models.nhits - INFO - Epoch  15 | train_loss=0.051401 | val_loss=0.049234
2025-10-31 21:07:03,283 - models.nhits - INFO - Epoch  16 | train_loss=0.041276 | val_loss=0.045644
2025-10-31 21:07:11,249 - models.nhits - INFO - Epoch  17 | train_loss=0.042849 | val_loss=0.044168
2025-10-31 21:07:19,584 - models.nhits - INFO - Epoch  18 | train_loss=0.038671 | val_loss=0.056054
2025-10-31 21:07:28,095 - models.nhits - INFO - Epoch  19 | train_loss=0.040108 | val_loss=0.045978
2025-10-31 21:07:36,184 - models.nhits - INFO - Epoch  20 | train_loss=1.298016 | val_loss=0.046306
2025-10-31 21:07:44,198 - models.nhits - INFO - Epoch  21 | train_loss=0.038271 | val_loss=0.062345
2025-10-31 21:07:52,233 - models.nhits - INFO - Epoch  22 | train_loss=0.047609 | val_loss=0.048151
2025-10-31 21:08:00,450 - models.nhits - INFO - Epoch  23 | train_loss=0.036704 | val_loss=0.046305
2025-10-31 21:08:08,578 - models.nhits - INFO - Epoch  24 | train_loss=0.074860 | val_loss=0.065706
2025-10-31 21:08:16,567 - models.nhits - INFO - Epoch  25 | train_loss=0.036292 | val_loss=0.048570
2025-10-31 21:08:24,553 - models.nhits - INFO - Epoch  26 | train_loss=0.035327 | val_loss=0.041565
2025-10-31 21:08:32,529 - models.nhits - INFO - Epoch  27 | train_loss=0.035523 | val_loss=0.048226
2025-10-31 21:08:40,501 - models.nhits - INFO - Epoch  28 | train_loss=0.034804 | val_loss=0.041441
2025-10-31 21:08:48,510 - models.nhits - INFO - Epoch  29 | train_loss=0.035074 | val_loss=0.041917
2025-10-31 21:08:56,470 - models.nhits - INFO - Epoch  30 | train_loss=0.034058 | val_loss=0.041676
2025-10-31 21:09:04,474 - models.nhits - INFO - Epoch  31 | train_loss=0.242359 | val_loss=0.041595
2025-10-31 21:09:12,456 - models.nhits - INFO - Epoch  32 | train_loss=0.047400 | val_loss=0.045587
2025-10-31 21:09:20,410 - models.nhits - INFO - Epoch  33 | train_loss=0.033943 | val_loss=0.046173
2025-10-31 21:09:28,419 - models.nhits - INFO - Epoch  34 | train_loss=0.036755 | val_loss=0.039728
2025-10-31 21:09:36,408 - models.nhits - INFO - Epoch  35 | train_loss=0.033391 | val_loss=0.043310
2025-10-31 21:09:44,387 - models.nhits - INFO - Epoch  36 | train_loss=0.038665 | val_loss=0.042405
2025-10-31 21:09:52,348 - models.nhits - INFO - Epoch  37 | train_loss=0.032855 | val_loss=0.046185
2025-10-31 21:10:00,334 - models.nhits - INFO - Epoch  38 | train_loss=0.034068 | val_loss=0.047578
2025-10-31 21:10:08,363 - models.nhits - INFO - Epoch  39 | train_loss=0.035887 | val_loss=0.042102
2025-10-31 21:10:16,407 - models.nhits - INFO - Epoch  40 | train_loss=0.037007 | val_loss=0.043212
2025-10-31 21:10:24,408 - models.nhits - INFO - Epoch  41 | train_loss=0.030886 | val_loss=0.052215
2025-10-31 21:10:32,411 - models.nhits - INFO - Epoch  42 | train_loss=0.032378 | val_loss=0.042312
2025-10-31 21:10:40,423 - models.nhits - INFO - Epoch  43 | train_loss=0.032044 | val_loss=0.044116
2025-10-31 21:10:48,429 - models.nhits - INFO - Epoch  44 | train_loss=5.765156 | val_loss=0.039500
2025-10-31 21:10:56,428 - models.nhits - INFO - Epoch  45 | train_loss=0.065386 | val_loss=0.043489
2025-10-31 21:11:04,432 - models.nhits - INFO - Epoch  46 | train_loss=0.031535 | val_loss=0.051461
2025-10-31 21:11:12,416 - models.nhits - INFO - Epoch  47 | train_loss=0.030934 | val_loss=0.046427
2025-10-31 21:11:20,426 - models.nhits - INFO - Epoch  48 | train_loss=0.035333 | val_loss=0.042915
2025-10-31 21:11:28,445 - models.nhits - INFO - Epoch  49 | train_loss=0.031391 | val_loss=0.041501
2025-10-31 21:11:36,586 - models.nhits - INFO - Epoch  50 | train_loss=0.031382 | val_loss=0.052912
2025-10-31 21:11:45,588 - models.nhits - INFO - Epoch  51 | train_loss=0.038305 | val_loss=0.054292
2025-10-31 21:11:53,713 - models.nhits - INFO - Epoch  52 | train_loss=0.136137 | val_loss=0.039216
2025-10-31 21:12:01,703 - models.nhits - INFO - Epoch  53 | train_loss=0.111808 | val_loss=0.045285
2025-10-31 21:12:09,872 - models.nhits - INFO - Epoch  54 | train_loss=0.030060 | val_loss=0.046130
2025-10-31 21:12:17,979 - models.nhits - INFO - Epoch  55 | train_loss=0.039120 | val_loss=0.040634
2025-10-31 21:12:25,993 - models.nhits - INFO - Epoch  56 | train_loss=0.065822 | val_loss=0.038994
2025-10-31 21:12:34,197 - models.nhits - INFO - Epoch  57 | train_loss=0.033159 | val_loss=0.045349
2025-10-31 21:12:42,528 - models.nhits - INFO - Epoch  58 | train_loss=0.028405 | val_loss=0.055631
2025-10-31 21:12:50,550 - models.nhits - INFO - Epoch  59 | train_loss=0.032979 | val_loss=0.049105
2025-10-31 21:12:58,591 - models.nhits - INFO - Epoch  60 | train_loss=0.188996 | val_loss=0.037810
2025-10-31 21:13:06,597 - models.nhits - INFO - Epoch  61 | train_loss=0.030282 | val_loss=0.039445
2025-10-31 21:13:14,701 - models.nhits - INFO - Epoch  62 | train_loss=0.030935 | val_loss=0.039325
2025-10-31 21:13:22,766 - models.nhits - INFO - Epoch  63 | train_loss=0.069694 | val_loss=0.037508
2025-10-31 21:13:30,866 - models.nhits - INFO - Epoch  64 | train_loss=0.030165 | val_loss=0.038911
2025-10-31 21:13:39,020 - models.nhits - INFO - Epoch  65 | train_loss=0.026565 | val_loss=0.047248
2025-10-31 21:13:47,203 - models.nhits - INFO - Epoch  66 | train_loss=0.033255 | val_loss=0.042888
2025-10-31 21:13:55,484 - models.nhits - INFO - Epoch  67 | train_loss=0.028648 | val_loss=0.040129
2025-10-31 21:14:03,788 - models.nhits - INFO - Epoch  68 | train_loss=47.118838 | val_loss=0.042943
2025-10-31 21:14:12,164 - models.nhits - INFO - Epoch  69 | train_loss=0.292673 | val_loss=0.176266
2025-10-31 21:14:20,228 - models.nhits - INFO - Epoch  70 | train_loss=0.032399 | val_loss=0.051224
2025-10-31 21:14:28,272 - models.nhits - INFO - Epoch  71 | train_loss=0.029789 | val_loss=0.044848
2025-10-31 21:14:36,337 - models.nhits - INFO - Epoch  72 | train_loss=0.028059 | val_loss=0.038437
2025-10-31 21:14:44,332 - models.nhits - INFO - Epoch  73 | train_loss=0.029904 | val_loss=0.037334
2025-10-31 21:14:52,336 - models.nhits - INFO - Epoch  74 | train_loss=0.028920 | val_loss=0.043037
2025-10-31 21:15:00,387 - models.nhits - INFO - Epoch  75 | train_loss=0.035737 | val_loss=0.073674
2025-10-31 21:15:08,500 - models.nhits - INFO - Epoch  76 | train_loss=0.033365 | val_loss=0.044557
2025-10-31 21:15:16,597 - models.nhits - INFO - Epoch  77 | train_loss=0.029004 | val_loss=0.044196
2025-10-31 21:15:25,236 - models.nhits - INFO - Epoch  78 | train_loss=0.028099 | val_loss=0.039354
2025-10-31 21:15:33,853 - models.nhits - INFO - Epoch  79 | train_loss=0.028453 | val_loss=0.052511
2025-10-31 21:15:43,763 - models.nhits - INFO - Epoch  80 | train_loss=0.345870 | val_loss=0.071732
2025-10-31 21:15:52,821 - models.nhits - INFO - Epoch  81 | train_loss=0.028659 | val_loss=0.042390
2025-10-31 21:16:01,847 - models.nhits - INFO - Epoch  82 | train_loss=0.029802 | val_loss=0.053331
2025-10-31 21:16:10,675 - models.nhits - INFO - Epoch  83 | train_loss=1.182726 | val_loss=0.038260
2025-10-31 21:16:19,680 - models.nhits - INFO - Epoch  84 | train_loss=0.029512 | val_loss=0.103662
2025-10-31 21:16:28,630 - models.nhits - INFO - Epoch  85 | train_loss=0.022505 | val_loss=0.038246
2025-10-31 21:16:38,271 - models.nhits - INFO - Epoch  86 | train_loss=0.021942 | val_loss=0.037403
2025-10-31 21:16:47,617 - models.nhits - INFO - Epoch  87 | train_loss=0.021236 | val_loss=0.033014
2025-10-31 21:16:56,513 - models.nhits - INFO - Epoch  88 | train_loss=0.021628 | val_loss=0.035256
2025-10-31 21:17:05,662 - models.nhits - INFO - Epoch  89 | train_loss=0.021789 | val_loss=0.040558
2025-10-31 21:17:15,183 - models.nhits - INFO - Epoch  90 | train_loss=0.021653 | val_loss=0.041198
2025-10-31 21:17:27,099 - models.nhits - INFO - Epoch  91 | train_loss=0.026253 | val_loss=0.034771
2025-10-31 21:17:38,598 - models.nhits - INFO - Epoch  92 | train_loss=0.021398 | val_loss=0.037746
2025-10-31 21:17:49,716 - models.nhits - INFO - Epoch  93 | train_loss=0.021297 | val_loss=0.036036
2025-10-31 21:18:02,312 - models.nhits - INFO - Epoch  94 | train_loss=0.020776 | val_loss=0.038880
2025-10-31 21:18:14,118 - models.nhits - INFO - Epoch  95 | train_loss=0.021056 | val_loss=0.042095
2025-10-31 21:18:26,734 - models.nhits - INFO - Epoch  96 | train_loss=0.021390 | val_loss=0.041710
2025-10-31 21:18:38,638 - models.nhits - INFO - Epoch  97 | train_loss=0.021283 | val_loss=0.035061
2025-10-31 21:18:50,704 - models.nhits - INFO - Epoch  98 | train_loss=0.021016 | val_loss=0.036317
2025-10-31 21:19:01,253 - models.nhits - INFO - Epoch  99 | train_loss=0.018275 | val_loss=0.035375
2025-10-31 21:19:10,941 - models.nhits - INFO - Epoch 100 | train_loss=0.018281 | val_loss=0.035102
2025-10-31 21:19:10,962 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_210257/patchtst_model.pth
2025-10-31 21:19:10,993 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_210257/nhits_model.pth
2025-10-31 21:19:10,993 - main - INFO - 专家模型训练完成
2025-10-31 21:19:10,997 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 21:19:10,997 - __main__ - ERROR - 实验失败: 'FloatingWindPlatformExperiment' object has no attribute 'implement_strategy_a_quick'
2025-10-31 21:35:22,712 - __main__ - INFO - 初始化实验...
2025-10-31 21:35:22,722 - main - INFO - 使用设备: cuda
2025-10-31 21:35:22,723 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-10-31 21:35:22,724 - __main__ - INFO - 步骤1: 加载真实数据...
2025-10-31 21:35:22,724 - main - INFO - 开始数据加载和预处理...
2025-10-31 21:35:22,732 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-10-31 21:35:24,917 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-10-31 21:35:24,921 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:35:24,924 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-10-31 21:35:24,926 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-10-31 21:35:24,935 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-10-31 21:35:24,935 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-10-31 21:35:25,033 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-10-31 21:35:25,034 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-10-31 21:35:25,109 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-10-31 21:35:25,109 - main - INFO - 数据预处理完成:
2025-10-31 21:35:25,109 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-10-31 21:35:25,109 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-10-31 21:35:25,109 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-10-31 21:35:25,109 - __main__ - INFO - 步骤2: 快速训练模型...
2025-10-31 21:35:25,109 - main - INFO - 开始训练专家模型...
2025-10-31 21:35:25,109 - main - INFO - 创建PatchTST模型...
2025-10-31 21:35:25,157 - main - INFO - 创建NHITS模型...
2025-10-31 21:35:25,226 - main - INFO - 训练PatchTST...
2025-10-31 21:35:36,247 - models.patchtst - INFO - Epoch   1 | train_loss=0.928080 | val_loss=1.327706
2025-10-31 21:35:43,130 - models.patchtst - INFO - Epoch   2 | train_loss=0.923948 | val_loss=1.327678
2025-10-31 21:35:50,105 - models.patchtst - INFO - Epoch   3 | train_loss=0.924003 | val_loss=1.327883
2025-10-31 21:35:57,080 - models.patchtst - INFO - Epoch   4 | train_loss=0.923788 | val_loss=1.327719
2025-10-31 21:36:04,063 - models.patchtst - INFO - Epoch   5 | train_loss=0.924010 | val_loss=1.327766
2025-10-31 21:36:11,071 - models.patchtst - INFO - Epoch   6 | train_loss=0.923948 | val_loss=1.327622
2025-10-31 21:36:18,119 - models.patchtst - INFO - Epoch   7 | train_loss=0.924027 | val_loss=1.327860
2025-10-31 21:36:25,173 - models.patchtst - INFO - Epoch   8 | train_loss=0.924009 | val_loss=1.327694
2025-10-31 21:36:32,158 - models.patchtst - INFO - Epoch   9 | train_loss=0.923930 | val_loss=1.328088
2025-10-31 21:36:39,204 - models.patchtst - INFO - Epoch  10 | train_loss=0.924005 | val_loss=1.327803
2025-10-31 21:36:46,290 - models.patchtst - INFO - Epoch  11 | train_loss=0.923967 | val_loss=1.327930
2025-10-31 21:36:53,328 - models.patchtst - INFO - Epoch  12 | train_loss=0.923949 | val_loss=1.327836
2025-10-31 21:37:00,367 - models.patchtst - INFO - Epoch  13 | train_loss=0.923964 | val_loss=1.327859
2025-10-31 21:37:07,380 - models.patchtst - INFO - Epoch  14 | train_loss=0.923942 | val_loss=1.327787
2025-10-31 21:37:14,396 - models.patchtst - INFO - Epoch  15 | train_loss=0.924009 | val_loss=1.327747
2025-10-31 21:37:21,412 - models.patchtst - INFO - Epoch  16 | train_loss=0.923937 | val_loss=1.327788
2025-10-31 21:37:28,490 - models.patchtst - INFO - Epoch  17 | train_loss=0.923896 | val_loss=1.327752
2025-10-31 21:37:35,493 - models.patchtst - INFO - Epoch  18 | train_loss=0.923872 | val_loss=1.327772
2025-10-31 21:37:42,515 - models.patchtst - INFO - Epoch  19 | train_loss=0.923922 | val_loss=1.327764
2025-10-31 21:37:49,607 - models.patchtst - INFO - Epoch  20 | train_loss=0.923960 | val_loss=1.327761
2025-10-31 21:37:57,647 - models.patchtst - INFO - Epoch  21 | train_loss=0.923935 | val_loss=1.327817
2025-10-31 21:37:57,648 - models.patchtst - INFO - Early stopping at epoch 21早停触发（连续15轮验证损失未下降），最佳验证损失：1.327622
2025-10-31 21:37:57,648 - main - INFO - 训练NHITS...
2025-10-31 21:38:05,923 - models.nhits - INFO - Epoch   1 | train_loss=750734327.880695 | val_loss=1147.181169
2025-10-31 21:38:13,994 - models.nhits - INFO - Epoch   2 | train_loss=219.628506 | val_loss=3.259921
2025-10-31 21:38:21,978 - models.nhits - INFO - Epoch   3 | train_loss=3.093509 | val_loss=0.466180
2025-10-31 21:38:29,969 - models.nhits - INFO - Epoch   4 | train_loss=0.499598 | val_loss=0.387020
2025-10-31 21:38:38,018 - models.nhits - INFO - Epoch   5 | train_loss=2.780571 | val_loss=0.164792
2025-10-31 21:38:46,036 - models.nhits - INFO - Epoch   6 | train_loss=0.119748 | val_loss=0.129999
2025-10-31 21:38:54,325 - models.nhits - INFO - Epoch   7 | train_loss=0.079232 | val_loss=0.073625
2025-10-31 21:39:02,352 - models.nhits - INFO - Epoch   8 | train_loss=0.069915 | val_loss=0.075808
2025-10-31 21:39:10,524 - models.nhits - INFO - Epoch   9 | train_loss=0.053183 | val_loss=0.078125
2025-10-31 21:39:18,692 - models.nhits - INFO - Epoch  10 | train_loss=0.049835 | val_loss=0.052442
2025-10-31 21:39:26,956 - models.nhits - INFO - Epoch  11 | train_loss=0.323329 | val_loss=1.056833
2025-10-31 21:39:35,062 - models.nhits - INFO - Epoch  12 | train_loss=0.063813 | val_loss=0.054940
2025-10-31 21:39:43,123 - models.nhits - INFO - Epoch  13 | train_loss=0.066745 | val_loss=0.060327
2025-10-31 21:39:51,166 - models.nhits - INFO - Epoch  14 | train_loss=0.043901 | val_loss=0.047261
2025-10-31 21:39:59,157 - models.nhits - INFO - Epoch  15 | train_loss=0.043636 | val_loss=0.051003
2025-10-31 21:40:07,157 - models.nhits - INFO - Epoch  16 | train_loss=0.053498 | val_loss=0.058081
2025-10-31 21:40:15,232 - models.nhits - INFO - Epoch  17 | train_loss=41.290640 | val_loss=0.041484
2025-10-31 21:40:23,261 - models.nhits - INFO - Epoch  18 | train_loss=0.044726 | val_loss=0.046671
2025-10-31 21:40:31,253 - models.nhits - INFO - Epoch  19 | train_loss=0.040665 | val_loss=0.042061
2025-10-31 21:40:39,316 - models.nhits - INFO - Epoch  20 | train_loss=0.040241 | val_loss=0.051929
2025-10-31 21:40:47,400 - models.nhits - INFO - Epoch  21 | train_loss=0.038298 | val_loss=0.041468
2025-10-31 21:40:55,458 - models.nhits - INFO - Epoch  22 | train_loss=0.056028 | val_loss=0.054501
2025-10-31 21:41:03,497 - models.nhits - INFO - Epoch  23 | train_loss=0.039917 | val_loss=0.049625
2025-10-31 21:41:11,477 - models.nhits - INFO - Epoch  24 | train_loss=0.036927 | val_loss=0.052381
2025-10-31 21:41:19,545 - models.nhits - INFO - Epoch  25 | train_loss=0.530970 | val_loss=0.983734
2025-10-31 21:41:27,747 - models.nhits - INFO - Epoch  26 | train_loss=3.684395 | val_loss=0.049798
2025-10-31 21:41:35,841 - models.nhits - INFO - Epoch  27 | train_loss=0.036922 | val_loss=0.056886
2025-10-31 21:41:44,101 - models.nhits - INFO - Epoch  28 | train_loss=0.041543 | val_loss=0.082478
2025-10-31 21:41:52,167 - models.nhits - INFO - Epoch  29 | train_loss=0.041158 | val_loss=0.047388
2025-10-31 21:42:00,213 - models.nhits - INFO - Epoch  30 | train_loss=0.034233 | val_loss=0.042643
2025-10-31 21:42:08,343 - models.nhits - INFO - Epoch  31 | train_loss=0.035207 | val_loss=0.045391
2025-10-31 21:42:16,437 - models.nhits - INFO - Epoch  32 | train_loss=2.049623 | val_loss=0.047176
2025-10-31 21:42:24,520 - models.nhits - INFO - Epoch  33 | train_loss=0.027206 | val_loss=0.037200
2025-10-31 21:42:32,480 - models.nhits - INFO - Epoch  34 | train_loss=0.026762 | val_loss=0.038474
2025-10-31 21:42:40,609 - models.nhits - INFO - Epoch  35 | train_loss=0.026601 | val_loss=0.035195
2025-10-31 21:42:48,623 - models.nhits - INFO - Epoch  36 | train_loss=0.026784 | val_loss=0.038415
2025-10-31 21:42:56,753 - models.nhits - INFO - Epoch  37 | train_loss=0.026438 | val_loss=0.034648
2025-10-31 21:43:04,975 - models.nhits - INFO - Epoch  38 | train_loss=0.025260 | val_loss=0.037819
2025-10-31 21:43:12,963 - models.nhits - INFO - Epoch  39 | train_loss=0.025626 | val_loss=0.040879
2025-10-31 21:43:20,953 - models.nhits - INFO - Epoch  40 | train_loss=0.025284 | val_loss=0.036722
2025-10-31 21:43:28,978 - models.nhits - INFO - Epoch  41 | train_loss=0.024860 | val_loss=0.038360
2025-10-31 21:43:36,975 - models.nhits - INFO - Epoch  42 | train_loss=0.024856 | val_loss=0.040802
2025-10-31 21:43:44,995 - models.nhits - INFO - Epoch  43 | train_loss=0.024898 | val_loss=0.035401
2025-10-31 21:43:53,100 - models.nhits - INFO - Epoch  44 | train_loss=0.024233 | val_loss=0.038113
2025-10-31 21:44:01,153 - models.nhits - INFO - Epoch  45 | train_loss=0.023733 | val_loss=0.034351
2025-10-31 21:44:09,210 - models.nhits - INFO - Epoch  46 | train_loss=0.024146 | val_loss=0.033142
2025-10-31 21:44:17,268 - models.nhits - INFO - Epoch  47 | train_loss=0.023382 | val_loss=0.038446
2025-10-31 21:44:25,264 - models.nhits - INFO - Epoch  48 | train_loss=0.023586 | val_loss=0.035638
2025-10-31 21:44:33,378 - models.nhits - INFO - Epoch  49 | train_loss=0.023987 | val_loss=0.045497
2025-10-31 21:44:41,484 - models.nhits - INFO - Epoch  50 | train_loss=0.024298 | val_loss=0.036311
2025-10-31 21:44:49,529 - models.nhits - INFO - Epoch  51 | train_loss=0.023075 | val_loss=0.037487
2025-10-31 21:44:57,514 - models.nhits - INFO - Epoch  52 | train_loss=0.023425 | val_loss=0.034540
2025-10-31 21:45:05,480 - models.nhits - INFO - Epoch  53 | train_loss=0.023126 | val_loss=0.031241
2025-10-31 21:45:13,521 - models.nhits - INFO - Epoch  54 | train_loss=0.023178 | val_loss=0.031358
2025-10-31 21:45:21,524 - models.nhits - INFO - Epoch  55 | train_loss=0.022751 | val_loss=0.033600
2025-10-31 21:45:29,505 - models.nhits - INFO - Epoch  56 | train_loss=0.022466 | val_loss=0.035611
2025-10-31 21:45:37,498 - models.nhits - INFO - Epoch  57 | train_loss=0.022414 | val_loss=0.037362
2025-10-31 21:45:45,499 - models.nhits - INFO - Epoch  58 | train_loss=0.022200 | val_loss=0.033441
2025-10-31 21:45:53,496 - models.nhits - INFO - Epoch  59 | train_loss=0.022509 | val_loss=0.038575
2025-10-31 21:46:01,515 - models.nhits - INFO - Epoch  60 | train_loss=0.022503 | val_loss=0.034238
2025-10-31 21:46:09,498 - models.nhits - INFO - Epoch  61 | train_loss=0.022206 | val_loss=0.034673
2025-10-31 21:46:17,538 - models.nhits - INFO - Epoch  62 | train_loss=0.021825 | val_loss=0.032269
2025-10-31 21:46:25,591 - models.nhits - INFO - Epoch  63 | train_loss=0.021565 | val_loss=0.036628
2025-10-31 21:46:33,740 - models.nhits - INFO - Epoch  64 | train_loss=0.020868 | val_loss=0.033637
2025-10-31 21:46:41,796 - models.nhits - INFO - Epoch  65 | train_loss=0.018204 | val_loss=0.030814
2025-10-31 21:46:49,806 - models.nhits - INFO - Epoch  66 | train_loss=0.017910 | val_loss=0.030757
2025-10-31 21:46:57,859 - models.nhits - INFO - Epoch  67 | train_loss=0.017932 | val_loss=0.032676
2025-10-31 21:47:06,350 - models.nhits - INFO - Epoch  68 | train_loss=0.017505 | val_loss=0.029183
2025-10-31 21:47:14,733 - models.nhits - INFO - Epoch  69 | train_loss=0.017170 | val_loss=0.028230
2025-10-31 21:47:22,782 - models.nhits - INFO - Epoch  70 | train_loss=0.016828 | val_loss=0.032362
2025-10-31 21:47:31,180 - models.nhits - INFO - Epoch  71 | train_loss=0.016723 | val_loss=0.028649
2025-10-31 21:47:39,268 - models.nhits - INFO - Epoch  72 | train_loss=0.016132 | val_loss=0.031845
2025-10-31 21:47:47,220 - models.nhits - INFO - Epoch  73 | train_loss=0.016794 | val_loss=0.027572
2025-10-31 21:47:55,222 - models.nhits - INFO - Epoch  74 | train_loss=0.015894 | val_loss=0.034374
2025-10-31 21:48:03,507 - models.nhits - INFO - Epoch  75 | train_loss=0.016519 | val_loss=0.032052
2025-10-31 21:48:11,493 - models.nhits - INFO - Epoch  76 | train_loss=0.015864 | val_loss=0.028804
2025-10-31 21:48:19,476 - models.nhits - INFO - Epoch  77 | train_loss=0.015201 | val_loss=0.027263
2025-10-31 21:48:27,525 - models.nhits - INFO - Epoch  78 | train_loss=0.015400 | val_loss=0.035192
2025-10-31 21:48:35,692 - models.nhits - INFO - Epoch  79 | train_loss=0.015251 | val_loss=0.028276
2025-10-31 21:48:43,720 - models.nhits - INFO - Epoch  80 | train_loss=0.014802 | val_loss=0.033015
2025-10-31 21:48:51,807 - models.nhits - INFO - Epoch  81 | train_loss=0.014677 | val_loss=0.027904
2025-10-31 21:48:59,871 - models.nhits - INFO - Epoch  82 | train_loss=0.014979 | val_loss=0.028131
2025-10-31 21:49:07,876 - models.nhits - INFO - Epoch  83 | train_loss=0.014928 | val_loss=0.028661
2025-10-31 21:49:15,851 - models.nhits - INFO - Epoch  84 | train_loss=0.014443 | val_loss=0.032063
2025-10-31 21:49:23,847 - models.nhits - INFO - Epoch  85 | train_loss=0.014595 | val_loss=0.026778
2025-10-31 21:49:31,858 - models.nhits - INFO - Epoch  86 | train_loss=0.014308 | val_loss=0.029680
2025-10-31 21:49:39,843 - models.nhits - INFO - Epoch  87 | train_loss=0.014210 | val_loss=0.028854
2025-10-31 21:49:47,871 - models.nhits - INFO - Epoch  88 | train_loss=0.014508 | val_loss=0.033698
2025-10-31 21:49:55,838 - models.nhits - INFO - Epoch  89 | train_loss=0.013935 | val_loss=0.027622
2025-10-31 21:50:03,905 - models.nhits - INFO - Epoch  90 | train_loss=0.014211 | val_loss=0.028492
2025-10-31 21:50:11,826 - models.nhits - INFO - Epoch  91 | train_loss=0.014022 | val_loss=0.028714
2025-10-31 21:50:19,881 - models.nhits - INFO - Epoch  92 | train_loss=0.014939 | val_loss=0.031928
2025-10-31 21:50:27,919 - models.nhits - INFO - Epoch  93 | train_loss=0.013785 | val_loss=0.026364
2025-10-31 21:50:35,921 - models.nhits - INFO - Epoch  94 | train_loss=0.013593 | val_loss=0.028734
2025-10-31 21:50:43,926 - models.nhits - INFO - Epoch  95 | train_loss=0.014233 | val_loss=0.027994
2025-10-31 21:50:51,886 - models.nhits - INFO - Epoch  96 | train_loss=0.013488 | val_loss=0.029180
2025-10-31 21:50:59,964 - models.nhits - INFO - Epoch  97 | train_loss=0.013688 | val_loss=0.026720
2025-10-31 21:51:07,938 - models.nhits - INFO - Epoch  98 | train_loss=0.013453 | val_loss=0.028643
2025-10-31 21:51:15,951 - models.nhits - INFO - Epoch  99 | train_loss=0.013499 | val_loss=0.025335
2025-10-31 21:51:23,950 - models.nhits - INFO - Epoch 100 | train_loss=0.013538 | val_loss=0.032053
2025-10-31 21:51:23,980 - models.patchtst - INFO - 模型已保存到: results\experiment_20251031_213522/patchtst_model.pth
2025-10-31 21:51:24,012 - models.nhits - INFO - 模型已保存到: results\experiment_20251031_213522/nhits_model.pth
2025-10-31 21:51:24,012 - main - INFO - 专家模型训练完成
2025-10-31 21:51:24,016 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-10-31 21:51:24,016 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-10-31 21:51:24,016 - __main__ - ERROR - 实验失败: 'FloatingWindPlatformExperiment' object has no attribute 'expert_predictions'
2025-11-01 12:49:07,101 - __main__ - INFO - 初始化实验...
2025-11-01 12:49:07,112 - main - INFO - 使用设备: cuda
2025-11-01 12:49:07,115 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 12:49:07,115 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 12:49:07,115 - main - INFO - 开始数据加载和预处理...
2025-11-01 12:49:07,123 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 12:49:09,283 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 12:49:09,285 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 12:49:09,288 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 12:49:09,290 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 12:49:09,297 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 12:49:09,297 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 12:49:09,368 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 12:49:09,368 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 12:49:09,368 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 12:49:09,369 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 12:49:09,369 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 12:49:09,435 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 12:49:09,435 - main - INFO - 数据预处理完成:
2025-11-01 12:49:09,435 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 12:49:09,435 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 12:49:09,435 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 12:49:09,435 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 12:49:09,435 - main - INFO - 开始训练专家模型...
2025-11-01 12:49:09,435 - main - INFO - 创建PatchTST模型...
2025-11-01 12:49:09,474 - main - INFO - 创建NHITS模型...
2025-11-01 12:49:09,540 - main - INFO - 训练PatchTST...
2025-11-01 12:49:19,540 - models.patchtst - INFO - Epoch   1 | train_loss=0.928160 | val_loss=1.327867
2025-11-01 12:49:26,437 - models.patchtst - INFO - Epoch   2 | train_loss=0.923977 | val_loss=1.327633
2025-11-01 12:49:33,561 - models.patchtst - INFO - Epoch   3 | train_loss=0.924023 | val_loss=1.327864
2025-11-01 12:49:40,452 - models.patchtst - INFO - Epoch   4 | train_loss=0.924040 | val_loss=1.327717
2025-11-01 12:49:47,380 - models.patchtst - INFO - Epoch   5 | train_loss=0.923992 | val_loss=1.327835
2025-11-01 12:49:54,283 - models.patchtst - INFO - Epoch   6 | train_loss=0.923937 | val_loss=1.327911
2025-11-01 12:50:01,246 - models.patchtst - INFO - Epoch   7 | train_loss=0.923977 | val_loss=1.327600
2025-11-01 12:50:08,191 - models.patchtst - INFO - Epoch   8 | train_loss=0.924023 | val_loss=1.327745
2025-11-01 12:50:15,175 - models.patchtst - INFO - Epoch   9 | train_loss=0.924023 | val_loss=1.327648
2025-11-01 12:50:22,150 - models.patchtst - INFO - Epoch  10 | train_loss=0.924027 | val_loss=1.327803
2025-11-01 12:50:29,170 - models.patchtst - INFO - Epoch  11 | train_loss=0.923944 | val_loss=1.327698
2025-11-01 12:50:36,193 - models.patchtst - INFO - Epoch  12 | train_loss=0.924035 | val_loss=1.327864
2025-11-01 12:50:43,244 - models.patchtst - INFO - Epoch  13 | train_loss=0.923940 | val_loss=1.327756
2025-11-01 12:50:50,329 - models.patchtst - INFO - Epoch  14 | train_loss=0.923930 | val_loss=1.327724
2025-11-01 12:50:57,482 - models.patchtst - INFO - Epoch  15 | train_loss=0.923906 | val_loss=1.327764
2025-11-01 12:51:04,626 - models.patchtst - INFO - Epoch  16 | train_loss=0.923920 | val_loss=1.327838
2025-11-01 12:51:11,667 - models.patchtst - INFO - Epoch  17 | train_loss=0.923869 | val_loss=1.327943
2025-11-01 12:51:18,765 - models.patchtst - INFO - Epoch  18 | train_loss=0.923948 | val_loss=1.327841
2025-11-01 12:51:25,836 - models.patchtst - INFO - Epoch  19 | train_loss=0.923870 | val_loss=1.327704
2025-11-01 12:51:32,914 - models.patchtst - INFO - Epoch  20 | train_loss=0.924042 | val_loss=1.327717
2025-11-01 12:51:39,980 - models.patchtst - INFO - Epoch  21 | train_loss=0.923831 | val_loss=1.327767
2025-11-01 12:51:47,064 - models.patchtst - INFO - Epoch  22 | train_loss=0.923885 | val_loss=1.327804
2025-11-01 12:51:47,064 - models.patchtst - INFO - Early stopping at epoch 22早停触发（连续15轮验证损失未下降），最佳验证损失：1.327600
2025-11-01 12:51:47,064 - main - INFO - 训练NHITS...
2025-11-01 12:51:54,955 - models.nhits - INFO - Epoch   1 | train_loss=290956859.716107 | val_loss=462.947290
2025-11-01 12:52:02,875 - models.nhits - INFO - Epoch   2 | train_loss=116.449617 | val_loss=1.888875
2025-11-01 12:52:10,790 - models.nhits - INFO - Epoch   3 | train_loss=0.570158 | val_loss=0.121802
2025-11-01 12:52:18,633 - models.nhits - INFO - Epoch   4 | train_loss=0.077018 | val_loss=0.067636
2025-11-01 12:52:26,505 - models.nhits - INFO - Epoch   5 | train_loss=0.043173 | val_loss=0.044596
2025-11-01 12:52:34,364 - models.nhits - INFO - Epoch   6 | train_loss=0.040320 | val_loss=0.058222
2025-11-01 12:52:42,230 - models.nhits - INFO - Epoch   7 | train_loss=10.761784 | val_loss=0.067059
2025-11-01 12:52:50,092 - models.nhits - INFO - Epoch   8 | train_loss=0.034723 | val_loss=0.047695
2025-11-01 12:52:57,917 - models.nhits - INFO - Epoch   9 | train_loss=0.091340 | val_loss=0.052904
2025-11-01 12:53:05,772 - models.nhits - INFO - Epoch  10 | train_loss=0.034603 | val_loss=0.039610
2025-11-01 12:53:13,600 - models.nhits - INFO - Epoch  11 | train_loss=0.036037 | val_loss=0.053623
2025-11-01 12:53:21,528 - models.nhits - INFO - Epoch  12 | train_loss=0.035705 | val_loss=0.050852
2025-11-01 12:53:29,597 - models.nhits - INFO - Epoch  13 | train_loss=0.032355 | val_loss=0.041997
2025-11-01 12:53:37,862 - models.nhits - INFO - Epoch  14 | train_loss=0.041507 | val_loss=0.040738
2025-11-01 12:53:46,052 - models.nhits - INFO - Epoch  15 | train_loss=0.033314 | val_loss=0.039980
2025-11-01 12:53:54,152 - models.nhits - INFO - Epoch  16 | train_loss=1.477184 | val_loss=0.059124
2025-11-01 12:54:02,275 - models.nhits - INFO - Epoch  17 | train_loss=0.031252 | val_loss=0.055952
2025-11-01 12:54:10,457 - models.nhits - INFO - Epoch  18 | train_loss=0.028799 | val_loss=0.041333
2025-11-01 12:54:18,622 - models.nhits - INFO - Epoch  19 | train_loss=0.052183 | val_loss=0.035773
2025-11-01 12:54:26,876 - models.nhits - INFO - Epoch  20 | train_loss=0.027889 | val_loss=0.038444
2025-11-01 12:54:34,920 - models.nhits - INFO - Epoch  21 | train_loss=0.240175 | val_loss=0.046370
2025-11-01 12:54:42,908 - models.nhits - INFO - Epoch  22 | train_loss=0.057335 | val_loss=0.057435
2025-11-01 12:54:50,839 - models.nhits - INFO - Epoch  23 | train_loss=0.034465 | val_loss=0.048274
2025-11-01 12:54:58,696 - models.nhits - INFO - Epoch  24 | train_loss=0.027661 | val_loss=0.055764
2025-11-01 12:55:06,534 - models.nhits - INFO - Epoch  25 | train_loss=0.043883 | val_loss=0.038926
2025-11-01 12:55:14,377 - models.nhits - INFO - Epoch  26 | train_loss=0.026462 | val_loss=0.049364
2025-11-01 12:55:22,185 - models.nhits - INFO - Epoch  27 | train_loss=2.762483 | val_loss=0.037563
2025-11-01 12:55:30,007 - models.nhits - INFO - Epoch  28 | train_loss=0.027060 | val_loss=0.047353
2025-11-01 12:55:37,826 - models.nhits - INFO - Epoch  29 | train_loss=6.535511 | val_loss=0.037760
2025-11-01 12:55:45,647 - models.nhits - INFO - Epoch  30 | train_loss=0.121939 | val_loss=0.040947
2025-11-01 12:55:53,464 - models.nhits - INFO - Epoch  31 | train_loss=0.019974 | val_loss=0.032040
2025-11-01 12:56:01,291 - models.nhits - INFO - Epoch  32 | train_loss=0.020352 | val_loss=0.037105
2025-11-01 12:56:09,093 - models.nhits - INFO - Epoch  33 | train_loss=0.021009 | val_loss=0.030133
2025-11-01 12:56:16,882 - models.nhits - INFO - Epoch  34 | train_loss=0.018929 | val_loss=0.033228
2025-11-01 12:56:24,692 - models.nhits - INFO - Epoch  35 | train_loss=0.019023 | val_loss=0.030832
2025-11-01 12:56:32,544 - models.nhits - INFO - Epoch  36 | train_loss=0.017890 | val_loss=0.026306
2025-11-01 12:56:40,364 - models.nhits - INFO - Epoch  37 | train_loss=0.017765 | val_loss=0.035099
2025-11-01 12:56:48,180 - models.nhits - INFO - Epoch  38 | train_loss=0.089957 | val_loss=0.030087
2025-11-01 12:56:56,001 - models.nhits - INFO - Epoch  39 | train_loss=0.018122 | val_loss=0.030976
2025-11-01 12:57:03,801 - models.nhits - INFO - Epoch  40 | train_loss=0.018302 | val_loss=0.029281
2025-11-01 12:57:11,625 - models.nhits - INFO - Epoch  41 | train_loss=0.018162 | val_loss=0.035956
2025-11-01 12:57:19,416 - models.nhits - INFO - Epoch  42 | train_loss=0.017872 | val_loss=0.027086
2025-11-01 12:57:27,226 - models.nhits - INFO - Epoch  43 | train_loss=0.016875 | val_loss=0.031939
2025-11-01 12:57:35,004 - models.nhits - INFO - Epoch  44 | train_loss=0.023480 | val_loss=0.025426
2025-11-01 12:57:42,816 - models.nhits - INFO - Epoch  45 | train_loss=0.017651 | val_loss=0.023383
2025-11-01 12:57:50,609 - models.nhits - INFO - Epoch  46 | train_loss=0.016005 | val_loss=0.029439
2025-11-01 12:57:58,441 - models.nhits - INFO - Epoch  47 | train_loss=0.016648 | val_loss=0.023137
2025-11-01 12:58:06,240 - models.nhits - INFO - Epoch  48 | train_loss=0.015993 | val_loss=0.026039
2025-11-01 12:58:14,065 - models.nhits - INFO - Epoch  49 | train_loss=0.020446 | val_loss=0.029632
2025-11-01 12:58:21,866 - models.nhits - INFO - Epoch  50 | train_loss=0.018325 | val_loss=0.033318
2025-11-01 12:58:29,662 - models.nhits - INFO - Epoch  51 | train_loss=0.015999 | val_loss=0.034175
2025-11-01 12:58:37,866 - models.nhits - INFO - Epoch  52 | train_loss=0.022288 | val_loss=0.026215
2025-11-01 12:58:45,936 - models.nhits - INFO - Epoch  53 | train_loss=0.016553 | val_loss=0.027416
2025-11-01 12:58:54,036 - models.nhits - INFO - Epoch  54 | train_loss=0.016327 | val_loss=0.027439
2025-11-01 12:59:02,114 - models.nhits - INFO - Epoch  55 | train_loss=0.014880 | val_loss=0.027410
2025-11-01 12:59:10,179 - models.nhits - INFO - Epoch  56 | train_loss=0.015663 | val_loss=0.025473
2025-11-01 12:59:18,304 - models.nhits - INFO - Epoch  57 | train_loss=0.016978 | val_loss=0.027197
2025-11-01 12:59:26,500 - models.nhits - INFO - Epoch  58 | train_loss=0.015043 | val_loss=0.023880
2025-11-01 12:59:34,495 - models.nhits - INFO - Epoch  59 | train_loss=0.012421 | val_loss=0.022540
2025-11-01 12:59:42,580 - models.nhits - INFO - Epoch  60 | train_loss=0.011946 | val_loss=0.021107
2025-11-01 12:59:50,649 - models.nhits - INFO - Epoch  61 | train_loss=0.011677 | val_loss=0.021332
2025-11-01 12:59:58,699 - models.nhits - INFO - Epoch  62 | train_loss=0.011729 | val_loss=0.022007
2025-11-01 13:00:06,832 - models.nhits - INFO - Epoch  63 | train_loss=0.011307 | val_loss=0.019738
2025-11-01 13:00:14,887 - models.nhits - INFO - Epoch  64 | train_loss=0.011672 | val_loss=0.021060
2025-11-01 13:00:22,981 - models.nhits - INFO - Epoch  65 | train_loss=0.011681 | val_loss=0.023333
2025-11-01 13:00:31,134 - models.nhits - INFO - Epoch  66 | train_loss=0.012046 | val_loss=0.024351
2025-11-01 13:00:39,315 - models.nhits - INFO - Epoch  67 | train_loss=0.011903 | val_loss=0.023068
2025-11-01 13:00:47,430 - models.nhits - INFO - Epoch  68 | train_loss=0.011181 | val_loss=0.020099
2025-11-01 13:00:55,517 - models.nhits - INFO - Epoch  69 | train_loss=0.011356 | val_loss=0.021438
2025-11-01 13:01:03,733 - models.nhits - INFO - Epoch  70 | train_loss=0.011477 | val_loss=0.022240
2025-11-01 13:01:11,864 - models.nhits - INFO - Epoch  71 | train_loss=0.011297 | val_loss=0.018876
2025-11-01 13:01:20,084 - models.nhits - INFO - Epoch  72 | train_loss=0.011627 | val_loss=0.020929
2025-11-01 13:01:28,192 - models.nhits - INFO - Epoch  73 | train_loss=0.011070 | val_loss=0.021237
2025-11-01 13:01:36,554 - models.nhits - INFO - Epoch  74 | train_loss=0.011499 | val_loss=0.020259
2025-11-01 13:01:44,660 - models.nhits - INFO - Epoch  75 | train_loss=0.010791 | val_loss=0.020879
2025-11-01 13:01:52,783 - models.nhits - INFO - Epoch  76 | train_loss=0.011206 | val_loss=0.019120
2025-11-01 13:02:00,953 - models.nhits - INFO - Epoch  77 | train_loss=0.010842 | val_loss=0.018999
2025-11-01 13:02:09,040 - models.nhits - INFO - Epoch  78 | train_loss=0.010609 | val_loss=0.018814
2025-11-01 13:02:17,140 - models.nhits - INFO - Epoch  79 | train_loss=0.010517 | val_loss=0.022145
2025-11-01 13:02:25,409 - models.nhits - INFO - Epoch  80 | train_loss=0.011043 | val_loss=0.021087
2025-11-01 13:02:33,531 - models.nhits - INFO - Epoch  81 | train_loss=0.010544 | val_loss=0.021398
2025-11-01 13:02:41,710 - models.nhits - INFO - Epoch  82 | train_loss=0.010729 | val_loss=0.020781
2025-11-01 13:02:49,815 - models.nhits - INFO - Epoch  83 | train_loss=0.010720 | val_loss=0.020135
2025-11-01 13:02:57,920 - models.nhits - INFO - Epoch  84 | train_loss=0.010833 | val_loss=0.023150
2025-11-01 13:03:06,105 - models.nhits - INFO - Epoch  85 | train_loss=0.010521 | val_loss=0.023013
2025-11-01 13:03:14,196 - models.nhits - INFO - Epoch  86 | train_loss=0.010664 | val_loss=0.019448
2025-11-01 13:03:22,325 - models.nhits - INFO - Epoch  87 | train_loss=0.010572 | val_loss=0.022198
2025-11-01 13:03:30,437 - models.nhits - INFO - Epoch  88 | train_loss=0.010958 | val_loss=0.023271
2025-11-01 13:03:38,662 - models.nhits - INFO - Epoch  89 | train_loss=0.010452 | val_loss=0.019636
2025-11-01 13:03:46,808 - models.nhits - INFO - Epoch  90 | train_loss=0.009408 | val_loss=0.019175
2025-11-01 13:03:54,972 - models.nhits - INFO - Epoch  91 | train_loss=0.009111 | val_loss=0.018454
2025-11-01 13:04:03,077 - models.nhits - INFO - Epoch  92 | train_loss=0.008837 | val_loss=0.018459
2025-11-01 13:04:11,211 - models.nhits - INFO - Epoch  93 | train_loss=0.008856 | val_loss=0.019128
2025-11-01 13:04:19,384 - models.nhits - INFO - Epoch  94 | train_loss=0.008810 | val_loss=0.019997
2025-11-01 13:04:27,600 - models.nhits - INFO - Epoch  95 | train_loss=0.008518 | val_loss=0.018201
2025-11-01 13:04:35,732 - models.nhits - INFO - Epoch  96 | train_loss=0.008493 | val_loss=0.020526
2025-11-01 13:04:43,905 - models.nhits - INFO - Epoch  97 | train_loss=0.008686 | val_loss=0.018398
2025-11-01 13:04:52,043 - models.nhits - INFO - Epoch  98 | train_loss=0.008193 | val_loss=0.020833
2025-11-01 13:05:00,323 - models.nhits - INFO - Epoch  99 | train_loss=0.008286 | val_loss=0.018140
2025-11-01 13:05:08,525 - models.nhits - INFO - Epoch 100 | train_loss=0.008069 | val_loss=0.018472
2025-11-01 13:05:08,541 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_124907/patchtst_model.pth
2025-11-01 13:05:08,570 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_124907/nhits_model.pth
2025-11-01 13:05:08,570 - main - INFO - 专家模型训练完成
2025-11-01 13:05:08,573 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 13:05:08,573 - main - INFO - 获取专家模型预测...
2025-11-01 13:05:21,527 - main - INFO - 专家预测获取完成
2025-11-01 13:05:21,528 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 13:05:22,194 - __main__ - ERROR - 实验失败: name 'StaticWeightOptimizer' is not defined
2025-11-01 14:46:37,603 - __main__ - INFO - 初始化实验...
2025-11-01 14:46:37,612 - main - INFO - 使用设备: cuda
2025-11-01 14:46:37,614 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 14:46:37,614 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 14:46:37,614 - main - INFO - 开始数据加载和预处理...
2025-11-01 14:46:37,623 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 14:46:39,751 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 14:46:39,754 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 14:46:39,757 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 14:46:39,758 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 14:46:39,764 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 14:46:39,764 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 14:46:39,837 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 14:46:39,838 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 14:46:39,913 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 14:46:39,913 - main - INFO - 数据预处理完成:
2025-11-01 14:46:39,913 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 14:46:39,913 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 14:46:39,914 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 14:46:39,914 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 14:46:39,914 - main - INFO - 开始训练专家模型...
2025-11-01 14:46:39,914 - main - INFO - 创建PatchTST模型...
2025-11-01 14:46:39,953 - main - INFO - 创建NHITS模型...
2025-11-01 14:46:40,012 - main - INFO - 训练PatchTST...
2025-11-01 14:46:50,068 - models.patchtst - INFO - Epoch   1 | train_loss=0.926848 | val_loss=1.327756
2025-11-01 14:46:57,058 - models.patchtst - INFO - Epoch   2 | train_loss=0.923914 | val_loss=1.327630
2025-11-01 14:47:04,033 - models.patchtst - INFO - Epoch   3 | train_loss=0.924053 | val_loss=1.327828
2025-11-01 14:47:11,058 - models.patchtst - INFO - Epoch   4 | train_loss=0.924016 | val_loss=1.327830
2025-11-01 14:47:18,054 - models.patchtst - INFO - Epoch   5 | train_loss=0.923982 | val_loss=1.327889
2025-11-01 14:47:25,216 - models.patchtst - INFO - Epoch   6 | train_loss=0.923917 | val_loss=1.327838
2025-11-01 14:47:32,396 - models.patchtst - INFO - Epoch   7 | train_loss=0.924012 | val_loss=1.327730
2025-11-01 14:47:39,655 - models.patchtst - INFO - Epoch   8 | train_loss=0.923979 | val_loss=1.327683
2025-11-01 14:47:46,757 - models.patchtst - INFO - Epoch   9 | train_loss=0.924012 | val_loss=1.327728
2025-11-01 14:47:53,910 - models.patchtst - INFO - Epoch  10 | train_loss=0.923918 | val_loss=1.328104
2025-11-01 14:48:01,020 - models.patchtst - INFO - Epoch  11 | train_loss=0.923991 | val_loss=1.327719
2025-11-01 14:48:08,101 - models.patchtst - INFO - Epoch  12 | train_loss=0.923967 | val_loss=1.327857
2025-11-01 14:48:15,181 - models.patchtst - INFO - Epoch  13 | train_loss=0.923976 | val_loss=1.327856
2025-11-01 14:48:22,264 - models.patchtst - INFO - Epoch  14 | train_loss=0.923927 | val_loss=1.327776
2025-11-01 14:48:29,343 - models.patchtst - INFO - Epoch  15 | train_loss=0.923901 | val_loss=1.327753
2025-11-01 14:48:36,431 - models.patchtst - INFO - Epoch  16 | train_loss=0.923908 | val_loss=1.327787
2025-11-01 14:48:43,620 - models.patchtst - INFO - Epoch  17 | train_loss=0.923928 | val_loss=1.327798
2025-11-01 14:48:43,620 - models.patchtst - INFO - Early stopping at epoch 17早停触发（连续15轮验证损失未下降），最佳验证损失：1.327630
2025-11-01 14:48:43,620 - main - INFO - 训练NHITS...
2025-11-01 14:48:51,643 - models.nhits - INFO - Epoch   1 | train_loss=511531947.700916 | val_loss=1246.921167
2025-11-01 14:48:59,614 - models.nhits - INFO - Epoch   2 | train_loss=103.820659 | val_loss=1.261165
2025-11-01 14:49:07,639 - models.nhits - INFO - Epoch   3 | train_loss=1.161314 | val_loss=0.133873
2025-11-01 14:49:15,662 - models.nhits - INFO - Epoch   4 | train_loss=0.155268 | val_loss=0.054662
2025-11-01 14:49:23,665 - models.nhits - INFO - Epoch   5 | train_loss=0.049227 | val_loss=0.053077
2025-11-01 14:49:31,628 - models.nhits - INFO - Epoch   6 | train_loss=0.039488 | val_loss=0.058875
2025-11-01 14:49:39,620 - models.nhits - INFO - Epoch   7 | train_loss=0.247428 | val_loss=0.048047
2025-11-01 14:49:47,569 - models.nhits - INFO - Epoch   8 | train_loss=0.035007 | val_loss=0.043007
2025-11-01 14:49:55,537 - models.nhits - INFO - Epoch   9 | train_loss=0.036265 | val_loss=0.060841
2025-11-01 14:50:03,501 - models.nhits - INFO - Epoch  10 | train_loss=0.078076 | val_loss=0.042370
2025-11-01 14:50:11,440 - models.nhits - INFO - Epoch  11 | train_loss=0.031104 | val_loss=0.060357
2025-11-01 14:50:19,407 - models.nhits - INFO - Epoch  12 | train_loss=0.033086 | val_loss=0.075760
2025-11-01 14:50:27,347 - models.nhits - INFO - Epoch  13 | train_loss=0.030572 | val_loss=0.039600
2025-11-01 14:50:35,300 - models.nhits - INFO - Epoch  14 | train_loss=0.079453 | val_loss=0.061929
2025-11-01 14:50:43,249 - models.nhits - INFO - Epoch  15 | train_loss=0.031319 | val_loss=0.039196
2025-11-01 14:50:51,182 - models.nhits - INFO - Epoch  16 | train_loss=0.028459 | val_loss=0.041849
2025-11-01 14:50:59,145 - models.nhits - INFO - Epoch  17 | train_loss=0.029062 | val_loss=0.045885
2025-11-01 14:51:07,094 - models.nhits - INFO - Epoch  18 | train_loss=0.284606 | val_loss=0.036131
2025-11-01 14:51:15,048 - models.nhits - INFO - Epoch  19 | train_loss=0.065743 | val_loss=0.136267
2025-11-01 14:51:22,986 - models.nhits - INFO - Epoch  20 | train_loss=0.031938 | val_loss=0.049211
2025-11-01 14:51:30,922 - models.nhits - INFO - Epoch  21 | train_loss=0.030589 | val_loss=0.037819
2025-11-01 14:51:38,828 - models.nhits - INFO - Epoch  22 | train_loss=0.026381 | val_loss=0.040536
2025-11-01 14:51:46,744 - models.nhits - INFO - Epoch  23 | train_loss=1.133351 | val_loss=0.034066
2025-11-01 14:51:54,661 - models.nhits - INFO - Epoch  24 | train_loss=0.030507 | val_loss=0.295925
2025-11-01 14:52:02,627 - models.nhits - INFO - Epoch  25 | train_loss=0.034163 | val_loss=0.046096
2025-11-01 14:52:10,602 - models.nhits - INFO - Epoch  26 | train_loss=0.031859 | val_loss=0.037207
2025-11-01 14:52:18,588 - models.nhits - INFO - Epoch  27 | train_loss=0.026809 | val_loss=0.033879
2025-11-01 14:52:26,570 - models.nhits - INFO - Epoch  28 | train_loss=0.460372 | val_loss=0.032977
2025-11-01 14:52:34,552 - models.nhits - INFO - Epoch  29 | train_loss=0.027225 | val_loss=0.046186
2025-11-01 14:52:42,551 - models.nhits - INFO - Epoch  30 | train_loss=0.065559 | val_loss=0.034227
2025-11-01 14:52:50,538 - models.nhits - INFO - Epoch  31 | train_loss=0.053585 | val_loss=3.699667
2025-11-01 14:52:58,551 - models.nhits - INFO - Epoch  32 | train_loss=0.340715 | val_loss=0.037135
2025-11-01 14:53:06,512 - models.nhits - INFO - Epoch  33 | train_loss=0.028702 | val_loss=0.032510
2025-11-01 14:53:14,481 - models.nhits - INFO - Epoch  34 | train_loss=0.027967 | val_loss=0.041620
2025-11-01 14:53:22,500 - models.nhits - INFO - Epoch  35 | train_loss=0.092132 | val_loss=0.031015
2025-11-01 14:53:30,494 - models.nhits - INFO - Epoch  36 | train_loss=0.038588 | val_loss=0.046375
2025-11-01 14:53:38,984 - models.nhits - INFO - Epoch  37 | train_loss=0.026566 | val_loss=0.041941
2025-11-01 14:53:47,534 - models.nhits - INFO - Epoch  38 | train_loss=0.050538 | val_loss=0.040394
2025-11-01 14:53:55,945 - models.nhits - INFO - Epoch  39 | train_loss=0.366425 | val_loss=0.053784
2025-11-01 14:54:04,220 - models.nhits - INFO - Epoch  40 | train_loss=0.033706 | val_loss=0.037549
2025-11-01 14:54:12,454 - models.nhits - INFO - Epoch  41 | train_loss=0.063200 | val_loss=0.050369
2025-11-01 14:54:20,617 - models.nhits - INFO - Epoch  42 | train_loss=0.025664 | val_loss=0.031341
2025-11-01 14:54:28,810 - models.nhits - INFO - Epoch  43 | train_loss=0.035469 | val_loss=0.035296
2025-11-01 14:54:37,117 - models.nhits - INFO - Epoch  44 | train_loss=0.035894 | val_loss=0.054420
2025-11-01 14:54:45,151 - models.nhits - INFO - Epoch  45 | train_loss=0.064086 | val_loss=0.076388
2025-11-01 14:54:53,134 - models.nhits - INFO - Epoch  46 | train_loss=0.026589 | val_loss=0.027151
2025-11-01 14:55:01,117 - models.nhits - INFO - Epoch  47 | train_loss=0.257154 | val_loss=0.044666
2025-11-01 14:55:09,095 - models.nhits - INFO - Epoch  48 | train_loss=0.029088 | val_loss=0.042424
2025-11-01 14:55:17,098 - models.nhits - INFO - Epoch  49 | train_loss=0.024805 | val_loss=0.046327
2025-11-01 14:55:25,137 - models.nhits - INFO - Epoch  50 | train_loss=0.038721 | val_loss=0.032447
2025-11-01 14:55:33,214 - models.nhits - INFO - Epoch  51 | train_loss=3.003416 | val_loss=0.893546
2025-11-01 14:55:41,285 - models.nhits - INFO - Epoch  52 | train_loss=0.031183 | val_loss=0.032023
2025-11-01 14:55:49,364 - models.nhits - INFO - Epoch  53 | train_loss=0.210600 | val_loss=0.039270
2025-11-01 14:55:57,492 - models.nhits - INFO - Epoch  54 | train_loss=0.027358 | val_loss=0.041240
2025-11-01 14:56:05,639 - models.nhits - INFO - Epoch  55 | train_loss=0.026551 | val_loss=0.039490
2025-11-01 14:56:13,726 - models.nhits - INFO - Epoch  56 | train_loss=0.030718 | val_loss=0.035079
2025-11-01 14:56:21,801 - models.nhits - INFO - Epoch  57 | train_loss=0.053843 | val_loss=0.036446
2025-11-01 14:56:29,888 - models.nhits - INFO - Epoch  58 | train_loss=0.018237 | val_loss=0.027629
2025-11-01 14:56:37,973 - models.nhits - INFO - Epoch  59 | train_loss=0.017427 | val_loss=0.023872
2025-11-01 14:56:46,045 - models.nhits - INFO - Epoch  60 | train_loss=0.016367 | val_loss=0.029873
2025-11-01 14:56:54,118 - models.nhits - INFO - Epoch  61 | train_loss=0.017415 | val_loss=0.027775
2025-11-01 14:57:02,239 - models.nhits - INFO - Epoch  62 | train_loss=0.017204 | val_loss=0.024409
2025-11-01 14:57:10,340 - models.nhits - INFO - Epoch  63 | train_loss=0.016777 | val_loss=0.026920
2025-11-01 14:57:18,438 - models.nhits - INFO - Epoch  64 | train_loss=0.015690 | val_loss=0.031505
2025-11-01 14:57:26,542 - models.nhits - INFO - Epoch  65 | train_loss=0.016505 | val_loss=0.022421
2025-11-01 14:57:34,612 - models.nhits - INFO - Epoch  66 | train_loss=0.016246 | val_loss=0.024995
2025-11-01 14:57:42,694 - models.nhits - INFO - Epoch  67 | train_loss=0.022034 | val_loss=0.026398
2025-11-01 14:57:50,747 - models.nhits - INFO - Epoch  68 | train_loss=0.016211 | val_loss=0.027371
2025-11-01 14:57:58,830 - models.nhits - INFO - Epoch  69 | train_loss=0.015384 | val_loss=0.022598
2025-11-01 14:58:06,846 - models.nhits - INFO - Epoch  70 | train_loss=0.015519 | val_loss=0.027075
2025-11-01 14:58:14,830 - models.nhits - INFO - Epoch  71 | train_loss=0.015233 | val_loss=0.026069
2025-11-01 14:58:22,790 - models.nhits - INFO - Epoch  72 | train_loss=0.017521 | val_loss=0.025618
2025-11-01 14:58:30,766 - models.nhits - INFO - Epoch  73 | train_loss=0.015405 | val_loss=0.022893
2025-11-01 14:58:38,750 - models.nhits - INFO - Epoch  74 | train_loss=0.015738 | val_loss=0.026172
2025-11-01 14:58:46,720 - models.nhits - INFO - Epoch  75 | train_loss=0.017040 | val_loss=0.021732
2025-11-01 14:58:54,768 - models.nhits - INFO - Epoch  76 | train_loss=0.015505 | val_loss=0.023846
2025-11-01 14:59:02,825 - models.nhits - INFO - Epoch  77 | train_loss=0.015891 | val_loss=0.026522
2025-11-01 14:59:10,918 - models.nhits - INFO - Epoch  78 | train_loss=0.014863 | val_loss=0.024958
2025-11-01 14:59:19,010 - models.nhits - INFO - Epoch  79 | train_loss=0.018179 | val_loss=0.025947
2025-11-01 14:59:27,124 - models.nhits - INFO - Epoch  80 | train_loss=0.014414 | val_loss=0.022582
2025-11-01 14:59:35,256 - models.nhits - INFO - Epoch  81 | train_loss=0.014329 | val_loss=0.024784
2025-11-01 14:59:43,350 - models.nhits - INFO - Epoch  82 | train_loss=0.017985 | val_loss=0.021967
2025-11-01 14:59:51,429 - models.nhits - INFO - Epoch  83 | train_loss=0.017152 | val_loss=0.023511
2025-11-01 14:59:59,518 - models.nhits - INFO - Epoch  84 | train_loss=0.013976 | val_loss=0.021838
2025-11-01 15:00:07,608 - models.nhits - INFO - Epoch  85 | train_loss=0.014315 | val_loss=0.023733
2025-11-01 15:00:15,692 - models.nhits - INFO - Epoch  86 | train_loss=0.014134 | val_loss=0.021690
2025-11-01 15:00:23,797 - models.nhits - INFO - Epoch  87 | train_loss=0.015048 | val_loss=0.025471
2025-11-01 15:00:31,791 - models.nhits - INFO - Epoch  88 | train_loss=0.015553 | val_loss=0.024243
2025-11-01 15:00:39,757 - models.nhits - INFO - Epoch  89 | train_loss=0.015416 | val_loss=0.024261
2025-11-01 15:00:47,719 - models.nhits - INFO - Epoch  90 | train_loss=0.016716 | val_loss=0.022475
2025-11-01 15:00:55,688 - models.nhits - INFO - Epoch  91 | train_loss=0.017070 | val_loss=0.022072
2025-11-01 15:01:03,718 - models.nhits - INFO - Epoch  92 | train_loss=0.016582 | val_loss=0.024254
2025-11-01 15:01:11,694 - models.nhits - INFO - Epoch  93 | train_loss=0.014739 | val_loss=0.022297
2025-11-01 15:01:19,677 - models.nhits - INFO - Epoch  94 | train_loss=0.013848 | val_loss=0.022699
2025-11-01 15:01:27,661 - models.nhits - INFO - Epoch  95 | train_loss=0.020973 | val_loss=0.025761
2025-11-01 15:01:35,612 - models.nhits - INFO - Epoch  96 | train_loss=0.014598 | val_loss=0.021352
2025-11-01 15:01:43,612 - models.nhits - INFO - Epoch  97 | train_loss=0.013100 | val_loss=0.024572
2025-11-01 15:01:51,578 - models.nhits - INFO - Epoch  98 | train_loss=0.013232 | val_loss=0.029121
2025-11-01 15:01:59,528 - models.nhits - INFO - Epoch  99 | train_loss=0.018226 | val_loss=0.053930
2025-11-01 15:02:07,538 - models.nhits - INFO - Epoch 100 | train_loss=0.014918 | val_loss=0.022398
2025-11-01 15:02:07,557 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_144637/patchtst_model.pth
2025-11-01 15:02:07,584 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_144637/nhits_model.pth
2025-11-01 15:02:07,585 - main - INFO - 专家模型训练完成
2025-11-01 15:02:07,588 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 15:02:07,588 - main - INFO - 获取专家模型预测...
2025-11-01 15:02:20,120 - main - INFO - 专家预测获取完成
2025-11-01 15:02:20,121 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 15:02:20,770 - __main__ - ERROR - 实验失败: 'StaticWeightOptimizer' object has no attribute 'optimize_weights'
2025-11-01 17:27:46,667 - __main__ - INFO - 初始化实验...
2025-11-01 17:27:46,677 - main - INFO - 使用设备: cuda
2025-11-01 17:27:46,679 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 17:27:46,679 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 17:27:46,679 - main - INFO - 开始数据加载和预处理...
2025-11-01 17:27:46,687 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 17:27:48,879 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 17:27:48,883 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 17:27:48,885 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 17:27:48,888 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 17:27:48,896 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 17:27:48,896 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 17:27:48,975 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 17:27:48,976 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 17:27:49,043 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 17:27:49,043 - main - INFO - 数据预处理完成:
2025-11-01 17:27:49,043 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 17:27:49,043 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 17:27:49,044 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 17:27:49,044 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 17:27:49,044 - main - INFO - 开始训练专家模型...
2025-11-01 17:27:49,044 - main - INFO - 创建PatchTST模型...
2025-11-01 17:27:49,093 - main - INFO - 创建NHITS模型...
2025-11-01 17:27:49,158 - main - INFO - 训练PatchTST...
2025-11-01 17:27:59,953 - models.patchtst - INFO - Epoch   1 | train_loss=0.927991 | val_loss=1.327851
2025-11-01 17:28:07,027 - models.patchtst - INFO - Epoch   2 | train_loss=0.924145 | val_loss=1.327801
2025-11-01 17:28:14,137 - models.patchtst - INFO - Epoch   3 | train_loss=0.924014 | val_loss=1.327835
2025-11-01 17:28:21,194 - models.patchtst - INFO - Epoch   4 | train_loss=0.923973 | val_loss=1.327958
2025-11-01 17:28:28,322 - models.patchtst - INFO - Epoch   5 | train_loss=0.923969 | val_loss=1.327751
2025-11-01 17:28:35,549 - models.patchtst - INFO - Epoch   6 | train_loss=0.923997 | val_loss=1.327883
2025-11-01 17:28:42,927 - models.patchtst - INFO - Epoch   7 | train_loss=0.924078 | val_loss=1.327748
2025-11-01 17:28:50,244 - models.patchtst - INFO - Epoch   8 | train_loss=0.923985 | val_loss=1.327974
2025-11-01 17:28:57,482 - models.patchtst - INFO - Epoch   9 | train_loss=0.924022 | val_loss=1.327784
2025-11-01 17:29:04,819 - models.patchtst - INFO - Epoch  10 | train_loss=0.923972 | val_loss=1.327938
2025-11-01 17:29:12,168 - models.patchtst - INFO - Epoch  11 | train_loss=0.923993 | val_loss=1.327935
2025-11-01 17:29:19,530 - models.patchtst - INFO - Epoch  12 | train_loss=0.924047 | val_loss=1.327818
2025-11-01 17:29:27,078 - models.patchtst - INFO - Epoch  13 | train_loss=0.923908 | val_loss=1.327786
2025-11-01 17:29:34,522 - models.patchtst - INFO - Epoch  14 | train_loss=0.923994 | val_loss=1.327731
2025-11-01 17:29:41,945 - models.patchtst - INFO - Epoch  15 | train_loss=0.923891 | val_loss=1.327840
2025-11-01 17:29:49,360 - models.patchtst - INFO - Epoch  16 | train_loss=0.923882 | val_loss=1.327883
2025-11-01 17:29:56,940 - models.patchtst - INFO - Epoch  17 | train_loss=0.923957 | val_loss=1.327817
2025-11-01 17:30:04,323 - models.patchtst - INFO - Epoch  18 | train_loss=0.923963 | val_loss=1.327750
2025-11-01 17:30:11,631 - models.patchtst - INFO - Epoch  19 | train_loss=0.923931 | val_loss=1.327832
2025-11-01 17:30:18,954 - models.patchtst - INFO - Epoch  20 | train_loss=0.923973 | val_loss=1.327789
2025-11-01 17:30:26,144 - models.patchtst - INFO - Epoch  21 | train_loss=0.923945 | val_loss=1.327777
2025-11-01 17:30:33,328 - models.patchtst - INFO - Epoch  22 | train_loss=0.923967 | val_loss=1.327705
2025-11-01 17:30:40,500 - models.patchtst - INFO - Epoch  23 | train_loss=0.923897 | val_loss=1.327781
2025-11-01 17:30:47,727 - models.patchtst - INFO - Epoch  24 | train_loss=0.924020 | val_loss=1.327839
2025-11-01 17:30:54,980 - models.patchtst - INFO - Epoch  25 | train_loss=0.923879 | val_loss=1.327893
2025-11-01 17:31:02,238 - models.patchtst - INFO - Epoch  26 | train_loss=0.923881 | val_loss=1.327769
2025-11-01 17:31:09,494 - models.patchtst - INFO - Epoch  27 | train_loss=0.923871 | val_loss=1.327688
2025-11-01 17:31:16,749 - models.patchtst - INFO - Epoch  28 | train_loss=0.923948 | val_loss=1.327750
2025-11-01 17:31:23,889 - models.patchtst - INFO - Epoch  29 | train_loss=0.923950 | val_loss=1.327771
2025-11-01 17:31:31,160 - models.patchtst - INFO - Epoch  30 | train_loss=0.923956 | val_loss=1.327797
2025-11-01 17:31:38,347 - models.patchtst - INFO - Epoch  31 | train_loss=0.923923 | val_loss=1.327787
2025-11-01 17:31:45,490 - models.patchtst - INFO - Epoch  32 | train_loss=0.923949 | val_loss=1.327737
2025-11-01 17:31:52,653 - models.patchtst - INFO - Epoch  33 | train_loss=0.923921 | val_loss=1.327778
2025-11-01 17:31:59,777 - models.patchtst - INFO - Epoch  34 | train_loss=0.923827 | val_loss=1.327788
2025-11-01 17:32:06,928 - models.patchtst - INFO - Epoch  35 | train_loss=0.923917 | val_loss=1.327777
2025-11-01 17:32:14,134 - models.patchtst - INFO - Epoch  36 | train_loss=0.923874 | val_loss=1.327779
2025-11-01 17:32:21,269 - models.patchtst - INFO - Epoch  37 | train_loss=0.923840 | val_loss=1.327801
2025-11-01 17:32:28,392 - models.patchtst - INFO - Epoch  38 | train_loss=0.923879 | val_loss=1.327801
2025-11-01 17:32:35,570 - models.patchtst - INFO - Epoch  39 | train_loss=0.923952 | val_loss=1.327782
2025-11-01 17:32:42,739 - models.patchtst - INFO - Epoch  40 | train_loss=0.923867 | val_loss=1.327801
2025-11-01 17:32:49,928 - models.patchtst - INFO - Epoch  41 | train_loss=0.923929 | val_loss=1.327754
2025-11-01 17:32:57,083 - models.patchtst - INFO - Epoch  42 | train_loss=0.923851 | val_loss=1.327772
2025-11-01 17:32:57,083 - models.patchtst - INFO - Early stopping at epoch 42早停触发（连续15轮验证损失未下降），最佳验证损失：1.327688
2025-11-01 17:32:57,083 - main - INFO - 训练NHITS...
2025-11-01 17:33:05,081 - models.nhits - INFO - Epoch   1 | train_loss=62350871.134563 | val_loss=265.913677
2025-11-01 17:33:13,121 - models.nhits - INFO - Epoch   2 | train_loss=236.390530 | val_loss=12.602405
2025-11-01 17:33:21,157 - models.nhits - INFO - Epoch   3 | train_loss=9.552664 | val_loss=1.335739
2025-11-01 17:33:29,192 - models.nhits - INFO - Epoch   4 | train_loss=1.702238 | val_loss=0.735546
2025-11-01 17:33:37,723 - models.nhits - INFO - Epoch   5 | train_loss=0.405423 | val_loss=0.446550
2025-11-01 17:33:45,927 - models.nhits - INFO - Epoch   6 | train_loss=1.204111 | val_loss=0.111881
2025-11-01 17:33:54,291 - models.nhits - INFO - Epoch   7 | train_loss=0.121262 | val_loss=0.073189
2025-11-01 17:34:02,521 - models.nhits - INFO - Epoch   8 | train_loss=0.086746 | val_loss=0.080501
2025-11-01 17:34:10,795 - models.nhits - INFO - Epoch   9 | train_loss=0.064276 | val_loss=0.064505
2025-11-01 17:34:19,051 - models.nhits - INFO - Epoch  10 | train_loss=0.064436 | val_loss=0.114140
2025-11-01 17:34:27,562 - models.nhits - INFO - Epoch  11 | train_loss=0.120896 | val_loss=0.103073
2025-11-01 17:34:35,914 - models.nhits - INFO - Epoch  12 | train_loss=0.052311 | val_loss=0.063635
2025-11-01 17:34:44,107 - models.nhits - INFO - Epoch  13 | train_loss=0.048439 | val_loss=0.088078
2025-11-01 17:34:52,112 - models.nhits - INFO - Epoch  14 | train_loss=0.045039 | val_loss=0.062346
2025-11-01 17:35:00,169 - models.nhits - INFO - Epoch  15 | train_loss=0.319428 | val_loss=0.048450
2025-11-01 17:35:08,160 - models.nhits - INFO - Epoch  16 | train_loss=0.184726 | val_loss=0.066632
2025-11-01 17:35:16,161 - models.nhits - INFO - Epoch  17 | train_loss=0.042513 | val_loss=0.062101
2025-11-01 17:35:24,151 - models.nhits - INFO - Epoch  18 | train_loss=0.041198 | val_loss=0.052071
2025-11-01 17:35:32,128 - models.nhits - INFO - Epoch  19 | train_loss=0.039697 | val_loss=0.046308
2025-11-01 17:35:40,124 - models.nhits - INFO - Epoch  20 | train_loss=0.039638 | val_loss=0.047277
2025-11-01 17:35:48,101 - models.nhits - INFO - Epoch  21 | train_loss=0.966358 | val_loss=0.046030
2025-11-01 17:35:56,079 - models.nhits - INFO - Epoch  22 | train_loss=0.038559 | val_loss=0.066693
2025-11-01 17:36:04,044 - models.nhits - INFO - Epoch  23 | train_loss=0.037233 | val_loss=0.057726
2025-11-01 17:36:12,025 - models.nhits - INFO - Epoch  24 | train_loss=0.057562 | val_loss=0.040491
2025-11-01 17:36:19,984 - models.nhits - INFO - Epoch  25 | train_loss=39.120182 | val_loss=0.052015
2025-11-01 17:36:28,005 - models.nhits - INFO - Epoch  26 | train_loss=0.327999 | val_loss=0.055557
2025-11-01 17:36:35,976 - models.nhits - INFO - Epoch  27 | train_loss=0.036211 | val_loss=0.037638
2025-11-01 17:36:43,988 - models.nhits - INFO - Epoch  28 | train_loss=0.034722 | val_loss=0.047283
2025-11-01 17:36:51,964 - models.nhits - INFO - Epoch  29 | train_loss=0.035780 | val_loss=0.053603
2025-11-01 17:36:59,969 - models.nhits - INFO - Epoch  30 | train_loss=0.184102 | val_loss=0.059676
2025-11-01 17:37:07,935 - models.nhits - INFO - Epoch  31 | train_loss=0.035192 | val_loss=0.041407
2025-11-01 17:37:15,905 - models.nhits - INFO - Epoch  32 | train_loss=0.030695 | val_loss=0.043028
2025-11-01 17:37:23,884 - models.nhits - INFO - Epoch  33 | train_loss=0.047899 | val_loss=0.039105
2025-11-01 17:37:31,896 - models.nhits - INFO - Epoch  34 | train_loss=0.035269 | val_loss=0.042592
2025-11-01 17:37:39,875 - models.nhits - INFO - Epoch  35 | train_loss=0.032040 | val_loss=0.047198
2025-11-01 17:37:47,838 - models.nhits - INFO - Epoch  36 | train_loss=0.255267 | val_loss=0.042095
2025-11-01 17:37:55,811 - models.nhits - INFO - Epoch  37 | train_loss=0.213101 | val_loss=0.052730
2025-11-01 17:38:03,797 - models.nhits - INFO - Epoch  38 | train_loss=0.033974 | val_loss=0.045167
2025-11-01 17:38:11,867 - models.nhits - INFO - Epoch  39 | train_loss=0.026897 | val_loss=0.037993
2025-11-01 17:38:19,931 - models.nhits - INFO - Epoch  40 | train_loss=0.025634 | val_loss=0.036179
2025-11-01 17:38:27,921 - models.nhits - INFO - Epoch  41 | train_loss=0.026468 | val_loss=0.037404
2025-11-01 17:38:36,030 - models.nhits - INFO - Epoch  42 | train_loss=0.024907 | val_loss=0.039887
2025-11-01 17:38:44,308 - models.nhits - INFO - Epoch  43 | train_loss=0.025646 | val_loss=0.036997
2025-11-01 17:38:52,544 - models.nhits - INFO - Epoch  44 | train_loss=0.026531 | val_loss=0.041867
2025-11-01 17:39:00,701 - models.nhits - INFO - Epoch  45 | train_loss=0.025090 | val_loss=0.035433
2025-11-01 17:39:08,876 - models.nhits - INFO - Epoch  46 | train_loss=0.024909 | val_loss=0.037283
2025-11-01 17:39:16,973 - models.nhits - INFO - Epoch  47 | train_loss=0.025071 | val_loss=0.038170
2025-11-01 17:39:25,117 - models.nhits - INFO - Epoch  48 | train_loss=0.025671 | val_loss=0.036936
2025-11-01 17:39:33,309 - models.nhits - INFO - Epoch  49 | train_loss=0.026622 | val_loss=0.045715
2025-11-01 17:39:41,443 - models.nhits - INFO - Epoch  50 | train_loss=0.024200 | val_loss=0.035096
2025-11-01 17:39:49,579 - models.nhits - INFO - Epoch  51 | train_loss=0.024267 | val_loss=0.034009
2025-11-01 17:39:57,931 - models.nhits - INFO - Epoch  52 | train_loss=0.024007 | val_loss=0.036837
2025-11-01 17:40:06,053 - models.nhits - INFO - Epoch  53 | train_loss=0.023737 | val_loss=0.035127
2025-11-01 17:40:14,318 - models.nhits - INFO - Epoch  54 | train_loss=0.023340 | val_loss=0.034765
2025-11-01 17:40:22,474 - models.nhits - INFO - Epoch  55 | train_loss=0.022701 | val_loss=0.032713
2025-11-01 17:40:30,599 - models.nhits - INFO - Epoch  56 | train_loss=0.023456 | val_loss=0.035845
2025-11-01 17:40:38,813 - models.nhits - INFO - Epoch  57 | train_loss=0.024267 | val_loss=0.032281
2025-11-01 17:40:47,052 - models.nhits - INFO - Epoch  58 | train_loss=0.022109 | val_loss=0.034132
2025-11-01 17:40:55,246 - models.nhits - INFO - Epoch  59 | train_loss=0.023779 | val_loss=0.038886
2025-11-01 17:41:03,468 - models.nhits - INFO - Epoch  60 | train_loss=0.022323 | val_loss=0.031660
2025-11-01 17:41:11,731 - models.nhits - INFO - Epoch  61 | train_loss=0.022082 | val_loss=0.033497
2025-11-01 17:41:19,980 - models.nhits - INFO - Epoch  62 | train_loss=0.022034 | val_loss=0.039062
2025-11-01 17:41:28,198 - models.nhits - INFO - Epoch  63 | train_loss=0.022134 | val_loss=0.031074
2025-11-01 17:41:36,473 - models.nhits - INFO - Epoch  64 | train_loss=0.021499 | val_loss=0.033032
2025-11-01 17:41:44,720 - models.nhits - INFO - Epoch  65 | train_loss=0.023328 | val_loss=0.035781
2025-11-01 17:41:53,005 - models.nhits - INFO - Epoch  66 | train_loss=0.021833 | val_loss=0.038565
2025-11-01 17:42:01,260 - models.nhits - INFO - Epoch  67 | train_loss=0.021862 | val_loss=0.030496
2025-11-01 17:42:09,578 - models.nhits - INFO - Epoch  68 | train_loss=0.021732 | val_loss=0.030645
2025-11-01 17:42:17,870 - models.nhits - INFO - Epoch  69 | train_loss=0.020693 | val_loss=0.038408
2025-11-01 17:42:26,204 - models.nhits - INFO - Epoch  70 | train_loss=0.021236 | val_loss=0.031961
2025-11-01 17:42:34,485 - models.nhits - INFO - Epoch  71 | train_loss=0.021044 | val_loss=0.030631
2025-11-01 17:42:42,814 - models.nhits - INFO - Epoch  72 | train_loss=0.020109 | val_loss=0.029156
2025-11-01 17:42:51,142 - models.nhits - INFO - Epoch  73 | train_loss=0.023545 | val_loss=0.031084
2025-11-01 17:42:59,499 - models.nhits - INFO - Epoch  74 | train_loss=0.019971 | val_loss=0.035032
2025-11-01 17:43:07,773 - models.nhits - INFO - Epoch  75 | train_loss=0.020784 | val_loss=0.031214
2025-11-01 17:43:16,049 - models.nhits - INFO - Epoch  76 | train_loss=0.019743 | val_loss=0.030368
2025-11-01 17:43:24,348 - models.nhits - INFO - Epoch  77 | train_loss=0.020528 | val_loss=0.031723
2025-11-01 17:43:32,622 - models.nhits - INFO - Epoch  78 | train_loss=0.018840 | val_loss=0.029822
2025-11-01 17:43:40,871 - models.nhits - INFO - Epoch  79 | train_loss=0.019952 | val_loss=0.032279
2025-11-01 17:43:49,084 - models.nhits - INFO - Epoch  80 | train_loss=0.018721 | val_loss=0.031119
2025-11-01 17:43:57,352 - models.nhits - INFO - Epoch  81 | train_loss=0.019726 | val_loss=0.029933
2025-11-01 17:44:05,661 - models.nhits - INFO - Epoch  82 | train_loss=0.018726 | val_loss=0.031864
2025-11-01 17:44:13,889 - models.nhits - INFO - Epoch  83 | train_loss=0.018799 | val_loss=0.029681
2025-11-01 17:44:22,137 - models.nhits - INFO - Epoch  84 | train_loss=0.015368 | val_loss=0.026052
2025-11-01 17:44:30,445 - models.nhits - INFO - Epoch  85 | train_loss=0.014716 | val_loss=0.028429
2025-11-01 17:44:38,687 - models.nhits - INFO - Epoch  86 | train_loss=0.014475 | val_loss=0.028644
2025-11-01 17:44:46,932 - models.nhits - INFO - Epoch  87 | train_loss=0.014399 | val_loss=0.029744
2025-11-01 17:44:55,211 - models.nhits - INFO - Epoch  88 | train_loss=0.014383 | val_loss=0.025228
2025-11-01 17:45:03,478 - models.nhits - INFO - Epoch  89 | train_loss=0.013750 | val_loss=0.026485
2025-11-01 17:45:11,802 - models.nhits - INFO - Epoch  90 | train_loss=0.013708 | val_loss=0.026678
2025-11-01 17:45:19,991 - models.nhits - INFO - Epoch  91 | train_loss=0.014270 | val_loss=0.024391
2025-11-01 17:45:28,283 - models.nhits - INFO - Epoch  92 | train_loss=0.013853 | val_loss=0.023957
2025-11-01 17:45:36,527 - models.nhits - INFO - Epoch  93 | train_loss=0.013287 | val_loss=0.025398
2025-11-01 17:45:45,014 - models.nhits - INFO - Epoch  94 | train_loss=0.013571 | val_loss=0.025138
2025-11-01 17:45:53,300 - models.nhits - INFO - Epoch  95 | train_loss=0.013307 | val_loss=0.026111
2025-11-01 17:46:01,558 - models.nhits - INFO - Epoch  96 | train_loss=0.013494 | val_loss=0.024132
2025-11-01 17:46:09,775 - models.nhits - INFO - Epoch  97 | train_loss=0.013197 | val_loss=0.025109
2025-11-01 17:46:18,032 - models.nhits - INFO - Epoch  98 | train_loss=0.013350 | val_loss=0.025513
2025-11-01 17:46:26,255 - models.nhits - INFO - Epoch  99 | train_loss=0.012893 | val_loss=0.027181
2025-11-01 17:46:34,591 - models.nhits - INFO - Epoch 100 | train_loss=0.013160 | val_loss=0.026123
2025-11-01 17:46:34,618 - models.patchtst - INFO - 模型已保存到: results\experiment_20251101_172746/patchtst_model.pth
2025-11-01 17:46:34,647 - models.nhits - INFO - 模型已保存到: results\experiment_20251101_172746/nhits_model.pth
2025-11-01 17:46:34,647 - main - INFO - 专家模型训练完成
2025-11-01 17:46:34,651 - __main__ - INFO - 步骤3: 快速运行融合策略...
2025-11-01 17:46:34,651 - main - INFO - 获取专家模型预测...
2025-11-01 17:46:47,745 - main - INFO - 专家预测获取完成
2025-11-01 17:46:47,746 - main - INFO - 实现策略A快速模式：静态优化权重（max_iterations=20）...
2025-11-01 17:46:48,419 - __main__ - ERROR - 实验失败: 'MPAOptimizer' object has no attribute 'mpa'
2025-11-01 19:31:28,707 - __main__ - INFO - 初始化实验...
2025-11-01 19:31:28,716 - main - INFO - 使用设备: cuda
2025-11-01 19:31:28,717 - __main__ - INFO - 运行快速验证模式 - 使用真实数据...
2025-11-01 19:31:28,717 - __main__ - INFO - 步骤1: 加载真实数据...
2025-11-01 19:31:28,717 - main - INFO - 开始数据加载和预处理...
2025-11-01 19:31:28,725 - src.data_preprocessing.data_loader - INFO - 正在加载数据文件: C:\Temp\Pycharm\floating_wind_platform\data\浮式风机平台.xlsx
2025-11-01 19:31:30,857 - src.data_preprocessing.data_loader - WARNING - 列 'Wave1Elev' 发现 62 个异常值 (|Z-score| > 3.0)
2025-11-01 19:31:30,859 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 19:31:30,862 - src.data_preprocessing.data_loader - WARNING - 列 'PtfmRoll' 发现 106 个异常值 (|Z-score| > 3.0)
2025-11-01 19:31:30,864 - src.data_preprocessing.data_loader - INFO - 已使用1%和99%分位数截断处理异常值
2025-11-01 19:31:30,871 - src.data_preprocessing.data_loader - INFO - 目标变量标准化完成，均值: -0.0002, 方差: 0.3598
2025-11-01 19:31:30,872 - src.data_preprocessing.data_loader - INFO - 协变量标准化完成，形状: (20001, 6)
2025-11-01 19:31:30,953 - src.data_preprocessing.data_loader - INFO - 创建序列样本完成: X形状 (19882, 96, 7), y形状 (19882, 24)
2025-11-01 19:31:30,953 - src.data_preprocessing.data_loader - INFO - 数据划分完成:
2025-11-01 19:31:30,954 - src.data_preprocessing.data_loader - INFO - 训练集: X(13917, 96, 7), y(13917, 24)
2025-11-01 19:31:30,954 - src.data_preprocessing.data_loader - INFO - 验证集: X(1988, 96, 7), y(1988, 24)
2025-11-01 19:31:30,954 - src.data_preprocessing.data_loader - INFO - 测试集: X(3977, 96, 7), y(3977, 24)
2025-11-01 19:31:31,033 - src.data_preprocessing.data_loader - INFO - 处理后的数据已保存到 results
2025-11-01 19:31:31,033 - main - INFO - 数据预处理完成:
2025-11-01 19:31:31,033 - main - INFO - 训练集: (13917, 96, 7), (13917, 24)
2025-11-01 19:31:31,033 - main - INFO - 验证集: (1988, 96, 7), (1988, 24)
2025-11-01 19:31:31,033 - main - INFO - 测试集: (3977, 96, 7), (3977, 24)
2025-11-01 19:31:31,033 - __main__ - INFO - 步骤2: 快速训练模型...
2025-11-01 19:31:31,033 - main - INFO - 开始训练专家模型...
2025-11-01 19:31:31,033 - main - INFO - 创建PatchTST模型...
2025-11-01 19:31:31,047 - main - INFO - 创建NHITS模型...
2025-11-01 19:31:31,111 - main - INFO - 训练PatchTST...
2025-11-01 19:31:40,899 - models.patchtst - INFO - Epoch   1 | train_loss=0.928468 | val_loss=1.327757
2025-11-01 19:31:47,925 - models.patchtst - INFO - Epoch   2 | train_loss=0.923990 | val_loss=1.327662
2025-11-01 19:31:54,897 - models.patchtst - INFO - Epoch   3 | train_loss=0.923920 | val_loss=1.327618
2025-11-01 19:32:02,068 - models.patchtst - INFO - Epoch   4 | train_loss=0.923925 | val_loss=1.327668
2025-11-01 19:32:09,150 - models.patchtst - INFO - Epoch   5 | train_loss=0.923976 | val_loss=1.327669
2025-11-01 19:32:16,137 - models.patchtst - INFO - Epoch   6 | train_loss=0.923987 | val_loss=1.327712
2025-11-01 19:32:23,173 - models.patchtst - INFO - Epoch   7 | train_loss=0.923939 | val_loss=1.328249
2025-11-01 19:32:30,172 - models.patchtst - INFO - Epoch   8 | train_loss=0.923988 | val_loss=1.327798
2025-11-01 19:32:37,223 - models.patchtst - INFO - Epoch   9 | train_loss=0.923989 | val_loss=1.327754
2025-11-01 19:32:44,345 - models.patchtst - INFO - Epoch  10 | train_loss=0.924006 | val_loss=1.327716
2025-11-01 19:32:51,383 - models.patchtst - INFO - Epoch  11 | train_loss=0.923952 | val_loss=1.327743
2025-11-01 19:32:58,513 - models.patchtst - INFO - Epoch  12 | train_loss=0.924117 | val_loss=1.327651
2025-11-01 19:33:05,770 - models.patchtst - INFO - Epoch  13 | train_loss=0.923905 | val_loss=1.327901
2025-11-01 19:33:12,879 - models.patchtst - INFO - Epoch  14 | train_loss=0.923921 | val_loss=1.328073
2025-11-01 19:33:19,971 - models.patchtst - INFO - Epoch  15 | train_loss=0.923910 | val_loss=1.327878
2025-11-01 19:33:27,021 - models.patchtst - INFO - Epoch  16 | train_loss=0.924001 | val_loss=1.327864
2025-11-01 19:33:34,127 - models.patchtst - INFO - Epoch  17 | train_loss=0.923910 | val_loss=1.327817
2025-11-01 19:33:41,166 - models.patchtst - INFO - Epoch  18 | train_loss=0.923894 | val_loss=1.327791
2025-11-01 19:33:41,167 - models.patchtst - INFO - Early stopping at epoch 18早停触发（连续15轮验证损失未下降），最佳验证损失：1.327618
2025-11-01 19:33:41,167 - main - INFO - 训练NHITS...
2025-11-01 19:33:49,063 - models.nhits - INFO - Epoch   1 | train_loss=615717804.075352 | val_loss=416.028802
2025-11-01 19:33:56,912 - models.nhits - INFO - Epoch   2 | train_loss=227.067418 | val_loss=10.051271
2025-11-01 19:34:04,777 - models.nhits - INFO - Epoch   3 | train_loss=4.250484 | val_loss=0.797358
2025-11-01 19:34:12,632 - models.nhits - INFO - Epoch   4 | train_loss=0.441132 | val_loss=0.187039
2025-11-01 19:34:20,503 - models.nhits - INFO - Epoch   5 | train_loss=0.176381 | val_loss=0.129356
2025-11-01 19:34:28,441 - models.nhits - INFO - Epoch   6 | train_loss=0.116229 | val_loss=0.117710
2025-11-01 19:34:36,327 - models.nhits - INFO - Epoch   7 | train_loss=0.117696 | val_loss=0.146535
2025-11-01 19:34:44,174 - models.nhits - INFO - Epoch   8 | train_loss=0.407756 | val_loss=0.134929
2025-11-01 19:34:52,139 - models.nhits - INFO - Epoch   9 | train_loss=0.099532 | val_loss=0.094489
2025-11-01 19:35:00,144 - models.nhits - INFO - Epoch  10 | train_loss=0.080137 | val_loss=0.109530
2025-11-01 19:35:08,062 - models.nhits - INFO - Epoch  11 | train_loss=0.076511 | val_loss=0.080222
2025-11-01 19:35:15,889 - models.nhits - INFO - Epoch  12 | train_loss=0.073584 | val_loss=0.077721
2025-11-01 19:35:23,694 - models.nhits - INFO - Epoch  13 | train_loss=0.084840 | val_loss=0.125241
2025-11-01 19:35:31,527 - models.nhits - INFO - Epoch  14 | train_loss=0.096703 | val_loss=0.082649
2025-11-01 19:35:39,384 - models.nhits - INFO - Epoch  15 | train_loss=0.067126 | val_loss=0.104015
2025-11-01 19:35:47,209 - models.nhits - INFO - Epoch  16 | train_loss=0.068910 | val_loss=0.091106
2025-11-01 19:35:55,035 - models.nhits - INFO - Epoch  17 | train_loss=0.067786 | val_loss=0.080930
2025-11-01 19:36:03,281 - models.nhits - INFO - Epoch  18 | train_loss=0.157604 | val_loss=0.079321
2025-11-01 19:36:11,409 - models.nhits - INFO - Epoch  19 | train_loss=0.067736 | val_loss=0.096928
2025-11-01 19:36:19,513 - models.nhits - INFO - Epoch  20 | train_loss=0.063264 | val_loss=0.107417
